import{m as f,r as C,L as M,q as N,c as l,j as d,u as c,a as e,d as B,t as a,h as R,b as g,n as S,k as $,o as r}from"./app-ec99bd87.js";import{u as E,b as H,c as x,d as b}from"./vue-flow-core-167591f5.js";import{_ as j}from"./FormSelect-797ad7ea.js";import{_ as L}from"./FormCheckbox-cce65c62.js";import{_ as P}from"./FormInput-1cb8ed95.js";import{_}from"./FormTextArea-3ceaa938.js";import{_ as q}from"./_plugin-vue_export-helper-c27b6911.js";import"./index-47ec0313.js";import"./hidden-490c85f0.js";import"./use-text-value-9ae8c6ca.js";import"./use-outside-click-eba05427.js";import"./use-resolve-button-type-840eaf68.js";const U={class:"ai-response-node"},z={class:"bg-white border-2 border-teal-200 rounded-lg p-4 shadow-sm w-[400px]",style:{"min-width":"400px"}},T={class:"flex items-center mb-3"},W={class:"flex items-center gap-2 flex-1"},F={class:"font-medium text-gray-900 text-sm"},D={class:"text-xs text-gray-600 mb-2"},K={key:0,class:"text-xs text-gray-500 mt-1"},O={class:"flex items-center justify-between text-xs"},G={class:"flex items-center gap-1"},J={key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},Q={class:"bg-white rounded-lg max-w-md w-full mx-4 max-h-[80vh] overflow-y-auto"},X={class:"space-y-4"},Y={class:"space-y-3"},Z={key:0,class:"space-y-3"},ee={class:"bg-blue-50 border border-blue-200 rounded-lg p-4"},te={class:"space-y-3 text-sm text-blue-700"},oe={key:0},se={class:"text-xs space-y-2"},ne={key:1},ie={class:"flex items-center"},de={__name:"AIResponse-node",props:{id:String,data:Object,selected:Boolean},setup(y){const p=y,{removeNodes:w}=E(),v=H(),i=f(()=>{var s;return((s=p.data)==null?void 0:s.config)||{}}),u=f(()=>{var s;return((s=p.data)==null?void 0:s.is_active)!==!1}),m=C(!1),A=f(()=>{const s=i.value;return s.proceed_condition==="confidence_threshold"?`AI Response (${(s.confidence_threshold||.8)*100}% confidence)`:s.prompt?`AI Response: ${s.prompt.substring(0,30)}${s.prompt.length>30?"...":""}`:"AI Response"}),o=M({config:{},is_active:!0}),I=()=>{const s=i.value||{};o.config={prompt:s.prompt||"",proceed_condition:s.proceed_condition||"always",confidence_threshold:s.confidence_threshold||.8,low_confidence_message:s.low_confidence_message||""},o.is_active=u.value,m.value=!0},h=()=>{m.value=!1},V=()=>{v.node.data={...v.node.data,actionType:"ai_response",config:o.config,is_active:o.is_active},h()},k=()=>{confirm("Are you sure you want to delete this action?")&&w([p.id])};return N(()=>{}),(s,t)=>(r(),l("div",U,[d(c(b),{type:"target",position:c(x).Top,class:"w-3 h-3 !bg-teal-500"},null,8,["position"]),e("div",z,[e("div",T,[e("div",W,[t[5]||(t[5]=B('<div class="w-8 h-8 bg-slate-50 rounded-lg flex items-center justify-center" data-v-32bd382b><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="text-teal-600" data-v-32bd382b><path d="M12 2L2 7l10 5 10-5-10-5z" data-v-32bd382b></path><path d="M2 17l10 5 10-5" data-v-32bd382b></path><path d="M2 12l10 5 10-5" data-v-32bd382b></path></svg></div>',1)),e("div",null,[e("h3",F,a(A.value),1)])]),e("div",{class:"flex items-center gap-1 ml-auto"},[e("button",{onClick:I,class:"p-1 text-gray-400 hover:text-gray-600 rounded",title:"Edit Action"},t[6]||(t[6]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),e("path",{d:"m18.5 2.5 3 3L12 15l-4 1 1-4 9.5-9.5z"})],-1)])),e("button",{onClick:k,class:"p-1 text-red-400 hover:text-red-600 rounded",title:"Delete Action"},t[7]||(t[7]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M3 6h18"}),e("path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"}),e("path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"})],-1)]))])]),e("div",D,[t[8]||(t[8]=e("span",{class:"font-medium"},"Prompt:",-1)),R(" "+a(i.value.prompt?i.value.prompt.substring(0,30)+(i.value.prompt.length>30?"...":""):"No prompt set")+" ",1),i.value.proceed_condition==="confidence_threshold"?(r(),l("div",K," Confidence: "+a((i.value.confidence_threshold||.8)*100)+"% ",1)):g("",!0)]),e("div",O,[t[9]||(t[9]=e("span",{class:"text-gray-500"},"Action",-1)),e("div",G,[e("span",{class:S([u.value?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800","px-2 py-1 rounded-full text-xs"])},a(u.value?"Active":"Inactive"),3)])])]),d(c(b),{type:"source",position:c(x).Bottom,class:"w-3 h-3 !bg-teal-500"},null,8,["position"]),m.value?(r(),l("div",J,[e("div",Q,[t[21]||(t[21]=e("div",{class:"px-6 py-4 border-b border-gray-200"},[e("h3",{class:"text-lg font-semibold text-gray-900"},"Edit AI Response Action")],-1)),e("form",{onSubmit:$(V,["prevent"]),class:"p-6"},[e("div",X,[e("div",null,[t[19]||(t[19]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Configuration",-1)),e("div",Y,[e("div",null,[d(_,{modelValue:o.config.prompt,"onUpdate:modelValue":t[0]||(t[0]=n=>o.config.prompt=n),name:"AI Prompt",rows:"4",placeholder:"Enter the prompt for AI response... (optional)"},null,8,["modelValue"]),t[10]||(t[10]=e("p",{class:"text-xs text-gray-500 mt-1"}," Leave empty to use default AI behavior, or add specific instructions for the AI. ",-1))]),e("div",null,[d(j,{modelValue:o.config.proceed_condition,"onUpdate:modelValue":t[1]||(t[1]=n=>o.config.proceed_condition=n),name:"Proceed Condition",options:[{value:"always",label:"Always Proceed"},{value:"confidence_threshold",label:"Wait for High Confidence"}],required:""},null,8,["modelValue"])]),o.config.proceed_condition==="confidence_threshold"?(r(),l("div",Z,[e("div",null,[d(P,{modelValue:o.config.confidence_threshold,"onUpdate:modelValue":t[2]||(t[2]=n=>o.config.confidence_threshold=n),name:"Confidence Threshold",type:"number",min:"0.1",max:"1",step:"0.1",placeholder:"0.8",required:""},null,8,["modelValue"]),t[11]||(t[11]=e("p",{class:"text-xs text-gray-500 mt-1"}," Set between 0.1 (10%) and 1.0 (100%). Higher values require more confident AI responses. ",-1))]),e("div",null,[d(_,{modelValue:o.config.low_confidence_message,"onUpdate:modelValue":t[3]||(t[3]=n=>o.config.low_confidence_message=n),name:"Low Confidence Message",rows:"2",placeholder:"I'm not confident about my response. Could you rephrase your question?"},null,8,["modelValue"]),t[12]||(t[12]=e("p",{class:"text-xs text-gray-500 mt-1"}," Message sent when AI confidence is below the threshold. Leave empty for default message. ",-1))])])):g("",!0),e("div",ee,[t[18]||(t[18]=e("p",{class:"text-sm font-medium text-blue-800 mb-3"}," How AI Response Flow Works: ",-1)),e("div",te,[t[17]||(t[17]=e("div",null,[e("p",{class:"font-medium"},"Always Proceed:"),e("p",{class:"text-xs"},"AI sends response and flow immediately continues to next node.")],-1)),o.config.proceed_condition==="confidence_threshold"?(r(),l("div",oe,[t[15]||(t[15]=e("p",{class:"font-medium"},"Wait for High Confidence:",-1)),e("div",se,[t[13]||(t[13]=e("p",null,"• AI generates response and calculates confidence (0-100%)",-1)),e("p",null,"• If confidence ≥ "+a((o.config.confidence_threshold||.8)*100)+"%: Send response and continue",1),e("p",null,"• If confidence < "+a((o.config.confidence_threshold||.8)*100)+"%: Send fallback message and wait for user input",1),t[14]||(t[14]=e("p",null,"• AI keeps trying until it reaches the confidence threshold",-1))])])):(r(),l("div",ne,t[16]||(t[16]=[e("p",{class:"font-medium"},"Wait for High Confidence:",-1),e("p",{class:"text-xs"},"AI only proceeds when response confidence meets your threshold. Keeps conversing until confident.",-1)])))])])])]),e("div",ie,[d(L,{modelValue:o.is_active,"onUpdate:modelValue":t[4]||(t[4]=n=>o.is_active=n),label:"Active",class:"h-4 w-4 text-teal-600 focus:ring-teal-500 border-gray-300 rounded"},null,8,["modelValue"])])]),e("div",{class:"flex justify-end space-x-3 mt-6"},[e("button",{type:"button",onClick:h,class:"px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors"}," Cancel "),t[20]||(t[20]=e("button",{type:"submit",class:"px-4 py-2 bg-teal-600 text-white rounded-lg hover:bg-teal-700 transition-colors"}," Save Changes ",-1))])],32)])])):g("",!0)]))}},be=q(de,[["__scopeId","data-v-32bd382b"]]);export{be as default};

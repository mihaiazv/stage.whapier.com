import{W as I,m,r as z,L as H,q as D,c as d,j as c,u,a as e,t as v,F as C,e as V,n as R,k as W,b as k,d as O,o as l,f as P}from"./app-65921241.js";import{u as Y,b as Z,c as _,d as y}from"./vue-flow-core-8afe8c6d.js";import{_ as x}from"./FormSelect-dc5c52c3.js";import{_ as G}from"./FormCheckbox-9555f354.js";import{_ as J}from"./FormInput-35f9159b.js";import{_ as K}from"./_plugin-vue_export-helper-c27b6911.js";import"./index-db537bfe.js";import"./hidden-78d7e861.js";import"./use-text-value-dba16a17.js";import"./use-outside-click-e7d3b6c5.js";import"./use-resolve-button-type-567bcc7c.js";const Q={class:"conditional-node"},X={class:"bg-white border-2 border-teal-200 rounded-lg p-4 shadow-sm w-[400px]",style:{"min-width":"400px"}},ee={class:"flex items-center mb-3"},te={class:"flex items-center gap-2 flex-1"},se={class:"font-medium text-gray-900 text-sm"},oe={class:"text-xs text-gray-600 mb-2"},ae={class:"space-y-0"},ne={class:"text-xs font-medium text-gray-700 mb-2"},le={class:"flex items-center justify-between py-2"},ie={class:"flex-1"},de={class:"text-xs text-gray-600"},ce={class:"relative border-b border-gray-200 pt-2"},re={class:"flex items-center justify-between text-xs"},ue={class:"flex items-center gap-1"},pe={key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},ve={class:"bg-white rounded-lg max-w-md w-full mx-4 max-h-[80vh] overflow-y-auto"},me={class:"space-y-4"},fe={class:"space-y-3"},ge={class:"space-y-4"},_e={key:0},ye={class:"space-y-3"},xe={class:"space-y-3"},be={key:0,class:"space-y-2"},he={class:"flex items-center justify-between mb-2"},we={class:"text-xs font-medium text-gray-700"},Ce=["onClick"],Ve={key:1,class:"text-center py-4 text-gray-500 text-sm"},ke={class:"flex items-center"},Ee={__name:"Conditional-node",props:{id:String,data:Object,selected:Boolean},setup(E){const p=E,{removeNodes:$}=Y(),b=Z(),q=I("contactFields",[]),i=m(()=>{var s;return((s=p.data)==null?void 0:s.config)||{}}),f=m(()=>{var s;return((s=p.data)==null?void 0:s.is_active)!==!1}),g=z(!1),h=m(()=>{const s=[];return s.push({value:"first_name",label:"First Name"},{value:"last_name",label:"Last Name"},{value:"email",label:"Email"}),s.push({value:"address.street",label:"Street"},{value:"address.city",label:"City"},{value:"address.state",label:"State"},{value:"address.zip",label:"Zip Code"},{value:"address.country",label:"Country"}),q.forEach(t=>{s.push({value:`metadata.${t.name}`,label:t.name})}),s}),N=m(()=>{var a;const t=((a=i.value.conditions)==null?void 0:a.length)||0;return t>0?`Conditional (${t} conditions)`:"Conditional"}),o=H({config:{},is_active:!0}),M=()=>{const s=i.value||{};o.config={condition_type:s.condition_type||"message_contains",field_name:s.field_name||"",field_operator:s.field_operator||"equals",conditions:s.conditions||[]},o.is_active=f.value,g.value=!0},w=()=>{g.value=!1},F=()=>{b.node.data={...b.node.data,actionType:"conditional",config:o.config,is_active:o.is_active},w()},j=()=>{confirm("Are you sure you want to delete this action?")&&$([p.id])},A=()=>{o.config.conditions=[...o.config.conditions||[],{value:""}]},B=s=>{o.config.conditions.splice(s,1)},L=s=>{switch(s){case"message_contains":return"Message Contains";case"message_equals":return"Message Equals";case"contact_field":return"Contact Field";default:return"Unknown Condition Type"}},S=s=>{var a;if(!s||!s.value)return"No value set";switch(i.value.condition_type){case"message_contains":return`Message contains "${s.value}"`;case"message_equals":return`Message equals "${s.value}"`;case"contact_field":if(!i.value.field_name)return"Contact field (no field selected)";const n=((a=h.value.find(T=>T.value===i.value.field_name))==null?void 0:a.label)||i.value.field_name,r=i.value.field_operator;return r==="is_empty"?`${n} is empty`:r==="is_not_empty"?`${n} is not empty`:`${n} ${r} "${s.value}"`;default:return`Value: "${s.value}"`}},U=s=>{switch(s){case"message_contains":return"Enter text to search for...";case"message_equals":return"Enter exact message...";case"contact_field":return"Enter value to compare...";default:return"Enter value..."}};return D(()=>{}),(s,t)=>(l(),d("div",Q,[c(u(y),{type:"target",position:u(_).Left,class:"w-3 h-3 !bg-teal-500"},null,8,["position"]),e("div",X,[e("div",ee,[e("div",te,[t[4]||(t[4]=e("div",{class:"w-8 h-8 bg-slate-50 rounded-lg flex items-center justify-center"},[e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2",class:"text-teal-600"},[e("path",{d:"M9 11l3 3L22 4"}),e("path",{d:"M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11"})])],-1)),e("div",null,[e("h3",se,v(N.value),1)])]),e("div",{class:"flex items-center gap-1 ml-auto"},[e("button",{onClick:M,class:"p-1 text-gray-400 hover:text-gray-600 rounded",title:"Edit Action"},t[5]||(t[5]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),e("path",{d:"m18.5 2.5 3 3L12 15l-4 1 1-4 9.5-9.5z"})],-1)])),e("button",{onClick:j,class:"p-1 text-red-400 hover:text-red-600 rounded",title:"Delete Action"},t[6]||(t[6]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M3 6h18"}),e("path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"}),e("path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"})],-1)]))])]),e("div",oe,[e("div",ae,[e("div",ne,v(L(i.value.condition_type)),1),(l(!0),d(C,null,V(i.value.conditions||[],(a,n)=>(l(),d("div",{key:n,class:"relative border-b border-gray-200 pt-2"},[e("div",le,[e("div",ie,[e("span",de,v(S(a)),1)])]),(l(),P(u(y),{key:`condition-${n}`,type:"source",position:u(_).Right,id:`condition-${n}|${p.id}`,style:{right:"-17px"}},null,8,["position","id"]))]))),128)),e("div",ce,[t[7]||(t[7]=e("div",{class:"flex items-center justify-between py-2"},[e("div",{class:"flex-1"},[e("span",{class:"text-xs text-gray-500"},"Default: No conditions match")])],-1)),c(u(y),{type:"source",position:u(_).Right,id:`default|${p.id}`,style:{right:"-17px"}},null,8,["position","id"])])])]),e("div",re,[t[8]||(t[8]=e("span",{class:"text-gray-500"},"Action",-1)),e("div",ue,[e("span",{class:R([f.value?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800","px-2 py-1 rounded-full text-xs"])},v(f.value?"Active":"Inactive"),3)])])]),g.value?(l(),d("div",pe,[e("div",ve,[t[13]||(t[13]=e("div",{class:"px-6 py-4 border-b border-gray-200"},[e("h3",{class:"text-lg font-semibold text-gray-900"},"Edit Conditional Action")],-1)),e("form",{onSubmit:W(F,["prevent"]),class:"p-6"},[e("div",me,[e("div",null,[t[11]||(t[11]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Configuration",-1)),e("div",fe,[e("div",ge,[e("div",null,[c(x,{modelValue:o.config.condition_type,"onUpdate:modelValue":t[0]||(t[0]=a=>o.config.condition_type=a),name:"Condition Type",options:[{value:"message_contains",label:"Message Contains"},{value:"message_equals",label:"Message Equals"},{value:"contact_field",label:"Contact Field"}],required:""},null,8,["modelValue"])]),o.config.condition_type==="contact_field"?(l(),d("div",_e,[e("div",ye,[c(x,{modelValue:o.config.field_name,"onUpdate:modelValue":t[1]||(t[1]=a=>o.config.field_name=a),name:"Contact Field",options:h.value,required:""},null,8,["modelValue","options"]),c(x,{modelValue:o.config.field_operator,"onUpdate:modelValue":t[2]||(t[2]=a=>o.config.field_operator=a),name:"Operator",options:[{value:"equals",label:"Equals"},{value:"contains",label:"Contains"},{value:"not_equals",label:"Not Equals"},{value:"is_empty",label:"Is Empty"},{value:"is_not_empty",label:"Is Not Empty"}],required:""},null,8,["modelValue"])])])):k("",!0),e("div",xe,[e("div",{class:"flex items-center justify-between"},[t[9]||(t[9]=e("h4",{class:"text-xs font-medium text-gray-600 uppercase tracking-wide"},"Values",-1)),e("button",{type:"button",onClick:A,class:"text-xs bg-teal-600 text-white px-2 py-1 rounded hover:bg-teal-700"}," Add Value ")]),o.config.conditions&&o.config.conditions.length>0?(l(),d("div",be,[(l(!0),d(C,null,V(o.config.conditions,(a,n)=>(l(),d("div",{key:n,class:"border border-gray-200 rounded-lg p-3 bg-gray-50"},[e("div",he,[e("span",we,"Value "+v(n+1),1),e("button",{type:"button",onClick:r=>B(n),class:"text-red-500 hover:text-red-700 text-xs"}," Remove ",8,Ce)]),e("div",null,[c(J,{modelValue:a.value,"onUpdate:modelValue":r=>a.value=r,name:"Value",type:"text",placeholder:U(o.config.condition_type),required:""},null,8,["modelValue","onUpdate:modelValue","placeholder"])])]))),128))])):(l(),d("div",Ve,' No values added yet. Click "Add Value" to create your first condition. '))]),t[10]||(t[10]=O('<div class="bg-blue-50 border border-blue-200 rounded-lg p-4" data-v-c2849122><p class="text-sm font-medium text-blue-800 mb-3" data-v-c2849122> How Conditional Flow Works: </p><div class="space-y-2 text-sm text-blue-700" data-v-c2849122><p class="text-xs" data-v-c2849122>• Each value will be evaluated against the selected condition type</p><p class="text-xs" data-v-c2849122>• When a value matches, flow will branch to that value&#39;s connected node</p><p class="text-xs" data-v-c2849122>• If no values match, flow will continue to the default path</p><p class="text-xs" data-v-c2849122>• You can connect multiple nodes to different values</p></div></div>',1))])])]),e("div",ke,[c(G,{modelValue:o.is_active,"onUpdate:modelValue":t[3]||(t[3]=a=>o.is_active=a),label:"Active",class:"h-4 w-4 text-teal-600 focus:ring-teal-500 border-gray-300 rounded"},null,8,["modelValue"])])]),e("div",{class:"flex justify-end space-x-3 mt-6"},[e("button",{type:"button",onClick:w,class:"px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors"}," Cancel "),t[12]||(t[12]=e("button",{type:"submit",class:"px-4 py-2 bg-teal-600 text-white rounded-lg hover:bg-teal-700 transition-colors"}," Save Changes ",-1))])],32)])])):k("",!0)]))}},Te=K(Ee,[["__scopeId","data-v-c2849122"]]);export{Te as default};

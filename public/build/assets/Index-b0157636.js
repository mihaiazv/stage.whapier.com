import{g as es,_ as ts}from"./App-faae56c7.js";import{z as as,A as rs,r as L0,S as Fa,m as qt,q as Mt,E as _a,o as U,c as r0,a as p,d as Qe,t as R0,b as g0,k as Q1,j as Re,u as xe,w as ia,v as la,a2 as Ia,n as Ce,F as v1,x as it,K as qa,T as sa,g as Ne,i as st,f as c1,h as Ve,O as wt,R as Xa,G as St,e as U1,D as Za,a3 as Da,V as Ft,W as na,a4 as yt,J as ss,a5 as ns,a6 as is}from"./app-884e4ce3.js";import{_ as ls}from"./CampaignForm-031e2ddc.js";import{P as La}from"./style-5920f9eb.js";import{_ as os}from"./AlertModal-7204a9e7.js";import{_ as _s}from"./Dropdown-5f5db5e5.js";import{_ as us,a as $t}from"./DropdownItem-ce580ecd.js";import{_ as vs}from"./FormSelectCombo-ff5fe0e6.js";import{_ as cs}from"./FormTextArea-3daa517d.js";import{_ as Pa}from"./Modal-a947e544.js";import{t as ds}from"./index-d349a931.js";import{d as hs}from"./debounce-42603f74.js";import{P as fs}from"./Pagination-6803fb76.js";import{_ as ms}from"./ContactInfo-b1538c80.js";import"./Sidebar-ec4f7223.js";import"./Menu-58091ecb.js";import"./ProfileModal-268f6e59.js";import"./FormInput-ab713954.js";import"./FormPhoneInput-8c055c19.js";/* empty css                      */import"./FormSelect-1f27a419.js";import"./hidden-733404a0.js";import"./use-text-value-48384026.js";import"./use-outside-click-1c7dcbeb.js";import"./use-resolve-button-type-261165f4.js";import"./transition-15fedc5d.js";import"./micro-task-89dcd6af.js";import"./tabs-3ad99d3f.js";import"./LangToggle-54d6b98e.js";import"./OrganizationModal-83fb7cbd.js";import"./index-ff0eb693.js";import"./MobileSidebar-4319591b.js";/* empty css              */import"./pusher-e63f75b9.js";import"./useRtl-295d8c04.js";import"./WhatsappTemplate-ce9cd7ed.js";import"./use-tree-walker-6ecb48c5.js";import"./_baseGetTag-0b0c5108.js";import"./_plugin-vue_export-helper-c27b6911.js";var Ya={exports:{}};(function(N,G){(function(W,S0){N.exports=S0()})(as,function(){function W(M){return new Int8Array(M)}function S0(M){return new Int16Array(M)}function l0(M){return new Int32Array(M)}function x0(M){return new Float32Array(M)}function _0(M){return new Float64Array(M)}function I0(M){if(M.length==1)return x0(M[0]);var F=M[0];M=M.slice(1);for(var K=[],q=0;q<F;q++)K.push(I0(M));return K}function ee(M){if(M.length==1)return l0(M[0]);var F=M[0];M=M.slice(1);for(var K=[],q=0;q<F;q++)K.push(ee(M));return K}function q0(M){if(M.length==1)return S0(M[0]);var F=M[0];M=M.slice(1);for(var K=[],q=0;q<F;q++)K.push(q0(M));return K}function Y0(M){if(M.length==1)return new Array(M[0]);var F=M[0];M=M.slice(1);for(var K=[],q=0;q<F;q++)K.push(Y0(M));return K}var D0={};D0.fill=function(M,F,K,q){if(arguments.length==2)for(var o0=0;o0<M.length;o0++)M[o0]=arguments[1];else for(var o0=F;o0<K;o0++)M[o0]=q};var j0={};j0.arraycopy=function(M,F,K,q,o0){for(var X=F+o0;F<X;)K[q++]=M[F++]};var K0={};K0.SQRT2=1.4142135623730951,K0.FAST_LOG10=function(M){return Math.log10(M)},K0.FAST_LOG10_X=function(M,F){return Math.log10(M)*F};function E0(M){this.ordinal=M}E0.short_block_allowed=new E0(0),E0.short_block_coupled=new E0(1),E0.short_block_dispensed=new E0(2),E0.short_block_forced=new E0(3);var M0={};M0.MAX_VALUE=34028235e31;function Z(M){this.ordinal=M}Z.vbr_off=new Z(0),Z.vbr_mt=new Z(1),Z.vbr_rh=new Z(2),Z.vbr_abr=new Z(3),Z.vbr_mtrh=new Z(4),Z.vbr_default=Z.vbr_mtrh;var i0=function(M){},z={System:j0,VbrMode:Z,Float:M0,ShortBlock:E0,Util:K0,Arrays:D0,new_array_n:Y0,new_byte:W,new_double:_0,new_float:x0,new_float_n:I0,new_int:l0,new_int_n:ee,new_short:S0,new_short_n:q0,assert:i0},W0=z.System,G0=z.Util,we=z.Arrays,ge=z.new_float;function se(){var M=[-.1482523854003001,32.308141959636465,296.40344946382766,883.1344870032432,11113.947376231741,1057.2713659324597,305.7402417275812,30.825928907280012,3.8533188138216365,59.42900443849514,709.5899960123345,5281.91112291017,-5829.66483675846,-817.6293103748613,-76.91656988279972,-4.594269939176596,.9063471690191471,.1960342806591213,-.15466694054279598,34.324387823855965,301.8067566458425,817.599602898885,11573.795901679885,1181.2520595540152,321.59731579894424,31.232021761053772,3.7107095756221318,53.650946155329365,684.167428119626,5224.56624370173,-6366.391851890084,-908.9766368219582,-89.83068876699639,-5.411397422890401,.8206787908286602,.3901806440322567,-.16070888947830023,36.147034243915876,304.11815768187864,732.7429163887613,11989.60988270091,1300.012278487897,335.28490093152146,31.48816102859945,3.373875931311736,47.232241542899175,652.7371796173471,5132.414255594984,-6909.087078780055,-1001.9990371107289,-103.62185754286375,-6.104916304710272,.7416505462720353,.5805693545089249,-.16636367662261495,37.751650073343995,303.01103387567713,627.9747488785183,12358.763425278165,1412.2779918482834,346.7496836825721,31.598286663170416,3.1598635433980946,40.57878626349686,616.1671130880391,5007.833007176154,-7454.040671756168,-1095.7960341867115,-118.24411666465777,-6.818469345853504,.6681786379192989,.7653668647301797,-.1716176790982088,39.11551877123304,298.3413246578966,503.5259106886539,12679.589408408976,1516.5821921214542,355.9850766329023,31.395241710249053,2.9164211881972335,33.79716964664243,574.8943997801362,4853.234992253242,-7997.57021486075,-1189.7624067269965,-133.6444792601766,-7.7202770609839915,.5993769336819237,.9427934736519954,-.17645823955292173,40.21879108166477,289.9982036694474,359.3226160751053,12950.259102786438,1612.1013903507662,362.85067106591504,31.045922092242872,2.822222032597987,26.988862316190684,529.8996541764288,4671.371946949588,-8535.899136645805,-1282.5898586244496,-149.58553632943463,-8.643494270763135,.5345111359507916,1.111140466039205,-.36174739330527045,41.04429910497807,277.5463268268618,195.6386023135583,13169.43812144731,1697.6433561479398,367.40983966190305,30.557037410382826,2.531473372857427,20.070154905927314,481.50208566532336,4464.970341588308,-9065.36882077239,-1373.62841526722,-166.1660487028118,-9.58289321133207,.4729647758913199,1.268786568327291,-.36970682634889585,41.393213350082036,261.2935935556502,12.935476055240873,13336.131683328815,1772.508612059496,369.76534388639965,29.751323653701338,2.4023193045459172,13.304795348228817,430.5615775526625,4237.0568611071185,-9581.931701634761,-1461.6913552409758,-183.12733958476446,-10.718010163869403,.41421356237309503,1.414213562373095,-.37677560326535325,41.619486213528496,241.05423794991074,-187.94665032361226,13450.063605744153,1836.153896465782,369.4908799925761,29.001847876923147,2.0714759319987186,6.779591200894186,377.7767837205709,3990.386575512536,-10081.709459700915,-1545.947424837898,-200.3762958015653,-11.864482073055006,.3578057213145241,1.546020906725474,-.3829366947518991,41.1516456456653,216.47684307105183,-406.1569483347166,13511.136535077321,1887.8076599260432,367.3025214564151,28.136213436723654,1.913880671464418,.3829366947518991,323.85365704338597,3728.1472257487526,-10561.233882199509,-1625.2025997821418,-217.62525175416,-13.015432208941645,.3033466836073424,1.66293922460509,-.5822628872992417,40.35639251440489,188.20071124269245,-640.2706748618148,13519.21490106562,1927.6022433578062,362.8197642637487,26.968821921868447,1.7463817695935329,-5.62650678237171,269.3016715297017,3453.386536448852,-11016.145278780888,-1698.6569643425091,-234.7658734267683,-14.16351421663124,.2504869601913055,1.76384252869671,-.5887180101749253,39.23429103868072,155.76096234403798,-889.2492977967378,13475.470561874661,1955.0535223723712,356.4450994756727,25.894952980042156,1.5695032905781554,-11.181939564328772,214.80884394039484,3169.1640829158237,-11443.321309975563,-1765.1588461316153,-251.68908574481912,-15.49755935939164,.198912367379658,1.847759065022573,-.7912582233652842,37.39369355329111,119.699486012458,-1151.0956593239027,13380.446257078214,1970.3952110853447,348.01959814116185,24.731487364283044,1.3850130831637748,-16.421408865300393,161.05030052864092,2878.3322807850063,-11838.991423510031,-1823.985884688674,-268.2854986386903,-16.81724543849939,.1483359875383474,1.913880671464418,-.7960642926861912,35.2322109610459,80.01928065061526,-1424.0212633405113,13235.794061869668,1973.804052543835,337.9908651258184,23.289159354463873,1.3934255946442087,-21.099669467133474,108.48348407242611,2583.700758091299,-12199.726194855148,-1874.2780658979746,-284.2467154529415,-18.11369784385905,.09849140335716425,1.961570560806461,-.998795456205172,32.56307803611191,36.958364584370486,-1706.075448829146,13043.287458812016,1965.3831106103316,326.43182772364605,22.175018750622293,1.198638339011324,-25.371248002043963,57.53505923036915,2288.41886619975,-12522.674544337233,-1914.8400385312243,-299.26241273417224,-19.37805630698734,.04912684976946725,1.990369453344394,.035780907*G0.SQRT2*.5/2384e-9,.017876148*G0.SQRT2*.5/2384e-9,.003134727*G0.SQRT2*.5/2384e-9,.002457142*G0.SQRT2*.5/2384e-9,971317e-9*G0.SQRT2*.5/2384e-9,218868e-9*G0.SQRT2*.5/2384e-9,101566e-9*G0.SQRT2*.5/2384e-9,13828e-9*G0.SQRT2*.5/2384e-9,12804.797818791945,1945.5515939597317,313.4244966442953,20.801593959731544,1995.1556208053692,9.000838926174497,-29.20218120805369],F=12,K=36,q=[[2382191739347913e-28,6423305872147834e-28,9400849094049688e-28,1122435026096556e-27,1183840321267481e-27,1122435026096556e-27,940084909404969e-27,6423305872147839e-28,2382191739347918e-28,5456116108943412e-27,4878985199565852e-27,4240448995017367e-27,3559909094758252e-27,2858043359288075e-27,2156177623817898e-27,1475637723558783e-27,8371015190102974e-28,2599706096327376e-28,-5456116108943412e-27,-4878985199565852e-27,-4240448995017367e-27,-3559909094758252e-27,-2858043359288076e-27,-2156177623817898e-27,-1475637723558783e-27,-8371015190102975e-28,-2599706096327376e-28,-2382191739347923e-28,-6423305872147843e-28,-9400849094049696e-28,-1122435026096556e-27,-1183840321267481e-27,-1122435026096556e-27,-9400849094049694e-28,-642330587214784e-27,-2382191739347918e-28],[2382191739347913e-28,6423305872147834e-28,9400849094049688e-28,1122435026096556e-27,1183840321267481e-27,1122435026096556e-27,9400849094049688e-28,6423305872147841e-28,2382191739347918e-28,5456116108943413e-27,4878985199565852e-27,4240448995017367e-27,3559909094758253e-27,2858043359288075e-27,2156177623817898e-27,1475637723558782e-27,8371015190102975e-28,2599706096327376e-28,-5461314069809755e-27,-4921085770524055e-27,-4343405037091838e-27,-3732668368707687e-27,-3093523840190885e-27,-2430835727329465e-27,-1734679010007751e-27,-974825365660928e-27,-2797435120168326e-28,0,0,0,0,0,0,-2283748241799531e-28,-4037858874020686e-28,-2146547464825323e-28],[.1316524975873958,.414213562373095,.7673269879789602,1.091308501069271,1.303225372841206,1.56968557711749,1.920982126971166,2.414213562373094,3.171594802363212,4.510708503662055,7.595754112725146,22.90376554843115,.984807753012208,.6427876096865394,.3420201433256688,.9396926207859084,-.1736481776669303,-.7660444431189779,.8660254037844387,.5,-.5144957554275265,-.4717319685649723,-.3133774542039019,-.1819131996109812,-.09457419252642064,-.04096558288530405,-.01419856857247115,-.003699974673760037,.8574929257125442,.8817419973177052,.9496286491027329,.9833145924917901,.9955178160675857,.9991605581781475,.999899195244447,.9999931550702802],[0,0,0,0,0,0,2283748241799531e-28,4037858874020686e-28,2146547464825323e-28,5461314069809755e-27,4921085770524055e-27,4343405037091838e-27,3732668368707687e-27,3093523840190885e-27,2430835727329466e-27,1734679010007751e-27,974825365660928e-27,2797435120168326e-28,-5456116108943413e-27,-4878985199565852e-27,-4240448995017367e-27,-3559909094758253e-27,-2858043359288075e-27,-2156177623817898e-27,-1475637723558782e-27,-8371015190102975e-28,-2599706096327376e-28,-2382191739347913e-28,-6423305872147834e-28,-9400849094049688e-28,-1122435026096556e-27,-1183840321267481e-27,-1122435026096556e-27,-9400849094049688e-28,-6423305872147841e-28,-2382191739347918e-28]],o0=q[f.SHORT_TYPE],X=q[f.SHORT_TYPE],J=q[f.SHORT_TYPE],h0=q[f.SHORT_TYPE],m0=[0,1,16,17,8,9,24,25,4,5,20,21,12,13,28,29,2,3,18,19,10,11,26,27,6,7,22,23,14,15,30,31];function C(w,B,e){for(var L=10,I=B+238-14-286,E=-15;E<0;E++){var s,d,x;s=M[L+-10],d=w[I+-224]*s,x=w[B+224]*s,s=M[L+-9],d+=w[I+-160]*s,x+=w[B+160]*s,s=M[L+-8],d+=w[I+-96]*s,x+=w[B+96]*s,s=M[L+-7],d+=w[I+-32]*s,x+=w[B+32]*s,s=M[L+-6],d+=w[I+32]*s,x+=w[B+-32]*s,s=M[L+-5],d+=w[I+96]*s,x+=w[B+-96]*s,s=M[L+-4],d+=w[I+160]*s,x+=w[B+-160]*s,s=M[L+-3],d+=w[I+224]*s,x+=w[B+-224]*s,s=M[L+-2],d+=w[B+-256]*s,x-=w[I+256]*s,s=M[L+-1],d+=w[B+-192]*s,x-=w[I+192]*s,s=M[L+0],d+=w[B+-128]*s,x-=w[I+128]*s,s=M[L+1],d+=w[B+-64]*s,x-=w[I+64]*s,s=M[L+2],d+=w[B+0]*s,x-=w[I+0]*s,s=M[L+3],d+=w[B+64]*s,x-=w[I+-64]*s,s=M[L+4],d+=w[B+128]*s,x-=w[I+-128]*s,s=M[L+5],d+=w[B+192]*s,x-=w[I+-192]*s,d*=M[L+6],s=x-d,e[30+E*2]=x+d,e[31+E*2]=M[L+7]*s,L+=18,B--,I++}{var d,x,y,R;x=w[B+-16]*M[L+-10],d=w[B+-32]*M[L+-2],x+=(w[B+-48]-w[B+16])*M[L+-9],d+=w[B+-96]*M[L+-1],x+=(w[B+-80]+w[B+48])*M[L+-8],d+=w[B+-160]*M[L+0],x+=(w[B+-112]-w[B+80])*M[L+-7],d+=w[B+-224]*M[L+1],x+=(w[B+-144]+w[B+112])*M[L+-6],d-=w[B+32]*M[L+2],x+=(w[B+-176]-w[B+144])*M[L+-5],d-=w[B+96]*M[L+3],x+=(w[B+-208]+w[B+176])*M[L+-4],d-=w[B+160]*M[L+4],x+=(w[B+-240]-w[B+208])*M[L+-3],d-=w[B+224],y=d-x,R=d+x,x=e[14],d=e[15]-x,e[31]=R+x,e[30]=y+d,e[15]=y-d,e[14]=R-x}{var t;t=e[28]-e[0],e[0]+=e[28],e[28]=t*M[L+-2*18+7],t=e[29]-e[1],e[1]+=e[29],e[29]=t*M[L+-2*18+7],t=e[26]-e[2],e[2]+=e[26],e[26]=t*M[L+-4*18+7],t=e[27]-e[3],e[3]+=e[27],e[27]=t*M[L+-4*18+7],t=e[24]-e[4],e[4]+=e[24],e[24]=t*M[L+-6*18+7],t=e[25]-e[5],e[5]+=e[25],e[25]=t*M[L+-6*18+7],t=e[22]-e[6],e[6]+=e[22],e[22]=t*G0.SQRT2,t=e[23]-e[7],e[7]+=e[23],e[23]=t*G0.SQRT2-e[7],e[7]-=e[6],e[22]-=e[7],e[23]-=e[22],t=e[6],e[6]=e[31]-t,e[31]=e[31]+t,t=e[7],e[7]=e[30]-t,e[30]=e[30]+t,t=e[22],e[22]=e[15]-t,e[15]=e[15]+t,t=e[23],e[23]=e[14]-t,e[14]=e[14]+t,t=e[20]-e[8],e[8]+=e[20],e[20]=t*M[L+-10*18+7],t=e[21]-e[9],e[9]+=e[21],e[21]=t*M[L+-10*18+7],t=e[18]-e[10],e[10]+=e[18],e[18]=t*M[L+-12*18+7],t=e[19]-e[11],e[11]+=e[19],e[19]=t*M[L+-12*18+7],t=e[16]-e[12],e[12]+=e[16],e[16]=t*M[L+-14*18+7],t=e[17]-e[13],e[13]+=e[17],e[17]=t*M[L+-14*18+7],t=-e[20]+e[24],e[20]+=e[24],e[24]=t*M[L+-12*18+7],t=-e[21]+e[25],e[21]+=e[25],e[25]=t*M[L+-12*18+7],t=e[4]-e[8],e[4]+=e[8],e[8]=t*M[L+-12*18+7],t=e[5]-e[9],e[5]+=e[9],e[9]=t*M[L+-12*18+7],t=e[0]-e[12],e[0]+=e[12],e[12]=t*M[L+-4*18+7],t=e[1]-e[13],e[1]+=e[13],e[13]=t*M[L+-4*18+7],t=e[16]-e[28],e[16]+=e[28],e[28]=t*M[L+-4*18+7],t=-e[17]+e[29],e[17]+=e[29],e[29]=t*M[L+-4*18+7],t=G0.SQRT2*(e[2]-e[10]),e[2]+=e[10],e[10]=t,t=G0.SQRT2*(e[3]-e[11]),e[3]+=e[11],e[11]=t,t=G0.SQRT2*(-e[18]+e[26]),e[18]+=e[26],e[26]=t-e[18],t=G0.SQRT2*(-e[19]+e[27]),e[19]+=e[27],e[27]=t-e[19],t=e[2],e[19]-=e[3],e[3]-=t,e[2]=e[31]-t,e[31]+=t,t=e[3],e[11]-=e[19],e[18]-=t,e[3]=e[30]-t,e[30]+=t,t=e[18],e[27]-=e[11],e[19]-=t,e[18]=e[15]-t,e[15]+=t,t=e[19],e[10]-=t,e[19]=e[14]-t,e[14]+=t,t=e[10],e[11]-=t,e[10]=e[23]-t,e[23]+=t,t=e[11],e[26]-=t,e[11]=e[22]-t,e[22]+=t,t=e[26],e[27]-=t,e[26]=e[7]-t,e[7]+=t,t=e[27],e[27]=e[6]-t,e[6]+=t,t=G0.SQRT2*(e[0]-e[4]),e[0]+=e[4],e[4]=t,t=G0.SQRT2*(e[1]-e[5]),e[1]+=e[5],e[5]=t,t=G0.SQRT2*(e[16]-e[20]),e[16]+=e[20],e[20]=t,t=G0.SQRT2*(e[17]-e[21]),e[17]+=e[21],e[21]=t,t=-G0.SQRT2*(e[8]-e[12]),e[8]+=e[12],e[12]=t-e[8],t=-G0.SQRT2*(e[9]-e[13]),e[9]+=e[13],e[13]=t-e[9],t=-G0.SQRT2*(e[25]-e[29]),e[25]+=e[29],e[29]=t-e[25],t=-G0.SQRT2*(e[24]+e[28]),e[24]-=e[28],e[28]=t-e[24],t=e[24]-e[16],e[24]=t,t=e[20]-t,e[20]=t,t=e[28]-t,e[28]=t,t=e[25]-e[17],e[25]=t,t=e[21]-t,e[21]=t,t=e[29]-t,e[29]=t,t=e[17]-e[1],e[17]=t,t=e[9]-t,e[9]=t,t=e[25]-t,e[25]=t,t=e[5]-t,e[5]=t,t=e[21]-t,e[21]=t,t=e[13]-t,e[13]=t,t=e[29]-t,e[29]=t,t=e[1]-e[0],e[1]=t,t=e[16]-t,e[16]=t,t=e[17]-t,e[17]=t,t=e[8]-t,e[8]=t,t=e[9]-t,e[9]=t,t=e[24]-t,e[24]=t,t=e[25]-t,e[25]=t,t=e[4]-t,e[4]=t,t=e[5]-t,e[5]=t,t=e[20]-t,e[20]=t,t=e[21]-t,e[21]=t,t=e[12]-t,e[12]=t,t=e[13]-t,e[13]=t,t=e[28]-t,e[28]=t,t=e[29]-t,e[29]=t,t=e[0],e[0]+=e[31],e[31]-=t,t=e[1],e[1]+=e[30],e[30]-=t,t=e[16],e[16]+=e[15],e[15]-=t,t=e[17],e[17]+=e[14],e[14]-=t,t=e[8],e[8]+=e[23],e[23]-=t,t=e[9],e[9]+=e[22],e[22]-=t,t=e[24],e[24]+=e[7],e[7]-=t,t=e[25],e[25]+=e[6],e[6]-=t,t=e[4],e[4]+=e[27],e[27]-=t,t=e[5],e[5]+=e[26],e[26]-=t,t=e[20],e[20]+=e[11],e[11]-=t,t=e[21],e[21]+=e[10],e[10]-=t,t=e[12],e[12]+=e[19],e[19]-=t,t=e[13],e[13]+=e[18],e[18]-=t,t=e[28],e[28]+=e[3],e[3]-=t,t=e[29],e[29]+=e[2],e[2]-=t}}function s0(w,B){for(var e=0;e<3;e++){var L,I,E,s,d,x;s=w[B+2*3]*q[f.SHORT_TYPE][0]-w[B+5*3],L=w[B+0*3]*q[f.SHORT_TYPE][2]-w[B+3*3],I=s+L,E=s-L,s=w[B+5*3]*q[f.SHORT_TYPE][0]+w[B+2*3],L=w[B+3*3]*q[f.SHORT_TYPE][2]+w[B+0*3],d=s+L,x=-s+L,L=(w[B+1*3]*q[f.SHORT_TYPE][1]-w[B+4*3])*2069978111953089e-26,s=(w[B+4*3]*q[f.SHORT_TYPE][1]+w[B+1*3])*2069978111953089e-26,w[B+3*0]=I*190752519173728e-25+L,w[B+3*5]=-d*190752519173728e-25+s,E=E*.8660254037844387*1907525191737281e-26,d=d*.5*1907525191737281e-26+s,w[B+3*1]=E-d,w[B+3*2]=E+d,I=I*.5*1907525191737281e-26-L,x=x*.8660254037844387*1907525191737281e-26,w[B+3*3]=I+x,w[B+3*4]=I-x,B++}}function b(w,B,e){var L,I;{var E,s,d,x,y,R,t,c;E=e[17]-e[9],d=e[15]-e[11],x=e[14]-e[12],y=e[0]+e[8],R=e[1]+e[7],t=e[2]+e[6],c=e[3]+e[5],w[B+17]=y+t-c-(R-e[4]),I=(y+t-c)*X[12+7]+(R-e[4]),L=(E-d-x)*X[12+6],w[B+5]=L+I,w[B+6]=L-I,s=(e[16]-e[10])*X[12+6],R=R*X[12+7]+e[4],L=E*X[12+0]+s+d*X[12+1]+x*X[12+2],I=-y*X[12+4]+R-t*X[12+5]+c*X[12+3],w[B+1]=L+I,w[B+2]=L-I,L=E*X[12+1]-s-d*X[12+2]+x*X[12+0],I=-y*X[12+5]+R-t*X[12+3]+c*X[12+4],w[B+9]=L+I,w[B+10]=L-I,L=E*X[12+2]-s+d*X[12+0]-x*X[12+1],I=y*X[12+3]-R+t*X[12+4]-c*X[12+5],w[B+13]=L+I,w[B+14]=L-I}{var _,n,u,v,r,i,l,S;_=e[8]-e[0],u=e[6]-e[2],v=e[5]-e[3],r=e[17]+e[9],i=e[16]+e[10],l=e[15]+e[11],S=e[14]+e[12],w[B+0]=r+l+S+(i+e[13]),L=(r+l+S)*X[12+7]-(i+e[13]),I=(_-u+v)*X[12+6],w[B+11]=L+I,w[B+12]=L-I,n=(e[7]-e[1])*X[12+6],i=e[13]-i*X[12+7],L=r*X[12+3]-i+l*X[12+4]+S*X[12+5],I=_*X[12+2]+n+u*X[12+0]+v*X[12+1],w[B+3]=L+I,w[B+4]=L-I,L=-r*X[12+5]+i-l*X[12+3]-S*X[12+4],I=_*X[12+1]+n-u*X[12+2]-v*X[12+0],w[B+7]=L+I,w[B+8]=L-I,L=-r*X[12+4]+i-l*X[12+5]-S*X[12+3],I=_*X[12+0]-n+u*X[12+1]-v*X[12+2],w[B+15]=L+I,w[B+16]=L-I}}this.mdct_sub48=function(w,B,e){for(var L=B,I=286,E=0;E<w.channels_out;E++){for(var s=0;s<w.mode_gr;s++){for(var d,x=w.l3_side.tt[s][E],y=x.xr,R=0,t=w.sb_sample[E][1-s],c=0,_=0;_<18/2;_++)for(C(L,I,t[c]),C(L,I+32,t[c+1]),c+=2,I+=64,d=1;d<32;d+=2)t[c-1][d]*=-1;for(d=0;d<32;d++,R+=18){var n=x.block_type,u=w.sb_sample[E][s],v=w.sb_sample[E][1-s];if(x.mixed_block_flag!=0&&d<2&&(n=0),w.amp_filter[d]<1e-12)we.fill(y,R+0,R+18,0);else{if(w.amp_filter[d]<1)for(var _=0;_<18;_++)v[_][m0[d]]*=w.amp_filter[d];if(n==f.SHORT_TYPE){for(var _=-F/4;_<0;_++){var r=q[f.SHORT_TYPE][_+3];y[R+_*3+9]=u[9+_][m0[d]]*r-u[8-_][m0[d]],y[R+_*3+18]=u[14-_][m0[d]]*r+u[15+_][m0[d]],y[R+_*3+10]=u[15+_][m0[d]]*r-u[14-_][m0[d]],y[R+_*3+19]=v[2-_][m0[d]]*r+v[3+_][m0[d]],y[R+_*3+11]=v[3+_][m0[d]]*r-v[2-_][m0[d]],y[R+_*3+20]=v[8-_][m0[d]]*r+v[9+_][m0[d]]}s0(y,R)}else{for(var i=ge(18),_=-K/4;_<0;_++){var l,S;l=q[n][_+27]*v[_+9][m0[d]]+q[n][_+36]*v[8-_][m0[d]],S=q[n][_+9]*u[_+9][m0[d]]-q[n][_+18]*u[8-_][m0[d]],i[_+9]=l-S*o0[3+_+9],i[_+18]=l*o0[3+_+9]+S}b(y,R,i)}}if(n!=f.SHORT_TYPE&&d!=0)for(var _=7;_>=0;--_){var Y,k;Y=y[R+_]*J[20+_]+y[R+-1-_]*h0[28+_],k=y[R+_]*h0[28+_]-y[R+-1-_]*J[20+_],y[R+-1-_]=Y,y[R+_]=k}}}if(L=e,I=286,w.mode_gr==1)for(var O=0;O<18;O++)W0.arraycopy(w.sb_sample[E][1][O],0,w.sb_sample[E][0][O],0,32)}}}var oe=se,ye=z.System,J0=z.new_float,P0=z.new_float_n;function ie(){this.l=J0(f.SBMAX_l),this.s=P0([f.SBMAX_s,3]);var M=this;this.assign=function(F){ye.arraycopy(F.l,0,M.l,0,f.SBMAX_l);for(var K=0;K<f.SBMAX_s;K++)for(var q=0;q<3;q++)M.s[K][q]=F.s[K][q]}}var Fe=ie;function d1(){this.thm=new Fe,this.en=new Fe}var h1=d1,t1=z.System,We=z.VbrMode,a1=z.new_array_n,r1=z.new_float,S1=z.new_float_n,M1=z.new_int,Ye=z.assert;X0.ENCDELAY=576,X0.POSTDELAY=1152,X0.MDCTDELAY=48,X0.FFTOFFSET=224+X0.MDCTDELAY,X0.DECDELAY=528,X0.SBLIMIT=32,X0.CBANDS=64,X0.SBPSY_l=21,X0.SBPSY_s=12,X0.SBMAX_l=22,X0.SBMAX_s=13,X0.PSFB21=6,X0.PSFB12=6,X0.BLKSIZE=1024,X0.HBLKSIZE=X0.BLKSIZE/2+1,X0.BLKSIZE_s=256,X0.HBLKSIZE_s=X0.BLKSIZE_s/2+1,X0.NORM_TYPE=0,X0.START_TYPE=1,X0.SHORT_TYPE=2,X0.STOP_TYPE=3,X0.MPG_MD_LR_LR=0,X0.MPG_MD_LR_I=1,X0.MPG_MD_MS_LR=2,X0.MPG_MD_MS_I=3,X0.fircoef=[-.0207887*5,-.0378413*5,-.0432472*5,-.031183*5,779609e-23*5,.0467745*5,.10091*5,.151365*5,.187098*5];function X0(){var M=oe,F=h1,K=X0.FFTOFFSET,q=X0.MPG_MD_MS_LR,o0=null;this.psy=null;var X=null,J=null,h0=null;this.setModules=function(w,B,e,L){o0=w,this.psy=B,X=B,J=L,h0=e};var m0=new M;function C(w){var B,e;if(w.ATH.useAdjust==0){w.ATH.adjust=1;return}if(e=w.loudness_sq[0][0],B=w.loudness_sq[1][0],w.channels_out==2?(e+=w.loudness_sq[0][1],B+=w.loudness_sq[1][1]):(e+=e,B+=B),w.mode_gr==2&&(e=Math.max(e,B)),e*=.5,e*=w.ATH.aaSensitivityP,e>.03125)w.ATH.adjust>=1?w.ATH.adjust=1:w.ATH.adjust<w.ATH.adjustLimit&&(w.ATH.adjust=w.ATH.adjustLimit),w.ATH.adjustLimit=1;else{var L=31.98*e+625e-6;w.ATH.adjust>=L?(w.ATH.adjust*=L*.075+.925,w.ATH.adjust<L&&(w.ATH.adjust=L)):w.ATH.adjustLimit>=L?w.ATH.adjust=L:w.ATH.adjust<w.ATH.adjustLimit&&(w.ATH.adjust=w.ATH.adjustLimit),w.ATH.adjustLimit=L}}function s0(w){var B,e;for(Ye(0<=w.bitrate_index&&w.bitrate_index<16),Ye(0<=w.mode_ext&&w.mode_ext<4),w.bitrate_stereoMode_Hist[w.bitrate_index][4]++,w.bitrate_stereoMode_Hist[15][4]++,w.channels_out==2&&(w.bitrate_stereoMode_Hist[w.bitrate_index][w.mode_ext]++,w.bitrate_stereoMode_Hist[15][w.mode_ext]++),B=0;B<w.mode_gr;++B)for(e=0;e<w.channels_out;++e){var L=w.l3_side.tt[B][e].block_type|0;w.l3_side.tt[B][e].mixed_block_flag!=0&&(L=4),w.bitrate_blockType_Hist[w.bitrate_index][L]++,w.bitrate_blockType_Hist[w.bitrate_index][5]++,w.bitrate_blockType_Hist[15][L]++,w.bitrate_blockType_Hist[15][5]++}}function b(w,B){var e=w.internal_flags,L,I;if(e.lame_encode_frame_init==0){var E,s,d=r1(2014),x=r1(286+1152+576);for(e.lame_encode_frame_init=1,E=0,s=0;E<286+576*(1+e.mode_gr);++E)E<576*e.mode_gr?(d[E]=0,e.channels_out==2&&(x[E]=0)):(d[E]=B[0][s],e.channels_out==2&&(x[E]=B[1][s]),++s);for(I=0;I<e.mode_gr;I++)for(L=0;L<e.channels_out;L++)e.l3_side.tt[I][L].block_type=X0.SHORT_TYPE;m0.mdct_sub48(e,d,x),Ye(e.mf_size>=X0.BLKSIZE+w.framesize-X0.FFTOFFSET),Ye(e.mf_size>=512+w.framesize-32)}}this.lame_encode_mp3_frame=function(w,B,e,L,I,E){var s,d=a1([2,2]);d[0][0]=new F,d[0][1]=new F,d[1][0]=new F,d[1][1]=new F;var x=a1([2,2]);x[0][0]=new F,x[0][1]=new F,x[1][0]=new F,x[1][1]=new F;var y,R=[null,null],t=w.internal_flags,c=S1([2,4]),_=[.5,.5],n=[[0,0],[0,0]],u=[[0,0],[0,0]],v,r,i;if(R[0]=B,R[1]=e,t.lame_encode_frame_init==0&&b(w,R),t.padding=0,(t.slot_lag-=t.frac_SpF)<0&&(t.slot_lag+=w.out_samplerate,t.padding=1),t.psymodel!=0){var l,S=[null,null],Y=0,k=M1(2);for(i=0;i<t.mode_gr;i++){for(r=0;r<t.channels_out;r++)S[r]=R[r],Y=576+i*576-X0.FFTOFFSET;if(w.VBR==We.vbr_mtrh||w.VBR==We.vbr_mt?l=X.L3psycho_anal_vbr(w,S,Y,i,d,x,n[i],u[i],c[i],k):l=X.L3psycho_anal_ns(w,S,Y,i,d,x,n[i],u[i],c[i],k),l!=0)return-4;for(w.mode==Te.JOINT_STEREO&&(_[i]=c[i][2]+c[i][3],_[i]>0&&(_[i]=c[i][3]/_[i])),r=0;r<t.channels_out;r++){var O=t.l3_side.tt[i][r];O.block_type=k[r],O.mixed_block_flag=0}}}else for(i=0;i<t.mode_gr;i++)for(r=0;r<t.channels_out;r++)t.l3_side.tt[i][r].block_type=X0.NORM_TYPE,t.l3_side.tt[i][r].mixed_block_flag=0,u[i][r]=n[i][r]=700;if(C(t),m0.mdct_sub48(t,R[0],R[1]),t.mode_ext=X0.MPG_MD_LR_LR,w.force_ms)t.mode_ext=X0.MPG_MD_MS_LR;else if(w.mode==Te.JOINT_STEREO){var a=0,o=0;for(i=0;i<t.mode_gr;i++)for(r=0;r<t.channels_out;r++)a+=u[i][r],o+=n[i][r];if(a<=1*o){var j=t.l3_side.tt[0],e0=t.l3_side.tt[t.mode_gr-1];j[0].block_type==j[1].block_type&&e0[0].block_type==e0[1].block_type&&(t.mode_ext=X0.MPG_MD_MS_LR)}}if(t.mode_ext==q?(y=x,v=u):(y=d,v=n),w.analysis&&t.pinfo!=null)for(i=0;i<t.mode_gr;i++)for(r=0;r<t.channels_out;r++)t.pinfo.ms_ratio[i]=t.ms_ratio[i],t.pinfo.ms_ener_ratio[i]=_[i],t.pinfo.blocktype[i][r]=t.l3_side.tt[i][r].block_type,t.pinfo.pe[i][r]=v[i][r],t1.arraycopy(t.l3_side.tt[i][r].xr,0,t.pinfo.xr[i][r],0,576),t.mode_ext==q&&(t.pinfo.ers[i][r]=t.pinfo.ers[i][r+2],t1.arraycopy(t.pinfo.energy[i][r+2],0,t.pinfo.energy[i][r],0,t.pinfo.energy[i][r].length));if(w.VBR==We.vbr_off||w.VBR==We.vbr_abr){var f0,y0;for(f0=0;f0<18;f0++)t.nsPsy.pefirbuf[f0]=t.nsPsy.pefirbuf[f0+1];for(y0=0,i=0;i<t.mode_gr;i++)for(r=0;r<t.channels_out;r++)y0+=v[i][r];for(t.nsPsy.pefirbuf[18]=y0,y0=t.nsPsy.pefirbuf[9],f0=0;f0<9;f0++)y0+=(t.nsPsy.pefirbuf[f0]+t.nsPsy.pefirbuf[18-f0])*X0.fircoef[f0];for(y0=670*5*t.mode_gr*t.channels_out/y0,i=0;i<t.mode_gr;i++)for(r=0;r<t.channels_out;r++)v[i][r]*=y0}if(t.iteration_loop.iteration_loop(w,v,_,y),o0.format_bitstream(w),s=o0.copy_buffer(t,L,I,E,1),w.bWriteVbrTag&&J.addVbrFrame(w),w.analysis&&t.pinfo!=null){for(r=0;r<t.channels_out;r++){var p0;for(p0=0;p0<K;p0++)t.pinfo.pcmdata[r][p0]=t.pinfo.pcmdata[r][p0+w.framesize];for(p0=K;p0<1600;p0++)t.pinfo.pcmdata[r][p0]=R[r][p0-K]}h0.set_frame_pinfo(w,y)}return s0(t),s}}var f=X0,H1=z.Util,k1=z.new_float;function C1(){var M=k1(f.BLKSIZE),F=k1(f.BLKSIZE_s/2),K=[.9238795325112867,.3826834323650898,.9951847266721969,.0980171403295606,.9996988186962042,.02454122852291229,.9999811752826011,.006135884649154475];function q(X,J,h0){var m0=0,C,s0,b;h0<<=1;var w=J+h0;C=4;do{var B,e,L,I,E,s,d;d=C>>1,I=C,E=C<<1,s=E+I,C=E<<1,s0=J,b=s0+d;do{var x,y,R,t;y=X[s0+0]-X[s0+I],x=X[s0+0]+X[s0+I],t=X[s0+E]-X[s0+s],R=X[s0+E]+X[s0+s],X[s0+E]=x-R,X[s0+0]=x+R,X[s0+s]=y-t,X[s0+I]=y+t,y=X[b+0]-X[b+I],x=X[b+0]+X[b+I],t=H1.SQRT2*X[b+s],R=H1.SQRT2*X[b+E],X[b+E]=x-R,X[b+0]=x+R,X[b+s]=y-t,X[b+I]=y+t,b+=C,s0+=C}while(s0<w);for(e=K[m0+0],B=K[m0+1],L=1;L<d;L++){var c,_;c=1-2*B*B,_=2*B*e,s0=J+L,b=J+I-L;do{var n,u,v,x,y,r,R,i,t,l;u=_*X[s0+I]-c*X[b+I],n=c*X[s0+I]+_*X[b+I],y=X[s0+0]-n,x=X[s0+0]+n,r=X[b+0]-u,v=X[b+0]+u,u=_*X[s0+s]-c*X[b+s],n=c*X[s0+s]+_*X[b+s],t=X[s0+E]-n,R=X[s0+E]+n,l=X[b+E]-u,i=X[b+E]+u,u=B*R-e*l,n=e*R+B*l,X[s0+E]=x-n,X[s0+0]=x+n,X[b+s]=r-u,X[b+I]=r+u,u=e*i-B*t,n=B*i+e*t,X[b+E]=v-n,X[b+0]=v+n,X[s0+s]=y-u,X[s0+I]=y+u,b+=C,s0+=C}while(s0<w);c=e,e=c*K[m0+0]-B*K[m0+1],B=c*K[m0+1]+B*K[m0+0]}m0+=2}while(C<h0)}var o0=[0,128,64,192,32,160,96,224,16,144,80,208,48,176,112,240,8,136,72,200,40,168,104,232,24,152,88,216,56,184,120,248,4,132,68,196,36,164,100,228,20,148,84,212,52,180,116,244,12,140,76,204,44,172,108,236,28,156,92,220,60,188,124,252,2,130,66,194,34,162,98,226,18,146,82,210,50,178,114,242,10,138,74,202,42,170,106,234,26,154,90,218,58,186,122,250,6,134,70,198,38,166,102,230,22,150,86,214,54,182,118,246,14,142,78,206,46,174,110,238,30,158,94,222,62,190,126,254];this.fft_short=function(X,J,h0,m0,C){for(var s0=0;s0<3;s0++){var b=f.BLKSIZE_s/2,w=65535&576/3*(s0+1),B=f.BLKSIZE_s/8-1;do{var e,L,I,E,s,d=o0[B<<2]&255;e=F[d]*m0[h0][C+d+w],s=F[127-d]*m0[h0][C+d+w+128],L=e-s,e=e+s,I=F[d+64]*m0[h0][C+d+w+64],s=F[63-d]*m0[h0][C+d+w+192],E=I-s,I=I+s,b-=4,J[s0][b+0]=e+I,J[s0][b+2]=e-I,J[s0][b+1]=L+E,J[s0][b+3]=L-E,e=F[d+1]*m0[h0][C+d+w+1],s=F[126-d]*m0[h0][C+d+w+129],L=e-s,e=e+s,I=F[d+65]*m0[h0][C+d+w+65],s=F[62-d]*m0[h0][C+d+w+193],E=I-s,I=I+s,J[s0][b+f.BLKSIZE_s/2+0]=e+I,J[s0][b+f.BLKSIZE_s/2+2]=e-I,J[s0][b+f.BLKSIZE_s/2+1]=L+E,J[s0][b+f.BLKSIZE_s/2+3]=L-E}while(--B>=0);q(J[s0],b,f.BLKSIZE_s/2)}},this.fft_long=function(X,J,h0,m0,C){var s0=f.BLKSIZE/8-1,b=f.BLKSIZE/2;do{var w,B,e,L,I,E=o0[s0]&255;w=M[E]*m0[h0][C+E],I=M[E+512]*m0[h0][C+E+512],B=w-I,w=w+I,e=M[E+256]*m0[h0][C+E+256],I=M[E+768]*m0[h0][C+E+768],L=e-I,e=e+I,b-=4,J[b+0]=w+e,J[b+2]=w-e,J[b+1]=B+L,J[b+3]=B-L,w=M[E+1]*m0[h0][C+E+1],I=M[E+513]*m0[h0][C+E+513],B=w-I,w=w+I,e=M[E+257]*m0[h0][C+E+257],I=M[E+769]*m0[h0][C+E+769],L=e-I,e=e+I,J[b+f.BLKSIZE/2+0]=w+e,J[b+f.BLKSIZE/2+2]=w-e,J[b+f.BLKSIZE/2+1]=B+L,J[b+f.BLKSIZE/2+3]=B-L}while(--s0>=0);q(J,b,f.BLKSIZE/2)},this.init_fft=function(X){for(var J=0;J<f.BLKSIZE;J++)M[J]=.42-.5*Math.cos(2*Math.PI*(J+.5)/f.BLKSIZE)+.08*Math.cos(4*Math.PI*(J+.5)/f.BLKSIZE);for(var J=0;J<f.BLKSIZE_s/2;J++)F[J]=.5*(1-Math.cos(2*Math.PI*(J+.5)/f.BLKSIZE_s))}}var g1=C1,s1=z.VbrMode,$0=z.Float,n0=z.ShortBlock,O0=z.Util,A1=z.Arrays,ce=z.new_float,Oe=z.new_float_n,f1=z.new_int,z0=z.assert;function At(){var M=new g1,F=2.302585092994046,K=2,q=16,o0=2,X=16,J=.34,h0=1/(14752*14752)/(f.BLKSIZE/2),m0=.01,C=.8,s0=.6,b=.3,w=3.5,B=21,e=.2302585093;function L(h){return h}function I(h,m){for(var T=0,g=0;g<f.BLKSIZE/2;++g)T+=h[g]*m.ATH.eql_w[g];return T*=h0,T}function E(h,m,T,g,H,A,$,D,V,t0,P){var a0=h.internal_flags;if(V<2)M.fft_long(a0,g[H],V,t0,P),M.fft_short(a0,A[$],V,t0,P);else if(V==2){for(var A0=f.BLKSIZE-1;A0>=0;--A0){var V0=g[H+0][A0],u0=g[H+1][A0];g[H+0][A0]=(V0+u0)*O0.SQRT2*.5,g[H+1][A0]=(V0-u0)*O0.SQRT2*.5}for(var N0=2;N0>=0;--N0)for(var A0=f.BLKSIZE_s-1;A0>=0;--A0){var V0=A[$+0][N0][A0],u0=A[$+1][N0][A0];A[$+0][N0][A0]=(V0+u0)*O0.SQRT2*.5,A[$+1][N0][A0]=(V0-u0)*O0.SQRT2*.5}}m[0]=g[H+0][0],m[0]*=m[0];for(var A0=f.BLKSIZE/2-1;A0>=0;--A0){var Q=g[H+0][f.BLKSIZE/2-A0],T0=g[H+0][f.BLKSIZE/2+A0];m[f.BLKSIZE/2-A0]=(Q*Q+T0*T0)*.5}for(var N0=2;N0>=0;--N0){T[N0][0]=A[$+0][N0][0],T[N0][0]*=T[N0][0];for(var A0=f.BLKSIZE_s/2-1;A0>=0;--A0){var Q=A[$+0][N0][f.BLKSIZE_s/2-A0],T0=A[$+0][N0][f.BLKSIZE_s/2+A0];T[N0][f.BLKSIZE_s/2-A0]=(Q*Q+T0*T0)*.5}}{for(var U0=0,A0=11;A0<f.HBLKSIZE;A0++)U0+=m[A0];a0.tot_ener[V]=U0}if(h.analysis){for(var A0=0;A0<f.HBLKSIZE;A0++)a0.pinfo.energy[D][V][A0]=a0.pinfo.energy_save[V][A0],a0.pinfo.energy_save[V][A0]=m[A0];a0.pinfo.pe[D][V]=a0.pe[V]}h.athaa_loudapprox==2&&V<2&&(a0.loudness_sq[D][V]=a0.loudness_sq_save[V],a0.loudness_sq_save[V]=I(m,a0))}var s=8,d=23,x=15,y,R,t,c=[1,.79433,.63096,.63096,.63096,.63096,.63096,.25119,.11749];function _(){y=Math.pow(10,(s+1)/16),R=Math.pow(10,(d+1)/16),t=Math.pow(10,x/10)}var n=[3.3246*3.3246,3.23837*3.23837,3.15437*3.15437,3.00412*3.00412,2.86103*2.86103,2.65407*2.65407,2.46209*2.46209,2.284*2.284,2.11879*2.11879,1.96552*1.96552,1.82335*1.82335,1.69146*1.69146,1.56911*1.56911,1.46658*1.46658,1.37074*1.37074,1.31036*1.31036,1.25264*1.25264,1.20648*1.20648,1.16203*1.16203,1.12765*1.12765,1.09428*1.09428,1.0659*1.0659,1.03826*1.03826,1.01895*1.01895,1],u=[1.33352*1.33352,1.35879*1.35879,1.38454*1.38454,1.39497*1.39497,1.40548*1.40548,1.3537*1.3537,1.30382*1.30382,1.22321*1.22321,1.14758*1.14758,1],v=[2.35364*2.35364,2.29259*2.29259,2.23313*2.23313,2.12675*2.12675,2.02545*2.02545,1.87894*1.87894,1.74303*1.74303,1.61695*1.61695,1.49999*1.49999,1.39148*1.39148,1.29083*1.29083,1.19746*1.19746,1.11084*1.11084,1.03826*1.03826];function r(h,m,T,g,H,A){var $;if(m>h)if(m<h*R)$=m/h;else return h+m;else{if(h>=m*R)return h+m;$=h/m}if(h+=m,g+3<=3+3){if($>=y)return h;var D=0|O0.FAST_LOG10_X($,16);return h*u[D]}var D=0|O0.FAST_LOG10_X($,16);if(A!=0?m=H.ATH.cb_s[T]*H.ATH.adjust:m=H.ATH.cb_l[T]*H.ATH.adjust,h<t*m){if(h>m){var V,t0;return V=1,D<=13&&(V=v[D]),t0=O0.FAST_LOG10_X(h/m,10/15),h*((n[D]-V)*t0+V)}return D>13?h:h*v[D]}return h*n[D]}var i=[1.33352*1.33352,1.35879*1.35879,1.38454*1.38454,1.39497*1.39497,1.40548*1.40548,1.3537*1.3537,1.30382*1.30382,1.22321*1.22321,1.14758*1.14758,1];function l(h,m,T){var g;if(h<0&&(h=0),m<0&&(m=0),h<=0)return m;if(m<=0)return h;if(m>h?g=m/h:g=h/m,-2<=T&&T<=2){if(g>=y)return h+m;var H=0|O0.FAST_LOG10_X(g,16);return(h+m)*i[H]}return g<R?h+m:(h<m&&(h=m),h)}function S(h,m){var T=h.internal_flags;if(T.channels_out>1){for(var g=0;g<f.SBMAX_l;g++){var H=T.thm[0].l[g],A=T.thm[1].l[g];T.thm[0].l[g]+=A*m,T.thm[1].l[g]+=H*m}for(var g=0;g<f.SBMAX_s;g++)for(var $=0;$<3;$++){var H=T.thm[0].s[g][$],A=T.thm[1].s[g][$];T.thm[0].s[g][$]+=A*m,T.thm[1].s[g][$]+=H*m}}}function Y(h){for(var m=0;m<f.SBMAX_l;m++)if(!(h.thm[0].l[m]>1.58*h.thm[1].l[m]||h.thm[1].l[m]>1.58*h.thm[0].l[m])){var T=h.mld_l[m]*h.en[3].l[m],g=Math.max(h.thm[2].l[m],Math.min(h.thm[3].l[m],T));T=h.mld_l[m]*h.en[2].l[m];var H=Math.max(h.thm[3].l[m],Math.min(h.thm[2].l[m],T));h.thm[2].l[m]=g,h.thm[3].l[m]=H}for(var m=0;m<f.SBMAX_s;m++)for(var A=0;A<3;A++)if(!(h.thm[0].s[m][A]>1.58*h.thm[1].s[m][A]||h.thm[1].s[m][A]>1.58*h.thm[0].s[m][A])){var T=h.mld_s[m]*h.en[3].s[m][A],g=Math.max(h.thm[2].s[m][A],Math.min(h.thm[3].s[m][A],T));T=h.mld_s[m]*h.en[2].s[m][A];var H=Math.max(h.thm[3].s[m][A],Math.min(h.thm[2].s[m][A],T));h.thm[2].s[m][A]=g,h.thm[3].s[m][A]=H}}function k(h,m,T){var g=m,H=Math.pow(10,T);m*=2,g*=2;for(var A=0;A<f.SBMAX_l;A++){var $,D,V,t0;if(t0=h.ATH.cb_l[h.bm_l[A]]*H,$=Math.min(Math.max(h.thm[0].l[A],t0),Math.max(h.thm[1].l[A],t0)),D=Math.max(h.thm[2].l[A],t0),V=Math.max(h.thm[3].l[A],t0),$*m<D+V){var P=$*g/(D+V);D*=P,V*=P}h.thm[2].l[A]=Math.min(D,h.thm[2].l[A]),h.thm[3].l[A]=Math.min(V,h.thm[3].l[A])}H*=f.BLKSIZE_s/f.BLKSIZE;for(var A=0;A<f.SBMAX_s;A++)for(var a0=0;a0<3;a0++){var $,D,V,t0;if(t0=h.ATH.cb_s[h.bm_s[A]]*H,$=Math.min(Math.max(h.thm[0].s[A][a0],t0),Math.max(h.thm[1].s[A][a0],t0)),D=Math.max(h.thm[2].s[A][a0],t0),V=Math.max(h.thm[3].s[A][a0],t0),$*m<D+V){var P=$*m/(D+V);D*=P,V*=P}h.thm[2].s[A][a0]=Math.min(h.thm[2].s[A][a0],D),h.thm[3].s[A][a0]=Math.min(h.thm[3].s[A][a0],V)}}function O(h,m,T,g,H){var A,$,D=0,V=0;for(A=$=0;A<f.SBMAX_s;++$,++A){for(var t0=h.bo_s[A],P=h.npart_s,a0=t0<P?t0:P;$<a0;)z0(m[$]>=0),z0(T[$]>=0),D+=m[$],V+=T[$],$++;if(h.en[g].s[A][H]=D,h.thm[g].s[A][H]=V,$>=P){++A;break}z0(m[$]>=0),z0(T[$]>=0);{var A0=h.PSY.bo_s_weight[A],V0=1-A0;D=A0*m[$],V=A0*T[$],h.en[g].s[A][H]+=D,h.thm[g].s[A][H]+=V,D=V0*m[$],V=V0*T[$]}}for(;A<f.SBMAX_s;++A)h.en[g].s[A][H]=0,h.thm[g].s[A][H]=0}function a(h,m,T,g){var H,A,$=0,D=0;for(H=A=0;H<f.SBMAX_l;++A,++H){for(var V=h.bo_l[H],t0=h.npart_l,P=V<t0?V:t0;A<P;)z0(m[A]>=0),z0(T[A]>=0),$+=m[A],D+=T[A],A++;if(h.en[g].l[H]=$,h.thm[g].l[H]=D,A>=t0){++H;break}z0(m[A]>=0),z0(T[A]>=0);{var a0=h.PSY.bo_l_weight[H],A0=1-a0;$=a0*m[A],D=a0*T[A],h.en[g].l[H]+=$,h.thm[g].l[H]+=D,$=A0*m[A],D=A0*T[A]}}for(;H<f.SBMAX_l;++H)h.en[g].l[H]=0,h.thm[g].l[H]=0}function o(h,m,T,g,H,A){var $=h.internal_flags,D,V;for(V=D=0;V<$.npart_s;++V){for(var t0=0,P=$.numlines_s[V],a0=0;a0<P;++a0,++D){var A0=m[A][D];t0+=A0}T[V]=t0}for(z0(V==$.npart_s),D=V=0;V<$.npart_s;V++){var V0=$.s3ind_s[V][0],u0=$.s3_ss[D++]*T[V0];for(++V0;V0<=$.s3ind_s[V][1];)u0+=$.s3_ss[D]*T[V0],++D,++V0;{var N0=o0*$.nb_s1[H][V];g[V]=Math.min(u0,N0)}if($.blocktype_old[H&1]==f.SHORT_TYPE){var N0=X*$.nb_s2[H][V],Q=g[V];g[V]=Math.min(N0,Q)}$.nb_s2[H][V]=$.nb_s1[H][V],$.nb_s1[H][V]=u0,z0(g[V]>=0)}for(;V<=f.CBANDS;++V)T[V]=0,g[V]=0}function j(h,m,T,g){var H=h.internal_flags;h.short_blocks==n0.short_block_coupled&&!(m[0]!=0&&m[1]!=0)&&(m[0]=m[1]=0);for(var A=0;A<H.channels_out;A++)g[A]=f.NORM_TYPE,h.short_blocks==n0.short_block_dispensed&&(m[A]=1),h.short_blocks==n0.short_block_forced&&(m[A]=0),m[A]!=0?(z0(H.blocktype_old[A]!=f.START_TYPE),H.blocktype_old[A]==f.SHORT_TYPE&&(g[A]=f.STOP_TYPE)):(g[A]=f.SHORT_TYPE,H.blocktype_old[A]==f.NORM_TYPE&&(H.blocktype_old[A]=f.START_TYPE),H.blocktype_old[A]==f.STOP_TYPE&&(H.blocktype_old[A]=f.SHORT_TYPE)),T[A]=H.blocktype_old[A],H.blocktype_old[A]=g[A]}function e0(h,m,T){return T>=1?h:T<=0?m:m>0?Math.pow(h/m,T)*m:0}var f0=[11.8,13.6,17.2,32,46.5,51.3,57.5,67.1,71.5,84.6,97.6,130];function y0(h,m){for(var T=309.07,g=0;g<f.SBMAX_s-1;g++)for(var H=0;H<3;H++){var A=h.thm.s[g][H];if(A>0){var $=A*m,D=h.en.s[g][H];D>$&&(D>$*1e10?T+=f0[g]*(10*F):T+=f0[g]*O0.FAST_LOG10(D/$))}}return T}var p0=[6.8,5.8,5.8,6.4,6.5,9.9,12.1,14.4,15,18.9,21.6,26.9,34.2,40.2,46.8,56.5,60.7,73.9,85.7,93.4,126.1];function w0(h,m){for(var T=281.0575,g=0;g<f.SBMAX_l-1;g++){var H=h.thm.l[g];if(H>0){var A=H*m,$=h.en.l[g];$>A&&($>A*1e10?T+=p0[g]*(10*F):T+=p0[g]*O0.FAST_LOG10($/A))}}return T}function F0(h,m,T,g,H){var A,$;for(A=$=0;A<h.npart_l;++A){var D=0,V=0,t0;for(t0=0;t0<h.numlines_l[A];++t0,++$){var P=m[$];D+=P,V<P&&(V=P)}T[A]=D,g[A]=V,H[A]=D*h.rnumlines_l[A],z0(h.rnumlines_l[A]>=0),z0(T[A]>=0),z0(g[A]>=0),z0(H[A]>=0)}}function k0(h,m,T,g){var H=c.length-1,A=0,$=T[A]+T[A+1];if($>0){var D=m[A];D<m[A+1]&&(D=m[A+1]),z0(h.numlines_l[A]+h.numlines_l[A+1]-1>0),$=20*(D*2-$)/($*(h.numlines_l[A]+h.numlines_l[A+1]-1));var V=0|$;V>H&&(V=H),g[A]=V}else g[A]=0;for(A=1;A<h.npart_l-1;A++)if($=T[A-1]+T[A]+T[A+1],$>0){var D=m[A-1];D<m[A]&&(D=m[A]),D<m[A+1]&&(D=m[A+1]),z0(h.numlines_l[A-1]+h.numlines_l[A]+h.numlines_l[A+1]-1>0),$=20*(D*3-$)/($*(h.numlines_l[A-1]+h.numlines_l[A]+h.numlines_l[A+1]-1));var V=0|$;V>H&&(V=H),g[A]=V}else g[A]=0;if(z0(A==h.npart_l-1),$=T[A-1]+T[A],$>0){var D=m[A-1];D<m[A]&&(D=m[A]),z0(h.numlines_l[A-1]+h.numlines_l[A]-1>0),$=20*(D*2-$)/($*(h.numlines_l[A-1]+h.numlines_l[A]-1));var V=0|$;V>H&&(V=H),g[A]=V}else g[A]=0;z0(A==h.npart_l-1)}var b0=[-865163e-23*2,-.00851586*2,-674764e-23*2,.0209036*2,-336639e-22*2,-.0438162*2,-154175e-22*2,.0931738*2,-552212e-22*2,-.313819*2];this.L3psycho_anal_ns=function(h,m,T,g,H,A,$,D,V,t0){var P=h.internal_flags,a0=Oe([2,f.BLKSIZE]),A0=Oe([2,3,f.BLKSIZE_s]),V0=ce(f.CBANDS+1),u0=ce(f.CBANDS+1),N0=ce(f.CBANDS+2),Q=f1(2),T0=f1(2),U0,v0,C0,c0,H0,ve,B0,Z0,Q0=Oe([2,576]),me,ze=f1(f.CBANDS+2),Ae=f1(f.CBANDS+2);for(A1.fill(Ae,0),U0=P.channels_out,h.mode==Te.JOINT_STEREO&&(U0=4),h.VBR==s1.vbr_off?me=P.ResvMax==0?0:P.ResvSize/P.ResvMax*.5:h.VBR==s1.vbr_rh||h.VBR==s1.vbr_mtrh||h.VBR==s1.vbr_mt?me=.6:me=1,v0=0;v0<P.channels_out;v0++){var pe=m[v0],De=T+576-350-B+192;for(c0=0;c0<576;c0++){var Ue,Ke;for(Ue=pe[De+c0+10],Ke=0,H0=0;H0<(B-1)/2-1;H0+=2)Ue+=b0[H0]*(pe[De+c0+H0]+pe[De+c0+B-H0]),Ke+=b0[H0+1]*(pe[De+c0+H0+1]+pe[De+c0+B-H0-1]);Q0[v0][c0]=Ue+Ke}H[g][v0].en.assign(P.en[v0]),H[g][v0].thm.assign(P.thm[v0]),U0>2&&(A[g][v0].en.assign(P.en[v0+2]),A[g][v0].thm.assign(P.thm[v0+2]))}for(v0=0;v0<U0;v0++){var _1,u1,He=ce(12),y1=[0,0,0,0],rt=ce(12),Kt=1,Ba,Ea=ce(f.CBANDS),Ta=ce(f.CBANDS),be=[0,0,0,0],ka=ce(f.HBLKSIZE),Ca=Oe([3,f.HBLKSIZE_s]);for(z0(P.npart_s<=f.CBANDS),z0(P.npart_l<=f.CBANDS),c0=0;c0<3;c0++)He[c0]=P.nsPsy.last_en_subshort[v0][c0+6],z0(P.nsPsy.last_en_subshort[v0][c0+4]>0),rt[c0]=He[c0]/P.nsPsy.last_en_subshort[v0][c0+4],y1[0]+=He[c0];if(v0==2)for(c0=0;c0<576;c0++){var Qt,Wt;Qt=Q0[0][c0],Wt=Q0[1][c0],Q0[0][c0]=Qt+Wt,Q0[1][c0]=Qt-Wt}{var ga=Q0[v0&1],mt=0;for(c0=0;c0<9;c0++){for(var Jr=mt+64,Le=1;mt<Jr;mt++)Le<Math.abs(ga[mt])&&(Le=Math.abs(ga[mt]));P.nsPsy.last_en_subshort[v0][c0]=He[c0+3]=Le,y1[1+c0/3]+=Le,Le>He[c0+3-2]?(z0(He[c0+3-2]>0),Le=Le/He[c0+3-2]):He[c0+3-2]>Le*10?Le=He[c0+3-2]/(Le*10):Le=0,rt[c0+3]=Le}}if(h.analysis){var Jt=rt[0];for(c0=1;c0<12;c0++)Jt<rt[c0]&&(Jt=rt[c0]);P.pinfo.ers[g][v0]=P.pinfo.ers_save[v0],P.pinfo.ers_save[v0]=Jt}for(Ba=v0==3?P.nsPsy.attackthre_s:P.nsPsy.attackthre,c0=0;c0<12;c0++)be[c0/3]==0&&rt[c0]>Ba&&(be[c0/3]=c0%3+1);for(c0=1;c0<4;c0++){var ea;y1[c0-1]>y1[c0]?(z0(y1[c0]>0),ea=y1[c0-1]/y1[c0]):(z0(y1[c0-1]>0),ea=y1[c0]/y1[c0-1]),ea<1.7&&(be[c0]=0,c0==1&&(be[0]=0))}for(be[0]!=0&&P.nsPsy.lastAttacks[v0]!=0&&(be[0]=0),(P.nsPsy.lastAttacks[v0]==3||be[0]+be[1]+be[2]+be[3]!=0)&&(Kt=0,be[1]!=0&&be[0]!=0&&(be[1]=0),be[2]!=0&&be[1]!=0&&(be[2]=0),be[3]!=0&&be[2]!=0&&(be[3]=0)),v0<2?T0[v0]=Kt:Kt==0&&(T0[0]=T0[1]=0),V[v0]=P.tot_ener[v0],u1=A0,_1=a0,E(h,ka,Ca,_1,v0&1,u1,v0&1,g,v0,m,T),F0(P,ka,V0,Ea,Ta),k0(P,Ea,Ta,ze),Z0=0;Z0<3;Z0++){var ta,Pe;for(o(h,Ca,u0,N0,v0,Z0),O(P,u0,N0,v0,Z0),B0=0;B0<f.SBMAX_s;B0++){if(Pe=P.thm[v0].s[B0][Z0],Pe*=C,be[Z0]>=2||be[Z0+1]==1){var pt=Z0!=0?Z0-1:2,Le=e0(P.thm[v0].s[B0][pt],Pe,s0*me);Pe=Math.min(Pe,Le)}if(be[Z0]==1){var pt=Z0!=0?Z0-1:2,Le=e0(P.thm[v0].s[B0][pt],Pe,b*me);Pe=Math.min(Pe,Le)}else if(Z0!=0&&be[Z0-1]==3||Z0==0&&P.nsPsy.lastAttacks[v0]==3){var pt=Z0!=2?Z0+1:0,Le=e0(P.thm[v0].s[B0][pt],Pe,b*me);Pe=Math.min(Pe,Le)}ta=He[Z0*3+3]+He[Z0*3+4]+He[Z0*3+5],He[Z0*3+5]*6<ta&&(Pe*=.5,He[Z0*3+4]*6<ta&&(Pe*=.5)),P.thm[v0].s[B0][Z0]=Pe}}for(P.nsPsy.lastAttacks[v0]=be[2],ve=0,C0=0;C0<P.npart_l;C0++){for(var G1=P.s3ind[C0][0],aa=V0[G1]*c[ze[G1]],z1=P.s3_ll[ve++]*aa;++G1<=P.s3ind[C0][1];)aa=V0[G1]*c[ze[G1]],z1=r(z1,P.s3_ll[ve++]*aa,G1,G1-C0,P,0);z1*=.158489319246111,P.blocktype_old[v0&1]==f.SHORT_TYPE?N0[C0]=z1:N0[C0]=e0(Math.min(z1,Math.min(K*P.nb_1[v0][C0],q*P.nb_2[v0][C0])),z1,me),P.nb_2[v0][C0]=P.nb_1[v0][C0],P.nb_1[v0][C0]=z1}for(;C0<=f.CBANDS;++C0)V0[C0]=0,N0[C0]=0;a(P,V0,N0,v0)}if((h.mode==Te.STEREO||h.mode==Te.JOINT_STEREO)&&h.interChRatio>0&&S(h,h.interChRatio),h.mode==Te.JOINT_STEREO){var ra;Y(P),ra=h.msfix,Math.abs(ra)>0&&k(P,ra,h.ATHlower*P.ATH.adjust)}for(j(h,T0,t0,Q),v0=0;v0<U0;v0++){var bt,xt=0,Vt,Ht;v0>1?(bt=D,xt=-2,Vt=f.NORM_TYPE,(t0[0]==f.SHORT_TYPE||t0[1]==f.SHORT_TYPE)&&(Vt=f.SHORT_TYPE),Ht=A[g][v0-2]):(bt=$,xt=0,Vt=t0[v0],Ht=H[g][v0]),Vt==f.SHORT_TYPE?bt[xt+v0]=y0(Ht,P.masking_lower):bt[xt+v0]=w0(Ht,P.masking_lower),h.analysis&&(P.pinfo.pe[g][v0]=bt[xt+v0])}return 0};function ne(h,m,T,g,H,A,$,D){var V=h.internal_flags;if(g<2)M.fft_long(V,$[D],g,m,T);else if(g==2)for(var t0=f.BLKSIZE-1;t0>=0;--t0){var P=$[D+0][t0],a0=$[D+1][t0];$[D+0][t0]=(P+a0)*O0.SQRT2*.5,$[D+1][t0]=(P-a0)*O0.SQRT2*.5}A[0]=$[D+0][0],A[0]*=A[0];for(var t0=f.BLKSIZE/2-1;t0>=0;--t0){var A0=$[D+0][f.BLKSIZE/2-t0],V0=$[D+0][f.BLKSIZE/2+t0];A[f.BLKSIZE/2-t0]=(A0*A0+V0*V0)*.5}{for(var u0=0,t0=11;t0<f.HBLKSIZE;t0++)u0+=A[t0];V.tot_ener[g]=u0}if(h.analysis){for(var t0=0;t0<f.HBLKSIZE;t0++)V.pinfo.energy[H][g][t0]=V.pinfo.energy_save[g][t0],V.pinfo.energy_save[g][t0]=A[t0];V.pinfo.pe[H][g]=V.pe[g]}}function ke(h,m,T,g,H,A,$,D){var V=h.internal_flags;if(H==0&&g<2&&M.fft_short(V,$[D],g,m,T),g==2)for(var t0=f.BLKSIZE_s-1;t0>=0;--t0){var P=$[D+0][H][t0],a0=$[D+1][H][t0];$[D+0][H][t0]=(P+a0)*O0.SQRT2*.5,$[D+1][H][t0]=(P-a0)*O0.SQRT2*.5}A[H][0]=$[D+0][H][0],A[H][0]*=A[H][0];for(var t0=f.BLKSIZE_s/2-1;t0>=0;--t0){var A0=$[D+0][H][f.BLKSIZE_s/2-t0],V0=$[D+0][H][f.BLKSIZE_s/2+t0];A[H][f.BLKSIZE_s/2-t0]=(A0*A0+V0*V0)*.5}}function te(h,m,T,g){var H=h.internal_flags;h.athaa_loudapprox==2&&T<2&&(H.loudness_sq[m][T]=H.loudness_sq_save[T],H.loudness_sq_save[T]=I(g,H))}var he=[-865163e-23*2,-.00851586*2,-674764e-23*2,.0209036*2,-336639e-22*2,-.0438162*2,-154175e-22*2,.0931738*2,-552212e-22*2,-.313819*2];function fe(h,m,T,g,H,A,$,D,V,t0){for(var P=Oe([2,576]),a0=h.internal_flags,A0=a0.channels_out,V0=h.mode==Te.JOINT_STEREO?4:A0,u0=0;u0<A0;u0++){firbuf=m[u0];for(var N0=T+576-350-B+192,Q=0;Q<576;Q++){var T0,U0;T0=firbuf[N0+Q+10],U0=0;for(var v0=0;v0<(B-1)/2-1;v0+=2)T0+=he[v0]*(firbuf[N0+Q+v0]+firbuf[N0+Q+B-v0]),U0+=he[v0+1]*(firbuf[N0+Q+v0+1]+firbuf[N0+Q+B-v0-1]);P[u0][Q]=T0+U0}H[g][u0].en.assign(a0.en[u0]),H[g][u0].thm.assign(a0.thm[u0]),V0>2&&(A[g][u0].en.assign(a0.en[u0+2]),A[g][u0].thm.assign(a0.thm[u0+2]))}for(var u0=0;u0<V0;u0++){var C0=ce(12),c0=ce(12),H0=[0,0,0,0],ve=P[u0&1],B0=0,Z0=u0==3?a0.nsPsy.attackthre_s:a0.nsPsy.attackthre,Q0=1;if(u0==2)for(var Q=0,v0=576;v0>0;++Q,--v0){var me=P[0][Q],ze=P[1][Q];P[0][Q]=me+ze,P[1][Q]=me-ze}for(var Q=0;Q<3;Q++)c0[Q]=a0.nsPsy.last_en_subshort[u0][Q+6],z0(a0.nsPsy.last_en_subshort[u0][Q+4]>0),C0[Q]=c0[Q]/a0.nsPsy.last_en_subshort[u0][Q+4],H0[0]+=c0[Q];for(var Q=0;Q<9;Q++){for(var Ae=B0+64,pe=1;B0<Ae;B0++)pe<Math.abs(ve[B0])&&(pe=Math.abs(ve[B0]));a0.nsPsy.last_en_subshort[u0][Q]=c0[Q+3]=pe,H0[1+Q/3]+=pe,pe>c0[Q+3-2]?(z0(c0[Q+3-2]>0),pe=pe/c0[Q+3-2]):c0[Q+3-2]>pe*10?pe=c0[Q+3-2]/(pe*10):pe=0,C0[Q+3]=pe}for(var Q=0;Q<3;++Q){var De=c0[Q*3+3]+c0[Q*3+4]+c0[Q*3+5],Ue=1;c0[Q*3+5]*6<De&&(Ue*=.5,c0[Q*3+4]*6<De&&(Ue*=.5)),D[u0][Q]=Ue}if(h.analysis){for(var Ke=C0[0],Q=1;Q<12;Q++)Ke<C0[Q]&&(Ke=C0[Q]);a0.pinfo.ers[g][u0]=a0.pinfo.ers_save[u0],a0.pinfo.ers_save[u0]=Ke}for(var Q=0;Q<12;Q++)V[u0][Q/3]==0&&C0[Q]>Z0&&(V[u0][Q/3]=Q%3+1);for(var Q=1;Q<4;Q++){var _1=H0[Q-1],u1=H0[Q],He=Math.max(_1,u1);He<4e4&&_1<1.7*u1&&u1<1.7*_1&&(Q==1&&V[u0][0]<=V[u0][Q]&&(V[u0][0]=0),V[u0][Q]=0)}V[u0][0]<=a0.nsPsy.lastAttacks[u0]&&(V[u0][0]=0),(a0.nsPsy.lastAttacks[u0]==3||V[u0][0]+V[u0][1]+V[u0][2]+V[u0][3]!=0)&&(Q0=0,V[u0][1]!=0&&V[u0][0]!=0&&(V[u0][1]=0),V[u0][2]!=0&&V[u0][1]!=0&&(V[u0][2]=0),V[u0][3]!=0&&V[u0][2]!=0&&(V[u0][3]=0)),u0<2?t0[u0]=Q0:Q0==0&&(t0[0]=t0[1]=0),$[u0]=a0.tot_ener[u0]}}function Me(h,m,T){if(T==0)for(var g=0;g<h.npart_s;g++)h.nb_s2[m][g]=h.nb_s1[m][g],h.nb_s1[m][g]=0}function Ie(h,m){for(var T=0;T<h.npart_l;T++)h.nb_2[m][T]=h.nb_1[m][T],h.nb_1[m][T]=0}function w1(h,m,T,g){var H=c.length-1,A=0,$=T[A]+T[A+1];if($>0){var D=m[A];D<m[A+1]&&(D=m[A+1]),z0(h.numlines_s[A]+h.numlines_s[A+1]-1>0),$=20*(D*2-$)/($*(h.numlines_s[A]+h.numlines_s[A+1]-1));var V=0|$;V>H&&(V=H),g[A]=V}else g[A]=0;for(A=1;A<h.npart_s-1;A++)if($=T[A-1]+T[A]+T[A+1],z0(A+1<h.npart_s),$>0){var D=m[A-1];D<m[A]&&(D=m[A]),D<m[A+1]&&(D=m[A+1]),z0(h.numlines_s[A-1]+h.numlines_s[A]+h.numlines_s[A+1]-1>0),$=20*(D*3-$)/($*(h.numlines_s[A-1]+h.numlines_s[A]+h.numlines_s[A+1]-1));var V=0|$;V>H&&(V=H),g[A]=V}else g[A]=0;if(z0(A==h.npart_s-1),$=T[A-1]+T[A],$>0){var D=m[A-1];D<m[A]&&(D=m[A]),z0(h.numlines_s[A-1]+h.numlines_s[A]-1>0),$=20*(D*2-$)/($*(h.numlines_s[A-1]+h.numlines_s[A]-1));var V=0|$;V>H&&(V=H),g[A]=V}else g[A]=0;z0(A==h.npart_s-1)}function e1(h,m,T,g,H,A){var $=h.internal_flags,D=new float[f.CBANDS],V=ce(f.CBANDS),t0,P,a0,A0=new int[f.CBANDS];for(a0=P=0;a0<$.npart_s;++a0){var V0=0,u0=0,N0=$.numlines_s[a0];for(t0=0;t0<N0;++t0,++P){var Q=m[A][P];V0+=Q,u0<Q&&(u0=Q)}T[a0]=V0,D[a0]=u0,V[a0]=V0/N0,z0(V[a0]>=0)}for(z0(a0==$.npart_s);a0<f.CBANDS;++a0)D[a0]=0,V[a0]=0;for(w1($,D,V,A0),P=a0=0;a0<$.npart_s;a0++){var T0=$.s3ind_s[a0][0],U0=$.s3ind_s[a0][1],v0,C0,c0,H0,ve;for(v0=A0[T0],C0=1,H0=$.s3_ss[P]*T[T0]*c[A0[T0]],++P,++T0;T0<=U0;)v0+=A0[T0],C0+=1,c0=$.s3_ss[P]*T[T0]*c[A0[T0]],H0=l(H0,c0,T0-a0),++P,++T0;v0=(1+2*v0)/(2*C0),ve=c[v0]*.5,H0*=ve,g[a0]=H0,$.nb_s2[H][a0]=$.nb_s1[H][a0],$.nb_s1[H][a0]=H0,c0=D[a0],c0*=$.minval_s[a0],c0*=ve,g[a0]>c0&&(g[a0]=c0),$.masking_lower>1&&(g[a0]*=$.masking_lower),g[a0]>T[a0]&&(g[a0]=T[a0]),$.masking_lower<1&&(g[a0]*=$.masking_lower),z0(g[a0]>=0)}for(;a0<f.CBANDS;++a0)T[a0]=0,g[a0]=0}function Ze(h,m,T,g,H){var A=ce(f.CBANDS),$=ce(f.CBANDS),D=f1(f.CBANDS+2),V;F0(h,m,T,A,$),k0(h,A,$,D);var t0=0;for(V=0;V<h.npart_l;V++){var P,a0,A0,V0,u0=h.s3ind[V][0],N0=h.s3ind[V][1],Q=0,T0=0;for(Q=D[u0],T0+=1,a0=h.s3_ll[t0]*T[u0]*c[D[u0]],++t0,++u0;u0<=N0;)Q+=D[u0],T0+=1,P=h.s3_ll[t0]*T[u0]*c[D[u0]],V0=l(a0,P,u0-V),a0=V0,++t0,++u0;if(Q=(1+2*Q)/(2*T0),A0=c[Q]*.5,a0*=A0,h.blocktype_old[H&1]==f.SHORT_TYPE){var U0=K*h.nb_1[H][V];U0>0?g[V]=Math.min(a0,U0):g[V]=Math.min(a0,T[V]*b)}else{var v0=q*h.nb_2[H][V],C0=K*h.nb_1[H][V],U0;v0<=0&&(v0=a0),C0<=0&&(C0=a0),h.blocktype_old[H&1]==f.NORM_TYPE?U0=Math.min(C0,v0):U0=C0,g[V]=Math.min(a0,U0)}h.nb_2[H][V]=h.nb_1[H][V],h.nb_1[H][V]=a0,P=A[V],P*=h.minval_l[V],P*=A0,g[V]>P&&(g[V]=P),h.masking_lower>1&&(g[V]*=h.masking_lower),g[V]>T[V]&&(g[V]=T[V]),h.masking_lower<1&&(g[V]*=h.masking_lower),z0(g[V]>=0)}for(;V<f.CBANDS;++V)T[V]=0,g[V]=0}function o1(h,m){var T=h.internal_flags;h.short_blocks==n0.short_block_coupled&&!(m[0]!=0&&m[1]!=0)&&(m[0]=m[1]=0);for(var g=0;g<T.channels_out;g++)h.short_blocks==n0.short_block_dispensed&&(m[g]=1),h.short_blocks==n0.short_block_forced&&(m[g]=0)}function Y1(h,m,T){for(var g=h.internal_flags,H=0;H<g.channels_out;H++){var A=f.NORM_TYPE;m[H]!=0?(z0(g.blocktype_old[H]!=f.START_TYPE),g.blocktype_old[H]==f.SHORT_TYPE&&(A=f.STOP_TYPE)):(A=f.SHORT_TYPE,g.blocktype_old[H]==f.NORM_TYPE&&(g.blocktype_old[H]=f.START_TYPE),g.blocktype_old[H]==f.STOP_TYPE&&(g.blocktype_old[H]=f.SHORT_TYPE)),T[H]=g.blocktype_old[H],g.blocktype_old[H]=A}}function V1(h,m,T,g,H,A,$){for(var D=A*2,V=A>0?Math.pow(10,H):1,t0,P,a0=0;a0<$;++a0){var A0=h[2][a0],V0=h[3][a0],u0=m[0][a0],N0=m[1][a0],Q=m[2][a0],T0=m[3][a0];if(u0<=1.58*N0&&N0<=1.58*u0){var U0=T[a0]*V0,v0=T[a0]*A0;P=Math.max(Q,Math.min(T0,U0)),t0=Math.max(T0,Math.min(Q,v0))}else P=Q,t0=T0;if(A>0){var C0,c0,H0=g[a0]*V;if(C0=Math.min(Math.max(u0,H0),Math.max(N0,H0)),Q=Math.max(P,H0),T0=Math.max(t0,H0),c0=Q+T0,c0>0&&C0*D<c0){var ve=C0*D/c0;Q*=ve,T0*=ve}P=Math.min(Q,P),t0=Math.min(T0,t0)}P>A0&&(P=A0),t0>V0&&(t0=V0),m[2][a0]=P,m[3][a0]=t0}}this.L3psycho_anal_vbr=function(h,m,T,g,H,A,$,D,V,t0){var P=h.internal_flags,a0,A0,V0=ce(f.HBLKSIZE),u0=Oe([3,f.HBLKSIZE_s]),N0=Oe([2,f.BLKSIZE]),Q=Oe([2,3,f.BLKSIZE_s]),T0=Oe([4,f.CBANDS]),U0=Oe([4,f.CBANDS]),v0=Oe([4,3]),C0=.6,c0=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],H0=f1(2),ve=h.mode==Te.JOINT_STEREO?4:P.channels_out;fe(h,m,T,g,H,A,V,v0,c0,H0),o1(h,H0);{for(var B0=0;B0<ve;B0++){var Z0=B0&1;a0=N0,ne(h,m,T,B0,g,V0,a0,Z0),te(h,g,B0,V0),H0[Z0]!=0?Ze(P,V0,T0[B0],U0[B0],B0):Ie(P,B0)}H0[0]+H0[1]==2&&h.mode==Te.JOINT_STEREO&&V1(T0,U0,P.mld_cb_l,P.ATH.cb_l,h.ATHlower*P.ATH.adjust,h.msfix,P.npart_l);for(var B0=0;B0<ve;B0++){var Z0=B0&1;H0[Z0]!=0&&a(P,T0[B0],U0[B0],B0)}}{for(var Q0=0;Q0<3;Q0++){for(var B0=0;B0<ve;++B0){var Z0=B0&1;H0[Z0]!=0?Me(P,B0,Q0):(A0=Q,ke(h,m,T,B0,Q0,u0,A0,Z0),e1(h,u0,T0[B0],U0[B0],B0,Q0))}H0[0]+H0[1]==0&&h.mode==Te.JOINT_STEREO&&V1(T0,U0,P.mld_cb_s,P.ATH.cb_s,h.ATHlower*P.ATH.adjust,h.msfix,P.npart_s);for(var B0=0;B0<ve;++B0){var Z0=B0&1;H0[Z0]==0&&O(P,T0[B0],U0[B0],B0,Q0)}}for(var B0=0;B0<ve;B0++){var Z0=B0&1;if(H0[Z0]==0)for(var me=0;me<f.SBMAX_s;me++){for(var ze=ce(3),Q0=0;Q0<3;Q0++){var Ae=P.thm[B0].s[me][Q0];if(Ae*=C,c0[B0][Q0]>=2||c0[B0][Q0+1]==1){var pe=Q0!=0?Q0-1:2,De=e0(P.thm[B0].s[me][pe],Ae,s0*C0);Ae=Math.min(Ae,De)}else if(c0[B0][Q0]==1){var pe=Q0!=0?Q0-1:2,De=e0(P.thm[B0].s[me][pe],Ae,b*C0);Ae=Math.min(Ae,De)}else if(Q0!=0&&c0[B0][Q0-1]==3||Q0==0&&P.nsPsy.lastAttacks[B0]==3){var pe=Q0!=2?Q0+1:0,De=e0(P.thm[B0].s[me][pe],Ae,b*C0);Ae=Math.min(Ae,De)}Ae*=v0[B0][Q0],ze[Q0]=Ae}for(var Q0=0;Q0<3;Q0++)P.thm[B0].s[me][Q0]=ze[Q0]}}}for(var B0=0;B0<ve;B0++)P.nsPsy.lastAttacks[B0]=c0[B0][2];Y1(h,H0,t0);for(var B0=0;B0<ve;B0++){var Ue,Ke,_1,u1;B0>1?(Ue=D,Ke=-2,_1=f.NORM_TYPE,(t0[0]==f.SHORT_TYPE||t0[1]==f.SHORT_TYPE)&&(_1=f.SHORT_TYPE),u1=A[g][B0-2]):(Ue=$,Ke=0,_1=t0[B0],u1=H[g][B0]),_1==f.SHORT_TYPE?Ue[Ke+B0]=y0(u1,P.masking_lower):Ue[Ke+B0]=w0(u1,P.masking_lower),h.analysis&&(P.pinfo.pe[g][B0]=Ue[Ke+B0])}return 0};function je(h,m){var T=h,g;return T>=0?g=-T*27:g=T*m,g<=-72?0:Math.exp(g*e)}function j1(h){var m=0,T=0;{var g=0,H,A;for(g=0;je(g,h)>1e-20;g-=1);for(H=g,A=0;Math.abs(A-H)>1e-12;)g=(A+H)/2,je(g,h)>0?A=g:H=g;m=H}{var g=0,H,A;for(g=0;je(g,h)>1e-20;g+=1);for(H=0,A=g;Math.abs(A-H)>1e-12;)g=(A+H)/2,je(g,h)>0?H=g:A=g;T=A}{var $=0,D=1e3,V;for(V=0;V<=D;++V){var g=m+V*(T-m)/D,t0=je(g,h);$+=t0}{var P=(D+1)/($*(T-m));return P}}}function T1(h){var m,T,g,H;return m=h,m>=0?m*=3:m*=1.5,m>=.5&&m<=2.5?(H=m-.5,T=8*(H*H-2*H)):T=0,m+=.474,g=15.811389+7.5*m-17.5*Math.sqrt(1+m*m),g<=-60?0:(m=Math.exp((T+g)*e),m/=.6609193,m)}function Ge(h){return h<0&&(h=0),h=h*.001,13*Math.atan(.76*h)+3.5*Math.atan(h*h/(7.5*7.5))}function tt(h,m,T,g,H,A,$,D,V,t0,P,a0){var A0=ce(f.CBANDS+1),V0=D/(a0>15?2*576:2*192),u0=f1(f.HBLKSIZE),N0;D/=V;var Q=0,T0=0;for(N0=0;N0<f.CBANDS;N0++){var U0,v0;for(U0=Ge(D*Q),A0[N0]=D*Q,v0=Q;Ge(D*v0)-U0<J&&v0<=V/2;v0++);for(h[N0]=v0-Q,T0=N0+1;Q<v0;)u0[Q++]=N0;if(Q>V/2){Q=V/2,++N0;break}}A0[N0]=D*Q;for(var C0=0;C0<a0;C0++){var c0,H0,ve,B0,Z0;ve=t0[C0],B0=t0[C0+1],c0=0|Math.floor(.5+P*(ve-.5)),c0<0&&(c0=0),H0=0|Math.floor(.5+P*(B0-.5)),H0>V/2&&(H0=V/2),T[C0]=(u0[c0]+u0[H0])/2,m[C0]=u0[H0];var Q0=V0*B0;$[C0]=(Q0-A0[m[C0]])/(A0[m[C0]+1]-A0[m[C0]]),$[C0]<0?$[C0]=0:$[C0]>1&&($[C0]=1),Z0=Ge(D*t0[C0]*P),Z0=Math.min(Z0,15.5)/15.5,A[C0]=Math.pow(10,1.25*(1-Math.cos(Math.PI*Z0))-2.5)}Q=0;for(var me=0;me<T0;me++){var ze=h[me],U0,Ae;U0=Ge(D*Q),Ae=Ge(D*(Q+ze-1)),g[me]=.5*(U0+Ae),U0=Ge(D*(Q-.5)),Ae=Ge(D*(Q+ze-.5)),H[me]=Ae-U0,Q+=ze}return T0}function Aa(h,m,T,g,H,A){var $=Oe([f.CBANDS,f.CBANDS]),D,V=0;if(A)for(var t0=0;t0<m;t0++)for(D=0;D<m;D++){var P=T1(T[t0]-T[D])*g[D];$[t0][D]=P*H[t0]}else for(D=0;D<m;D++)for(var a0=15+Math.min(21/T[D],12),A0=j1(a0),t0=0;t0<m;t0++){var P=A0*je(T[t0]-T[D],a0)*g[D];$[t0][D]=P*H[t0]}for(var t0=0;t0<m;t0++){for(D=0;D<m&&!($[t0][D]>0);D++);for(h[t0][0]=D,D=m-1;D>0&&!($[t0][D]>0);D--);h[t0][1]=D,V+=h[t0][1]-h[t0][0]+1}for(var V0=ce(V),u0=0,t0=0;t0<m;t0++)for(D=h[t0][0];D<=h[t0][1];D++)V0[u0++]=$[t0][D];return V0}function Ra(h){var m=Ge(h);return m=Math.min(m,15.5)/15.5,Math.pow(10,1.25*(1-Math.cos(Math.PI*m))-2.5)}this.psymodel_init=function(h){var m=h.internal_flags,T,g=!0,H=13,A=24,$=0,D=0,V=-8.25,t0=-4.5,P=ce(f.CBANDS),a0=ce(f.CBANDS),A0=ce(f.CBANDS),V0=h.out_samplerate;switch(h.experimentalZ){default:case 0:g=!0;break;case 1:g=!(h.VBR==s1.vbr_mtrh||h.VBR==s1.vbr_mt);break;case 2:g=!1;break;case 3:H=8,$=-1.75,D=-.0125,V=-8.25,t0=-2.25;break}for(m.ms_ener_ratio_old=.25,m.blocktype_old[0]=m.blocktype_old[1]=f.NORM_TYPE,T=0;T<4;++T){for(var Q=0;Q<f.CBANDS;++Q)m.nb_1[T][Q]=1e20,m.nb_2[T][Q]=1e20,m.nb_s1[T][Q]=m.nb_s2[T][Q]=1;for(var u0=0;u0<f.SBMAX_l;u0++)m.en[T].l[u0]=1e20,m.thm[T].l[u0]=1e20;for(var Q=0;Q<3;++Q){for(var u0=0;u0<f.SBMAX_s;u0++)m.en[T].s[u0][Q]=1e20,m.thm[T].s[u0][Q]=1e20;m.nsPsy.lastAttacks[T]=0}for(var Q=0;Q<9;Q++)m.nsPsy.last_en_subshort[T][Q]=10}for(m.loudness_sq_save[0]=m.loudness_sq_save[1]=0,m.npart_l=tt(m.numlines_l,m.bo_l,m.bm_l,P,a0,m.mld_l,m.PSY.bo_l_weight,V0,f.BLKSIZE,m.scalefac_band.l,f.BLKSIZE/(2*576),f.SBMAX_l),z0(m.npart_l<f.CBANDS),T=0;T<m.npart_l;T++){var N0=$;P[T]>=H&&(N0=D*(P[T]-H)/(A-H)+$*(A-P[T])/(A-H)),A0[T]=Math.pow(10,N0/10),m.numlines_l[T]>0?m.rnumlines_l[T]=1/m.numlines_l[T]:m.rnumlines_l[T]=0}m.s3_ll=Aa(m.s3ind,m.npart_l,P,a0,A0,g);var Q=0;for(T=0;T<m.npart_l;T++){var T0;T0=$0.MAX_VALUE;for(var U0=0;U0<m.numlines_l[T];U0++,Q++){var v0=V0*Q/(1e3*f.BLKSIZE),C0;C0=this.ATHformula(v0*1e3,h)-20,C0=Math.pow(10,.1*C0),C0*=m.numlines_l[T],T0>C0&&(T0=C0)}m.ATH.cb_l[T]=T0,T0=-20+P[T]*20/10,T0>6&&(T0=100),T0<-15&&(T0=-15),T0-=8,m.minval_l[T]=Math.pow(10,T0/10)*m.numlines_l[T]}for(m.npart_s=tt(m.numlines_s,m.bo_s,m.bm_s,P,a0,m.mld_s,m.PSY.bo_s_weight,V0,f.BLKSIZE_s,m.scalefac_band.s,f.BLKSIZE_s/(2*192),f.SBMAX_s),z0(m.npart_s<f.CBANDS),Q=0,T=0;T<m.npart_s;T++){var T0,N0=V;P[T]>=H&&(N0=t0*(P[T]-H)/(A-H)+V*(A-P[T])/(A-H)),A0[T]=Math.pow(10,N0/10),T0=$0.MAX_VALUE;for(var U0=0;U0<m.numlines_s[T];U0++,Q++){var v0=V0*Q/(1e3*f.BLKSIZE_s),C0;C0=this.ATHformula(v0*1e3,h)-20,C0=Math.pow(10,.1*C0),C0*=m.numlines_s[T],T0>C0&&(T0=C0)}m.ATH.cb_s[T]=T0,T0=-7+P[T]*7/12,P[T]>12&&(T0*=1+Math.log(1+T0)*3.1),P[T]<12&&(T0*=1+Math.log(1-T0)*2.3),T0<-15&&(T0=-15),T0-=8,m.minval_s[T]=Math.pow(10,T0/10)*m.numlines_s[T]}m.s3_ss=Aa(m.s3ind_s,m.npart_s,P,a0,A0,g),_(),M.init_fft(m),m.decay=Math.exp(-1*F/(m0*V0/192));{var c0;c0=w,h.exp_nspsytune&2&&(c0=1),Math.abs(h.msfix)>0&&(c0=h.msfix),h.msfix=c0;for(var H0=0;H0<m.npart_l;H0++)m.s3ind[H0][1]>m.npart_l-1&&(m.s3ind[H0][1]=m.npart_l-1)}var ve=576*m.mode_gr/V0;if(m.ATH.decay=Math.pow(10,-12/10*ve),m.ATH.adjust=.01,m.ATH.adjustLimit=1,z0(m.bo_l[f.SBMAX_l-1]<=m.npart_l),z0(m.bo_s[f.SBMAX_s-1]<=m.npart_s),h.ATHtype!=-1){var v0,B0=h.out_samplerate/f.BLKSIZE,Z0=0;for(v0=0,T=0;T<f.BLKSIZE/2;++T)v0+=B0,m.ATH.eql_w[T]=1/Math.pow(10,this.ATHformula(v0,h)/10),Z0+=m.ATH.eql_w[T];for(Z0=1/Z0,T=f.BLKSIZE/2;--T>=0;)m.ATH.eql_w[T]*=Z0}{for(var H0=Q=0;H0<m.npart_s;++H0)for(T=0;T<m.numlines_s[H0];++T)++Q;for(var H0=Q=0;H0<m.npart_l;++H0)for(T=0;T<m.numlines_l[H0];++T)++Q}for(Q=0,T=0;T<m.npart_l;T++){var v0=V0*(Q+m.numlines_l[T]/2)/(1*f.BLKSIZE);m.mld_cb_l[T]=Ra(v0),Q+=m.numlines_l[T]}for(;T<f.CBANDS;++T)m.mld_cb_l[T]=1;for(Q=0,T=0;T<m.npart_s;T++){var v0=V0*(Q+m.numlines_s[T]/2)/(1*f.BLKSIZE_s);m.mld_cb_s[T]=Ra(v0),Q+=m.numlines_s[T]}for(;T<f.CBANDS;++T)m.mld_cb_s[T]=1;return 0};function at(h,m){h<-.3&&(h=3410),h/=1e3,h=Math.max(.1,h);var T=3.64*Math.pow(h,-.8)-6.8*Math.exp(-.6*Math.pow(h-3.4,2))+6*Math.exp(-.15*Math.pow(h-8.7,2))+(.6+.04*m)*.001*Math.pow(h,4);return T}this.ATHformula=function(h,m){var T;switch(m.ATHtype){case 0:T=at(h,9);break;case 1:T=at(h,-1);break;case 2:T=at(h,0);break;case 3:T=at(h,1)+6;break;case 4:T=at(h,m.ATHcurve);break;default:T=at(h,0);break}return T}}var W1=At;function qe(M){var F=M;this.ordinal=function(){return F}}qe.STEREO=new qe(0),qe.JOINT_STEREO=new qe(1),qe.DUAL_CHANNEL=new qe(2),qe.MONO=new qe(3),qe.NOT_SET=new qe(4);var lt=qe;function Rt(){this.class_id=0,this.num_samples=0,this.num_channels=0,this.in_samplerate=0,this.out_samplerate=0,this.scale=0,this.scale_left=0,this.scale_right=0,this.analysis=!1,this.bWriteVbrTag=!1,this.decode_only=!1,this.quality=0,this.mode=lt.STEREO,this.force_ms=!1,this.free_format=!1,this.findReplayGain=!1,this.decode_on_the_fly=!1,this.write_id3tag_automatic=!1,this.brate=0,this.compression_ratio=0,this.copyright=0,this.original=0,this.extension=0,this.emphasis=0,this.error_protection=0,this.strict_ISO=!1,this.disable_reservoir=!1,this.quant_comp=0,this.quant_comp_short=0,this.experimentalY=!1,this.experimentalZ=0,this.exp_nspsytune=0,this.preset=0,this.VBR=null,this.VBR_q_frac=0,this.VBR_q=0,this.VBR_mean_bitrate_kbps=0,this.VBR_min_bitrate_kbps=0,this.VBR_max_bitrate_kbps=0,this.VBR_hard_min=0,this.lowpassfreq=0,this.highpassfreq=0,this.lowpasswidth=0,this.highpasswidth=0,this.maskingadjust=0,this.maskingadjust_short=0,this.ATHonly=!1,this.ATHshort=!1,this.noATH=!1,this.ATHtype=0,this.ATHcurve=0,this.ATHlower=0,this.athaa_type=0,this.athaa_loudapprox=0,this.athaa_sensitivity=0,this.short_blocks=null,this.useTemporal=!1,this.interChRatio=0,this.msfix=0,this.tune=!1,this.tune_value_a=0,this.version=0,this.encoder_delay=0,this.encoder_padding=0,this.framesize=0,this.frameNum=0,this.lame_allocated_gfp=0,this.internal_flags=null}var Bt=Rt,ot={};ot.SFBMAX=f.SBMAX_s*3;var m1=ot,Et=z.new_float,p1=z.new_int;function Tt(){this.xr=Et(576),this.l3_enc=p1(576),this.scalefac=p1(m1.SFBMAX),this.xrpow_max=0,this.part2_3_length=0,this.big_values=0,this.count1=0,this.global_gain=0,this.scalefac_compress=0,this.block_type=0,this.mixed_block_flag=0,this.table_select=p1(3),this.subblock_gain=p1(3+1),this.region0_count=0,this.region1_count=0,this.preflag=0,this.scalefac_scale=0,this.count1table_select=0,this.part2_length=0,this.sfb_lmax=0,this.sfb_smin=0,this.psy_lmax=0,this.sfbmax=0,this.psymax=0,this.sfbdivide=0,this.width=p1(m1.SFBMAX),this.window=p1(m1.SFBMAX),this.count1bits=0,this.sfb_partition_table=null,this.slen=p1(4),this.max_nonzero_coeff=0;var M=this;function F(q){return new Int32Array(q)}function K(q){return new Float32Array(q)}this.assign=function(q){M.xr=K(q.xr),M.l3_enc=F(q.l3_enc),M.scalefac=F(q.scalefac),M.xrpow_max=q.xrpow_max,M.part2_3_length=q.part2_3_length,M.big_values=q.big_values,M.count1=q.count1,M.global_gain=q.global_gain,M.scalefac_compress=q.scalefac_compress,M.block_type=q.block_type,M.mixed_block_flag=q.mixed_block_flag,M.table_select=F(q.table_select),M.subblock_gain=F(q.subblock_gain),M.region0_count=q.region0_count,M.region1_count=q.region1_count,M.preflag=q.preflag,M.scalefac_scale=q.scalefac_scale,M.count1table_select=q.count1table_select,M.part2_length=q.part2_length,M.sfb_lmax=q.sfb_lmax,M.sfb_smin=q.sfb_smin,M.psy_lmax=q.psy_lmax,M.sfbmax=q.sfbmax,M.psymax=q.psymax,M.sfbdivide=q.sfbdivide,M.width=F(q.width),M.window=F(q.window),M.count1bits=q.count1bits,M.sfb_partition_table=q.sfb_partition_table.slice(0),M.slen=F(q.slen),M.max_nonzero_coeff=q.max_nonzero_coeff}}var $1=Tt,_t=z.new_int;function kt(){this.tt=[[null,null],[null,null]],this.main_data_begin=0,this.private_bits=0,this.resvDrain_pre=0,this.resvDrain_post=0,this.scfsi=[_t(4),_t(4)];for(var M=0;M<2;M++)for(var F=0;F<2;F++)this.tt[M][F]=new $1}var Ct=kt,F1=z.System,le=z.new_int;function n1(M,F,K,q){this.l=le(1+f.SBMAX_l),this.s=le(1+f.SBMAX_s),this.psfb21=le(1+f.PSFB21),this.psfb12=le(1+f.PSFB12);var o0=this.l,X=this.s;arguments.length==4&&(this.arrL=arguments[0],this.arrS=arguments[1],this.arr21=arguments[2],this.arr12=arguments[3],F1.arraycopy(this.arrL,0,o0,0,Math.min(this.arrL.length,this.l.length)),F1.arraycopy(this.arrS,0,X,0,Math.min(this.arrS.length,this.s.length)),F1.arraycopy(this.arr21,0,this.psfb21,0,Math.min(this.arr21.length,this.psfb21.length)),F1.arraycopy(this.arr12,0,this.psfb12,0,Math.min(this.arr12.length,this.psfb12.length)))}var i1=n1,Xt=z.new_float,Ua=z.new_float_n,Ka=z.new_int;function Qa(){this.last_en_subshort=Ua([4,9]),this.lastAttacks=Ka(4),this.pefirbuf=Xt(19),this.longfact=Xt(f.SBMAX_l),this.shortfact=Xt(f.SBMAX_s),this.attackthre=0,this.attackthre_s=0}var Wa=Qa;function Ja(){this.sum=0,this.seen=0,this.want=0,this.pos=0,this.size=0,this.bag=null,this.nVbrNumFrames=0,this.nBytesWritten=0,this.TotalFrameSize=0}var er=Ja,tr=z.new_byte,ar=z.new_double,Je=z.new_float,q1=z.new_float_n,l1=z.new_int,gt=z.new_int_n;R1.MFSIZE=3*1152+f.ENCDELAY-f.MDCTDELAY,R1.MAX_HEADER_BUF=256,R1.MAX_BITS_PER_CHANNEL=4095,R1.MAX_BITS_PER_GRANULE=7680,R1.BPC=320;function R1(){var M=40;this.Class_ID=0,this.lame_encode_frame_init=0,this.iteration_init_init=0,this.fill_buffer_resample_init=0,this.mfbuf=q1([2,R1.MFSIZE]),this.mode_gr=0,this.channels_in=0,this.channels_out=0,this.resample_ratio=0,this.mf_samples_to_encode=0,this.mf_size=0,this.VBR_min_bitrate=0,this.VBR_max_bitrate=0,this.bitrate_index=0,this.samplerate_index=0,this.mode_ext=0,this.lowpass1=0,this.lowpass2=0,this.highpass1=0,this.highpass2=0,this.noise_shaping=0,this.noise_shaping_amp=0,this.substep_shaping=0,this.psymodel=0,this.noise_shaping_stop=0,this.subblock_gain=0,this.use_best_huffman=0,this.full_outer_loop=0,this.l3_side=new Ct,this.ms_ratio=Je(2),this.padding=0,this.frac_SpF=0,this.slot_lag=0,this.tag_spec=null,this.nMusicCRC=0,this.OldValue=l1(2),this.CurrentStep=l1(2),this.masking_lower=0,this.bv_scf=l1(576),this.pseudohalf=l1(m1.SFBMAX),this.sfb21_extra=!1,this.inbuf_old=new Array(2),this.blackfilt=new Array(2*R1.BPC+1),this.itime=ar(2),this.sideinfo_len=0,this.sb_sample=q1([2,2,18,f.SBLIMIT]),this.amp_filter=Je(32);function F(){this.write_timing=0,this.ptr=0,this.buf=tr(M)}this.header=new Array(R1.MAX_HEADER_BUF),this.h_ptr=0,this.w_ptr=0,this.ancillary_flag=0,this.ResvSize=0,this.ResvMax=0,this.scalefac_band=new i1,this.minval_l=Je(f.CBANDS),this.minval_s=Je(f.CBANDS),this.nb_1=q1([4,f.CBANDS]),this.nb_2=q1([4,f.CBANDS]),this.nb_s1=q1([4,f.CBANDS]),this.nb_s2=q1([4,f.CBANDS]),this.s3_ss=null,this.s3_ll=null,this.decay=0,this.thm=new Array(4),this.en=new Array(4),this.tot_ener=Je(4),this.loudness_sq=q1([2,2]),this.loudness_sq_save=Je(2),this.mld_l=Je(f.SBMAX_l),this.mld_s=Je(f.SBMAX_s),this.bm_l=l1(f.SBMAX_l),this.bo_l=l1(f.SBMAX_l),this.bm_s=l1(f.SBMAX_s),this.bo_s=l1(f.SBMAX_s),this.npart_l=0,this.npart_s=0,this.s3ind=gt([f.CBANDS,2]),this.s3ind_s=gt([f.CBANDS,2]),this.numlines_s=l1(f.CBANDS),this.numlines_l=l1(f.CBANDS),this.rnumlines_l=Je(f.CBANDS),this.mld_cb_l=Je(f.CBANDS),this.mld_cb_s=Je(f.CBANDS),this.numlines_s_num1=0,this.numlines_l_num1=0,this.pe=Je(4),this.ms_ratio_s_old=0,this.ms_ratio_l_old=0,this.ms_ener_ratio_old=0,this.blocktype_old=l1(2),this.nsPsy=new Wa,this.VBR_seek_table=new er,this.ATH=null,this.PSY=null,this.nogap_total=0,this.nogap_current=0,this.decode_on_the_fly=!0,this.findReplayGain=!0,this.findPeakSample=!0,this.PeakSample=0,this.RadioGain=0,this.AudiophileGain=0,this.rgdata=null,this.noclipGainChange=0,this.noclipScale=0,this.bitrate_stereoMode_Hist=gt([16,4+1]),this.bitrate_blockType_Hist=gt([16,4+1+1]),this.pinfo=null,this.hip=null,this.in_buffer_nsamples=0,this.in_buffer_0=null,this.in_buffer_1=null,this.iteration_loop=null;for(var K=0;K<this.en.length;K++)this.en[K]=new Fe;for(var K=0;K<this.thm.length;K++)this.thm[K]=new Fe;for(var K=0;K<this.header.length;K++)this.header[K]=new F}var de=R1,X1=z.new_float;function rr(){this.useAdjust=0,this.aaSensitivityP=0,this.adjust=0,this.adjustLimit=0,this.decay=0,this.floor=0,this.l=X1(f.SBMAX_l),this.s=X1(f.SBMAX_s),this.psfb21=X1(f.PSFB21),this.psfb12=X1(f.PSFB12),this.cb_l=X1(f.CBANDS),this.cb_s=X1(f.CBANDS),this.eql_w=X1(f.BLKSIZE/2)}var sr=rr,Xe=z.System,va=z.Arrays;Se.STEPS_per_dB=100,Se.MAX_dB=120,Se.GAIN_NOT_ENOUGH_SAMPLES=-24601,Se.GAIN_ANALYSIS_ERROR=0,Se.GAIN_ANALYSIS_OK=1,Se.INIT_GAIN_ANALYSIS_ERROR=0,Se.INIT_GAIN_ANALYSIS_OK=1,Se.YULE_ORDER=10,Se.MAX_ORDER=Se.YULE_ORDER,Se.MAX_SAMP_FREQ=48e3,Se.RMS_WINDOW_TIME_NUMERATOR=1,Se.RMS_WINDOW_TIME_DENOMINATOR=20,Se.MAX_SAMPLES_PER_WINDOW=Se.MAX_SAMP_FREQ*Se.RMS_WINDOW_TIME_NUMERATOR/Se.RMS_WINDOW_TIME_DENOMINATOR+1;function Se(){var M=64.82,F=.95,K=Se.RMS_WINDOW_TIME_NUMERATOR,q=Se.RMS_WINDOW_TIME_DENOMINATOR,o0=[[.038575994352,-3.84664617118067,-.02160367184185,7.81501653005538,-.00123395316851,-11.34170355132042,-9291677959e-14,13.05504219327545,-.01655260341619,-12.28759895145294,.02161526843274,9.4829380631979,-.02074045215285,-5.87257861775999,.00594298065125,2.75465861874613,.00306428023191,-.86984376593551,.00012025322027,.13919314567432,.00288463683916],[.0541865640643,-3.47845948550071,-.02911007808948,6.36317777566148,-.00848709379851,-8.54751527471874,-.00851165645469,9.4769360780128,-.00834990904936,-8.81498681370155,.02245293253339,6.85401540936998,-.02596338512915,-4.39470996079559,.01624864962975,2.19611684890774,-.00240879051584,-.75104302451432,.00674613682247,.13149317958808,-.00187763777362],[.15457299681924,-2.37898834973084,-.09331049056315,2.84868151156327,-.06247880153653,-2.64577170229825,.02163541888798,2.23697657451713,-.05588393329856,-1.67148153367602,.04781476674921,1.00595954808547,.00222312597743,-.45953458054983,.03174092540049,.16378164858596,-.01390589421898,-.05032077717131,.00651420667831,.0234789740702,-.00881362733839],[.30296907319327,-1.61273165137247,-.22613988682123,1.0797749225997,-.08587323730772,-.2565625775407,.03282930172664,-.1627671912044,-.00915702933434,-.22638893773906,-.02364141202522,.39120800788284,-.00584456039913,-.22138138954925,.06276101321749,.04500235387352,-828086748e-14,.02005851806501,.00205861885564,.00302439095741,-.02950134983287],[.33642304856132,-1.49858979367799,-.2557224142557,.87350271418188,-.11828570177555,.12205022308084,.11921148675203,-.80774944671438,-.07834489609479,.47854794562326,-.0046997791438,-.12453458140019,-.0058950022444,-.04067510197014,.05724228140351,.08333755284107,.00832043980773,-.04237348025746,-.0163538138454,.02977207319925,-.0176017656815],[.4491525660845,-.62820619233671,-.14351757464547,.29661783706366,-.22784394429749,-.372563729424,-.01419140100551,.00213767857124,.04078262797139,-.42029820170918,-.12398163381748,.22199650564824,.04097565135648,.00613424350682,.10478503600251,.06747620744683,-.01863887810927,.05784820375801,-.03193428438915,.03222754072173,.00541907748707],[.56619470757641,-1.04800335126349,-.75464456939302,.29156311971249,.1624213774223,-.26806001042947,.16744243493672,.00819999645858,-.18901604199609,.45054734505008,.3093178284183,-.33032403314006,-.27562961986224,.0673936833311,.00647310677246,-.04784254229033,.08647503780351,.01639907836189,-.0378898455484,.01807364323573,-.00588215443421],[.58100494960553,-.51035327095184,-.53174909058578,-.31863563325245,-.14289799034253,-.20256413484477,.17520704835522,.1472815413433,.02377945217615,.38952639978999,.15558449135573,-.23313271880868,-.25344790059353,-.05246019024463,.01628462406333,-.02505961724053,.06920467763959,.02442357316099,-.03721611395801,.01818801111503,-.00749618797172],[.53648789255105,-.2504987195602,-.42163034350696,-.43193942311114,-.00275953611929,-.03424681017675,.04267842219415,-.04678328784242,-.10214864179676,.26408300200955,.14590772289388,.15113130533216,-.02459864859345,-.17556493366449,-.11202315195388,-.18823009262115,-.04060034127,.05477720428674,.0478866554818,.0470440968812,-.02217936801134]],X=[[.98621192462708,-1.97223372919527,-1.97242384925416,.97261396931306,.98621192462708],[.98500175787242,-1.96977855582618,-1.97000351574484,.9702284756635,.98500175787242],[.97938932735214,-1.95835380975398,-1.95877865470428,.95920349965459,.97938932735214],[.97531843204928,-1.95002759149878,-1.95063686409857,.95124613669835,.97531843204928],[.97316523498161,-1.94561023566527,-1.94633046996323,.94705070426118,.97316523498161],[.96454515552826,-1.92783286977036,-1.92909031105652,.93034775234268,.96454515552826],[.96009142950541,-1.91858953033784,-1.92018285901082,.92177618768381,.96009142950541],[.95856916599601,-1.9154210807478,-1.91713833199203,.91885558323625,.95856916599601],[.94597685600279,-1.88903307939452,-1.89195371200558,.89487434461664,.94597685600279]];function J(b,w,B,e,L,I){for(;L--!=0;)B[e]=1e-10+b[w+0]*I[0]-B[e-1]*I[1]+b[w-1]*I[2]-B[e-2]*I[3]+b[w-2]*I[4]-B[e-3]*I[5]+b[w-3]*I[6]-B[e-4]*I[7]+b[w-4]*I[8]-B[e-5]*I[9]+b[w-5]*I[10]-B[e-6]*I[11]+b[w-6]*I[12]-B[e-7]*I[13]+b[w-7]*I[14]-B[e-8]*I[15]+b[w-8]*I[16]-B[e-9]*I[17]+b[w-9]*I[18]-B[e-10]*I[19]+b[w-10]*I[20],++e,++w}function h0(b,w,B,e,L,I){for(;L--!=0;)B[e]=b[w+0]*I[0]-B[e-1]*I[1]+b[w-1]*I[2]-B[e-2]*I[3]+b[w-2]*I[4],++e,++w}function m0(b,w){for(var B=0;B<MAX_ORDER;B++)b.linprebuf[B]=b.lstepbuf[B]=b.loutbuf[B]=b.rinprebuf[B]=b.rstepbuf[B]=b.routbuf[B]=0;switch(0|w){case 48e3:b.reqindex=0;break;case 44100:b.reqindex=1;break;case 32e3:b.reqindex=2;break;case 24e3:b.reqindex=3;break;case 22050:b.reqindex=4;break;case 16e3:b.reqindex=5;break;case 12e3:b.reqindex=6;break;case 11025:b.reqindex=7;break;case 8e3:b.reqindex=8;break;default:return INIT_GAIN_ANALYSIS_ERROR}return b.sampleWindow=0|(w*K+q-1)/q,b.lsum=0,b.rsum=0,b.totsamp=0,va.ill(b.A,0),INIT_GAIN_ANALYSIS_OK}this.InitGainAnalysis=function(b,w){return m0(b,w)!=INIT_GAIN_ANALYSIS_OK?INIT_GAIN_ANALYSIS_ERROR:(b.linpre=MAX_ORDER,b.rinpre=MAX_ORDER,b.lstep=MAX_ORDER,b.rstep=MAX_ORDER,b.lout=MAX_ORDER,b.rout=MAX_ORDER,va.fill(b.B,0),INIT_GAIN_ANALYSIS_OK)};function C(b){return b*b}this.AnalyzeSamples=function(b,w,B,e,L,I,E){var s,d,x,y,R,t,c;if(I==0)return GAIN_ANALYSIS_OK;switch(c=0,R=I,E){case 1:e=w,L=B;break;case 2:break;default:return GAIN_ANALYSIS_ERROR}for(I<MAX_ORDER?(Xe.arraycopy(w,B,b.linprebuf,MAX_ORDER,I),Xe.arraycopy(e,L,b.rinprebuf,MAX_ORDER,I)):(Xe.arraycopy(w,B,b.linprebuf,MAX_ORDER,MAX_ORDER),Xe.arraycopy(e,L,b.rinprebuf,MAX_ORDER,MAX_ORDER));R>0;){t=R>b.sampleWindow-b.totsamp?b.sampleWindow-b.totsamp:R,c<MAX_ORDER?(s=b.linpre+c,d=b.linprebuf,x=b.rinpre+c,y=b.rinprebuf,t>MAX_ORDER-c&&(t=MAX_ORDER-c)):(s=B+c,d=w,x=L+c,y=e),J(d,s,b.lstepbuf,b.lstep+b.totsamp,t,o0[b.reqindex]),J(y,x,b.rstepbuf,b.rstep+b.totsamp,t,o0[b.reqindex]),h0(b.lstepbuf,b.lstep+b.totsamp,b.loutbuf,b.lout+b.totsamp,t,X[b.reqindex]),h0(b.rstepbuf,b.rstep+b.totsamp,b.routbuf,b.rout+b.totsamp,t,X[b.reqindex]),s=b.lout+b.totsamp,d=b.loutbuf,x=b.rout+b.totsamp,y=b.routbuf;for(var _=t%8;_--!=0;)b.lsum+=C(d[s++]),b.rsum+=C(y[x++]);for(_=t/8;_--!=0;)b.lsum+=C(d[s+0])+C(d[s+1])+C(d[s+2])+C(d[s+3])+C(d[s+4])+C(d[s+5])+C(d[s+6])+C(d[s+7]),s+=8,b.rsum+=C(y[x+0])+C(y[x+1])+C(y[x+2])+C(y[x+3])+C(y[x+4])+C(y[x+5])+C(y[x+6])+C(y[x+7]),x+=8;if(R-=t,c+=t,b.totsamp+=t,b.totsamp==b.sampleWindow){var n=Se.STEPS_per_dB*10*Math.log10((b.lsum+b.rsum)/b.totsamp*.5+1e-37),u=n<=0?0:0|n;u>=b.A.length&&(u=b.A.length-1),b.A[u]++,b.lsum=b.rsum=0,Xe.arraycopy(b.loutbuf,b.totsamp,b.loutbuf,0,MAX_ORDER),Xe.arraycopy(b.routbuf,b.totsamp,b.routbuf,0,MAX_ORDER),Xe.arraycopy(b.lstepbuf,b.totsamp,b.lstepbuf,0,MAX_ORDER),Xe.arraycopy(b.rstepbuf,b.totsamp,b.rstepbuf,0,MAX_ORDER),b.totsamp=0}if(b.totsamp>b.sampleWindow)return GAIN_ANALYSIS_ERROR}return I<MAX_ORDER?(Xe.arraycopy(b.linprebuf,I,b.linprebuf,0,MAX_ORDER-I),Xe.arraycopy(b.rinprebuf,I,b.rinprebuf,0,MAX_ORDER-I),Xe.arraycopy(w,B,b.linprebuf,MAX_ORDER-I,I),Xe.arraycopy(e,L,b.rinprebuf,MAX_ORDER-I,I)):(Xe.arraycopy(w,B+I-MAX_ORDER,b.linprebuf,0,MAX_ORDER),Xe.arraycopy(e,L+I-MAX_ORDER,b.rinprebuf,0,MAX_ORDER)),GAIN_ANALYSIS_OK};function s0(b,w){var B,e=0;for(B=0;B<w;B++)e+=b[B];if(e==0)return GAIN_NOT_ENOUGH_SAMPLES;var L=0|Math.ceil(e*(1-F));for(B=w;B-- >0&&!((L-=b[B])<=0););return M-B/Se.STEPS_per_dB}this.GetTitleGain=function(b){for(var w=s0(b.A,b.A.length),B=0;B<b.A.length;B++)b.B[B]+=b.A[B],b.A[B]=0;for(var B=0;B<MAX_ORDER;B++)b.linprebuf[B]=b.lstepbuf[B]=b.loutbuf[B]=b.rinprebuf[B]=b.rstepbuf[B]=b.routbuf[B]=0;return b.totsamp=0,b.lsum=b.rsum=0,w}}var $e=Se,J1=z.new_float,ca=z.new_int;function nr(){this.linprebuf=J1($e.MAX_ORDER*2),this.linpre=0,this.lstepbuf=J1($e.MAX_SAMPLES_PER_WINDOW+$e.MAX_ORDER),this.lstep=0,this.loutbuf=J1($e.MAX_SAMPLES_PER_WINDOW+$e.MAX_ORDER),this.lout=0,this.rinprebuf=J1($e.MAX_ORDER*2),this.rinpre=0,this.rstepbuf=J1($e.MAX_SAMPLES_PER_WINDOW+$e.MAX_ORDER),this.rstep=0,this.routbuf=J1($e.MAX_SAMPLES_PER_WINDOW+$e.MAX_ORDER),this.rout=0,this.sampleWindow=0,this.totsamp=0,this.lsum=0,this.rsum=0,this.freqindex=0,this.first=0,this.A=ca(0|$e.STEPS_per_dB*$e.MAX_dB),this.B=ca(0|$e.STEPS_per_dB*$e.MAX_dB)}var ir=nr;function lr(M){this.bits=M}var da=lr,ha=z.new_float,or=z.new_int,fa=z.assert;function _r(M){var F=M;this.quantize=F,this.iteration_loop=function(K,q,o0,X){var J=K.internal_flags,h0=ha(m1.SFBMAX),m0=ha(576),C=or(2),s0=0,b,w=J.l3_side,B=new da(s0);this.quantize.rv.ResvFrameBegin(K,B),s0=B.bits;for(var e=0;e<J.mode_gr;e++){b=this.quantize.qupvt.on_pe(K,q,C,s0,e,e),J.mode_ext==f.MPG_MD_MS_LR&&(this.quantize.ms_convert(J.l3_side,e),this.quantize.qupvt.reduce_side(C,o0[e],s0,b));for(var L=0;L<J.channels_out;L++){var I,E,s=w.tt[e][L];s.block_type!=f.SHORT_TYPE?(I=0,E=J.PSY.mask_adjust-I):(I=0,E=J.PSY.mask_adjust_short-I),J.masking_lower=Math.pow(10,E*.1),this.quantize.init_outer_loop(J,s),this.quantize.init_xrpow(J,s,m0)&&(this.quantize.qupvt.calc_xmin(K,X[e][L],s,h0),this.quantize.outer_loop(K,s,h0,m0,L,C[L])),this.quantize.iteration_finish_one(J,e,L),fa(s.part2_3_length<=de.MAX_BITS_PER_CHANNEL),fa(s.part2_3_length<=C[L])}}this.quantize.rv.ResvFrameEnd(J,s0)}}var ur=_r;function re(M,F,K,q){this.xlen=M,this.linmax=F,this.table=K,this.hlen=q}var d0={};d0.t1HB=[1,1,1,0],d0.t2HB=[1,2,1,3,1,1,3,2,0],d0.t3HB=[3,2,1,1,1,1,3,2,0],d0.t5HB=[1,2,6,5,3,1,4,4,7,5,7,1,6,1,1,0],d0.t6HB=[7,3,5,1,6,2,3,2,5,4,4,1,3,3,2,0],d0.t7HB=[1,2,10,19,16,10,3,3,7,10,5,3,11,4,13,17,8,4,12,11,18,15,11,2,7,6,9,14,3,1,6,4,5,3,2,0],d0.t8HB=[3,4,6,18,12,5,5,1,2,16,9,3,7,3,5,14,7,3,19,17,15,13,10,4,13,5,8,11,5,1,12,4,4,1,1,0],d0.t9HB=[7,5,9,14,15,7,6,4,5,5,6,7,7,6,8,8,8,5,15,6,9,10,5,1,11,7,9,6,4,1,14,4,6,2,6,0],d0.t10HB=[1,2,10,23,35,30,12,17,3,3,8,12,18,21,12,7,11,9,15,21,32,40,19,6,14,13,22,34,46,23,18,7,20,19,33,47,27,22,9,3,31,22,41,26,21,20,5,3,14,13,10,11,16,6,5,1,9,8,7,8,4,4,2,0],d0.t11HB=[3,4,10,24,34,33,21,15,5,3,4,10,32,17,11,10,11,7,13,18,30,31,20,5,25,11,19,59,27,18,12,5,35,33,31,58,30,16,7,5,28,26,32,19,17,15,8,14,14,12,9,13,14,9,4,1,11,4,6,6,6,3,2,0],d0.t12HB=[9,6,16,33,41,39,38,26,7,5,6,9,23,16,26,11,17,7,11,14,21,30,10,7,17,10,15,12,18,28,14,5,32,13,22,19,18,16,9,5,40,17,31,29,17,13,4,2,27,12,11,15,10,7,4,1,27,12,8,12,6,3,1,0],d0.t13HB=[1,5,14,21,34,51,46,71,42,52,68,52,67,44,43,19,3,4,12,19,31,26,44,33,31,24,32,24,31,35,22,14,15,13,23,36,59,49,77,65,29,40,30,40,27,33,42,16,22,20,37,61,56,79,73,64,43,76,56,37,26,31,25,14,35,16,60,57,97,75,114,91,54,73,55,41,48,53,23,24,58,27,50,96,76,70,93,84,77,58,79,29,74,49,41,17,47,45,78,74,115,94,90,79,69,83,71,50,59,38,36,15,72,34,56,95,92,85,91,90,86,73,77,65,51,44,43,42,43,20,30,44,55,78,72,87,78,61,46,54,37,30,20,16,53,25,41,37,44,59,54,81,66,76,57,54,37,18,39,11,35,33,31,57,42,82,72,80,47,58,55,21,22,26,38,22,53,25,23,38,70,60,51,36,55,26,34,23,27,14,9,7,34,32,28,39,49,75,30,52,48,40,52,28,18,17,9,5,45,21,34,64,56,50,49,45,31,19,12,15,10,7,6,3,48,23,20,39,36,35,53,21,16,23,13,10,6,1,4,2,16,15,17,27,25,20,29,11,17,12,16,8,1,1,0,1],d0.t15HB=[7,12,18,53,47,76,124,108,89,123,108,119,107,81,122,63,13,5,16,27,46,36,61,51,42,70,52,83,65,41,59,36,19,17,15,24,41,34,59,48,40,64,50,78,62,80,56,33,29,28,25,43,39,63,55,93,76,59,93,72,54,75,50,29,52,22,42,40,67,57,95,79,72,57,89,69,49,66,46,27,77,37,35,66,58,52,91,74,62,48,79,63,90,62,40,38,125,32,60,56,50,92,78,65,55,87,71,51,73,51,70,30,109,53,49,94,88,75,66,122,91,73,56,42,64,44,21,25,90,43,41,77,73,63,56,92,77,66,47,67,48,53,36,20,71,34,67,60,58,49,88,76,67,106,71,54,38,39,23,15,109,53,51,47,90,82,58,57,48,72,57,41,23,27,62,9,86,42,40,37,70,64,52,43,70,55,42,25,29,18,11,11,118,68,30,55,50,46,74,65,49,39,24,16,22,13,14,7,91,44,39,38,34,63,52,45,31,52,28,19,14,8,9,3,123,60,58,53,47,43,32,22,37,24,17,12,15,10,2,1,71,37,34,30,28,20,17,26,21,16,10,6,8,6,2,0],d0.t16HB=[1,5,14,44,74,63,110,93,172,149,138,242,225,195,376,17,3,4,12,20,35,62,53,47,83,75,68,119,201,107,207,9,15,13,23,38,67,58,103,90,161,72,127,117,110,209,206,16,45,21,39,69,64,114,99,87,158,140,252,212,199,387,365,26,75,36,68,65,115,101,179,164,155,264,246,226,395,382,362,9,66,30,59,56,102,185,173,265,142,253,232,400,388,378,445,16,111,54,52,100,184,178,160,133,257,244,228,217,385,366,715,10,98,48,91,88,165,157,148,261,248,407,397,372,380,889,884,8,85,84,81,159,156,143,260,249,427,401,392,383,727,713,708,7,154,76,73,141,131,256,245,426,406,394,384,735,359,710,352,11,139,129,67,125,247,233,229,219,393,743,737,720,885,882,439,4,243,120,118,115,227,223,396,746,742,736,721,712,706,223,436,6,202,224,222,218,216,389,386,381,364,888,443,707,440,437,1728,4,747,211,210,208,370,379,734,723,714,1735,883,877,876,3459,865,2,377,369,102,187,726,722,358,711,709,866,1734,871,3458,870,434,0,12,10,7,11,10,17,11,9,13,12,10,7,5,3,1,3],d0.t24HB=[15,13,46,80,146,262,248,434,426,669,653,649,621,517,1032,88,14,12,21,38,71,130,122,216,209,198,327,345,319,297,279,42,47,22,41,74,68,128,120,221,207,194,182,340,315,295,541,18,81,39,75,70,134,125,116,220,204,190,178,325,311,293,271,16,147,72,69,135,127,118,112,210,200,188,352,323,306,285,540,14,263,66,129,126,119,114,214,202,192,180,341,317,301,281,262,12,249,123,121,117,113,215,206,195,185,347,330,308,291,272,520,10,435,115,111,109,211,203,196,187,353,332,313,298,283,531,381,17,427,212,208,205,201,193,186,177,169,320,303,286,268,514,377,16,335,199,197,191,189,181,174,333,321,305,289,275,521,379,371,11,668,184,183,179,175,344,331,314,304,290,277,530,383,373,366,10,652,346,171,168,164,318,309,299,287,276,263,513,375,368,362,6,648,322,316,312,307,302,292,284,269,261,512,376,370,364,359,4,620,300,296,294,288,282,273,266,515,380,374,369,365,361,357,2,1033,280,278,274,267,264,259,382,378,372,367,363,360,358,356,0,43,20,19,17,15,13,11,9,7,6,4,7,5,3,1,3],d0.t32HB=[1,10,8,20,12,20,16,32,14,12,24,0,28,16,24,16],d0.t33HB=[15,28,26,48,22,40,36,64,14,24,20,32,12,16,8,0],d0.t1l=[1,4,3,5],d0.t2l=[1,4,7,4,5,7,6,7,8],d0.t3l=[2,3,7,4,4,7,6,7,8],d0.t5l=[1,4,7,8,4,5,8,9,7,8,9,10,8,8,9,10],d0.t6l=[3,4,6,8,4,4,6,7,5,6,7,8,7,7,8,9],d0.t7l=[1,4,7,9,9,10,4,6,8,9,9,10,7,7,9,10,10,11,8,9,10,11,11,11,8,9,10,11,11,12,9,10,11,12,12,12],d0.t8l=[2,4,7,9,9,10,4,4,6,10,10,10,7,6,8,10,10,11,9,10,10,11,11,12,9,9,10,11,12,12,10,10,11,11,13,13],d0.t9l=[3,4,6,7,9,10,4,5,6,7,8,10,5,6,7,8,9,10,7,7,8,9,9,10,8,8,9,9,10,11,9,9,10,10,11,11],d0.t10l=[1,4,7,9,10,10,10,11,4,6,8,9,10,11,10,10,7,8,9,10,11,12,11,11,8,9,10,11,12,12,11,12,9,10,11,12,12,12,12,12,10,11,12,12,13,13,12,13,9,10,11,12,12,12,13,13,10,10,11,12,12,13,13,13],d0.t11l=[2,4,6,8,9,10,9,10,4,5,6,8,10,10,9,10,6,7,8,9,10,11,10,10,8,8,9,11,10,12,10,11,9,10,10,11,11,12,11,12,9,10,11,12,12,13,12,13,9,9,9,10,11,12,12,12,9,9,10,11,12,12,12,12],d0.t12l=[4,4,6,8,9,10,10,10,4,5,6,7,9,9,10,10,6,6,7,8,9,10,9,10,7,7,8,8,9,10,10,10,8,8,9,9,10,10,10,11,9,9,10,10,10,11,10,11,9,9,9,10,10,11,11,12,10,10,10,11,11,11,11,12],d0.t13l=[1,5,7,8,9,10,10,11,10,11,12,12,13,13,14,14,4,6,8,9,10,10,11,11,11,11,12,12,13,14,14,14,7,8,9,10,11,11,12,12,11,12,12,13,13,14,15,15,8,9,10,11,11,12,12,12,12,13,13,13,13,14,15,15,9,9,11,11,12,12,13,13,12,13,13,14,14,15,15,16,10,10,11,12,12,12,13,13,13,13,14,13,15,15,16,16,10,11,12,12,13,13,13,13,13,14,14,14,15,15,16,16,11,11,12,13,13,13,14,14,14,14,15,15,15,16,18,18,10,10,11,12,12,13,13,14,14,14,14,15,15,16,17,17,11,11,12,12,13,13,13,15,14,15,15,16,16,16,18,17,11,12,12,13,13,14,14,15,14,15,16,15,16,17,18,19,12,12,12,13,14,14,14,14,15,15,15,16,17,17,17,18,12,13,13,14,14,15,14,15,16,16,17,17,17,18,18,18,13,13,14,15,15,15,16,16,16,16,16,17,18,17,18,18,14,14,14,15,15,15,17,16,16,19,17,17,17,19,18,18,13,14,15,16,16,16,17,16,17,17,18,18,21,20,21,18],d0.t15l=[3,5,6,8,8,9,10,10,10,11,11,12,12,12,13,14,5,5,7,8,9,9,10,10,10,11,11,12,12,12,13,13,6,7,7,8,9,9,10,10,10,11,11,12,12,13,13,13,7,8,8,9,9,10,10,11,11,11,12,12,12,13,13,13,8,8,9,9,10,10,11,11,11,11,12,12,12,13,13,13,9,9,9,10,10,10,11,11,11,11,12,12,13,13,13,14,10,9,10,10,10,11,11,11,11,12,12,12,13,13,14,14,10,10,10,11,11,11,11,12,12,12,12,12,13,13,13,14,10,10,10,11,11,11,11,12,12,12,12,13,13,14,14,14,10,10,11,11,11,11,12,12,12,13,13,13,13,14,14,14,11,11,11,11,12,12,12,12,12,13,13,13,13,14,15,14,11,11,11,11,12,12,12,12,13,13,13,13,14,14,14,15,12,12,11,12,12,12,13,13,13,13,13,13,14,14,15,15,12,12,12,12,12,13,13,13,13,14,14,14,14,14,15,15,13,13,13,13,13,13,13,13,14,14,14,14,15,15,14,15,13,13,13,13,13,13,13,14,14,14,14,14,15,15,15,15],d0.t16_5l=[1,5,7,9,10,10,11,11,12,12,12,13,13,13,14,11,4,6,8,9,10,11,11,11,12,12,12,13,14,13,14,11,7,8,9,10,11,11,12,12,13,12,13,13,13,14,14,12,9,9,10,11,11,12,12,12,13,13,14,14,14,15,15,13,10,10,11,11,12,12,13,13,13,14,14,14,15,15,15,12,10,10,11,11,12,13,13,14,13,14,14,15,15,15,16,13,11,11,11,12,13,13,13,13,14,14,14,14,15,15,16,13,11,11,12,12,13,13,13,14,14,15,15,15,15,17,17,13,11,12,12,13,13,13,14,14,15,15,15,15,16,16,16,13,12,12,12,13,13,14,14,15,15,15,15,16,15,16,15,14,12,13,12,13,14,14,14,14,15,16,16,16,17,17,16,13,13,13,13,13,14,14,15,16,16,16,16,16,16,15,16,14,13,14,14,14,14,15,15,15,15,17,16,16,16,16,18,14,15,14,14,14,15,15,16,16,16,18,17,17,17,19,17,14,14,15,13,14,16,16,15,16,16,17,18,17,19,17,16,14,11,11,11,12,12,13,13,13,14,14,14,14,14,14,14,12],d0.t16l=[1,5,7,9,10,10,11,11,12,12,12,13,13,13,14,10,4,6,8,9,10,11,11,11,12,12,12,13,14,13,14,10,7,8,9,10,11,11,12,12,13,12,13,13,13,14,14,11,9,9,10,11,11,12,12,12,13,13,14,14,14,15,15,12,10,10,11,11,12,12,13,13,13,14,14,14,15,15,15,11,10,10,11,11,12,13,13,14,13,14,14,15,15,15,16,12,11,11,11,12,13,13,13,13,14,14,14,14,15,15,16,12,11,11,12,12,13,13,13,14,14,15,15,15,15,17,17,12,11,12,12,13,13,13,14,14,15,15,15,15,16,16,16,12,12,12,12,13,13,14,14,15,15,15,15,16,15,16,15,13,12,13,12,13,14,14,14,14,15,16,16,16,17,17,16,12,13,13,13,13,14,14,15,16,16,16,16,16,16,15,16,13,13,14,14,14,14,15,15,15,15,17,16,16,16,16,18,13,15,14,14,14,15,15,16,16,16,18,17,17,17,19,17,13,14,15,13,14,16,16,15,16,16,17,18,17,19,17,16,13,10,10,10,11,11,12,12,12,13,13,13,13,13,13,13,10],d0.t24l=[4,5,7,8,9,10,10,11,11,12,12,12,12,12,13,10,5,6,7,8,9,10,10,11,11,11,12,12,12,12,12,10,7,7,8,9,9,10,10,11,11,11,11,12,12,12,13,9,8,8,9,9,10,10,10,11,11,11,11,12,12,12,12,9,9,9,9,10,10,10,10,11,11,11,12,12,12,12,13,9,10,9,10,10,10,10,11,11,11,11,12,12,12,12,12,9,10,10,10,10,10,11,11,11,11,12,12,12,12,12,13,9,11,10,10,10,11,11,11,11,12,12,12,12,12,13,13,10,11,11,11,11,11,11,11,11,11,12,12,12,12,13,13,10,11,11,11,11,11,11,11,12,12,12,12,12,13,13,13,10,12,11,11,11,11,12,12,12,12,12,12,13,13,13,13,10,12,12,11,11,11,12,12,12,12,12,12,13,13,13,13,10,12,12,12,12,12,12,12,12,12,12,13,13,13,13,13,10,12,12,12,12,12,12,12,12,13,13,13,13,13,13,13,10,13,12,12,12,12,12,12,13,13,13,13,13,13,13,13,10,9,9,9,9,9,9,9,9,9,9,9,10,10,10,10,6],d0.t32l=[1+0,4+1,4+1,5+2,4+1,6+2,5+2,6+3,4+1,5+2,5+2,6+3,5+2,6+3,6+3,6+4],d0.t33l=[4+0,4+1,4+1,4+2,4+1,4+2,4+2,4+3,4+1,4+2,4+2,4+3,4+2,4+3,4+3,4+4],d0.ht=[new re(0,0,null,null),new re(2,0,d0.t1HB,d0.t1l),new re(3,0,d0.t2HB,d0.t2l),new re(3,0,d0.t3HB,d0.t3l),new re(0,0,null,null),new re(4,0,d0.t5HB,d0.t5l),new re(4,0,d0.t6HB,d0.t6l),new re(6,0,d0.t7HB,d0.t7l),new re(6,0,d0.t8HB,d0.t8l),new re(6,0,d0.t9HB,d0.t9l),new re(8,0,d0.t10HB,d0.t10l),new re(8,0,d0.t11HB,d0.t11l),new re(8,0,d0.t12HB,d0.t12l),new re(16,0,d0.t13HB,d0.t13l),new re(0,0,null,d0.t16_5l),new re(16,0,d0.t15HB,d0.t15l),new re(1,1,d0.t16HB,d0.t16l),new re(2,3,d0.t16HB,d0.t16l),new re(3,7,d0.t16HB,d0.t16l),new re(4,15,d0.t16HB,d0.t16l),new re(6,63,d0.t16HB,d0.t16l),new re(8,255,d0.t16HB,d0.t16l),new re(10,1023,d0.t16HB,d0.t16l),new re(13,8191,d0.t16HB,d0.t16l),new re(4,15,d0.t24HB,d0.t24l),new re(5,31,d0.t24HB,d0.t24l),new re(6,63,d0.t24HB,d0.t24l),new re(7,127,d0.t24HB,d0.t24l),new re(8,255,d0.t24HB,d0.t24l),new re(9,511,d0.t24HB,d0.t24l),new re(11,2047,d0.t24HB,d0.t24l),new re(13,8191,d0.t24HB,d0.t24l),new re(0,0,d0.t32HB,d0.t32l),new re(0,0,d0.t33HB,d0.t33l)],d0.largetbl=[65540,327685,458759,589832,655369,655370,720906,720907,786443,786444,786444,851980,851980,851980,917517,655370,262149,393222,524295,589832,655369,720906,720906,720907,786443,786443,786444,851980,917516,851980,917516,655370,458759,524295,589832,655369,720905,720906,786442,786443,851979,786443,851979,851980,851980,917516,917517,720905,589832,589832,655369,720905,720906,786442,786442,786443,851979,851979,917515,917516,917516,983052,983052,786441,655369,655369,720905,720906,786442,786442,851978,851979,851979,917515,917516,917516,983052,983052,983053,720905,655370,655369,720906,720906,786442,851978,851979,917515,851979,917515,917516,983052,983052,983052,1048588,786441,720906,720906,720906,786442,851978,851979,851979,851979,917515,917516,917516,917516,983052,983052,1048589,786441,720907,720906,786442,786442,851979,851979,851979,917515,917516,983052,983052,983052,983052,1114125,1114125,786442,720907,786443,786443,851979,851979,851979,917515,917515,983051,983052,983052,983052,1048588,1048589,1048589,786442,786443,786443,786443,851979,851979,917515,917515,983052,983052,983052,983052,1048588,983053,1048589,983053,851978,786444,851979,786443,851979,917515,917516,917516,917516,983052,1048588,1048588,1048589,1114125,1114125,1048589,786442,851980,851980,851979,851979,917515,917516,983052,1048588,1048588,1048588,1048588,1048589,1048589,983053,1048589,851978,851980,917516,917516,917516,917516,983052,983052,983052,983052,1114124,1048589,1048589,1048589,1048589,1179661,851978,983052,917516,917516,917516,983052,983052,1048588,1048588,1048589,1179661,1114125,1114125,1114125,1245197,1114125,851978,917517,983052,851980,917516,1048588,1048588,983052,1048589,1048589,1114125,1179661,1114125,1245197,1114125,1048589,851978,655369,655369,655369,720905,720905,786441,786441,786441,851977,851977,851977,851978,851978,851978,851978,655366],d0.table23=[65538,262147,458759,262148,327684,458759,393222,458759,524296],d0.table56=[65539,262148,458758,524296,262148,327684,524294,589831,458757,524294,589831,655368,524295,524295,589832,655369],d0.bitrate_table=[[0,8,16,24,32,40,48,56,64,80,96,112,128,144,160,-1],[0,32,40,48,56,64,80,96,112,128,160,192,224,256,320,-1],[0,8,16,24,32,40,48,56,64,-1,-1,-1,-1,-1,-1,-1]],d0.samplerate_table=[[22050,24e3,16e3,-1],[44100,48e3,32e3,-1],[11025,12e3,8e3,-1]],d0.scfsi_band=[0,6,11,16,21];var ae=d0,Z1=z.VbrMode,It=z.Float,Zt=z.Util,D1=z.new_float,vr=z.new_int,ut=z.assert;B1.Q_MAX=256+1,B1.Q_MAX2=116,B1.LARGE_BITS=1e5,B1.IXMAX_VAL=8206;function B1(){var M=null,F=null,K=null;this.setModules=function(s,d,x){M=s,F=d,K=x};function q(s){return b[s+B1.Q_MAX2]}this.IPOW20=function(s){return w[s]};var o0=2220446049250313e-31,X=B1.IXMAX_VAL,J=X+2,h0=B1.Q_MAX,m0=B1.Q_MAX2,C=100;this.nr_of_sfb_block=[[[6,5,5,5],[9,9,9,9],[6,9,9,9]],[[6,5,7,3],[9,9,12,6],[6,9,12,6]],[[11,10,0,0],[18,18,0,0],[15,18,0,0]],[[7,7,7,0],[12,12,12,0],[6,15,12,0]],[[6,6,6,3],[12,9,9,6],[6,12,9,6]],[[8,8,5,0],[15,12,9,0],[6,18,9,0]]];var s0=[0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,2,2,3,3,3,2,0];this.pretab=s0,this.sfBandIndex=[new i1([0,6,12,18,24,30,36,44,54,66,80,96,116,140,168,200,238,284,336,396,464,522,576],[0,4,8,12,18,24,32,42,56,74,100,132,174,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new i1([0,6,12,18,24,30,36,44,54,66,80,96,114,136,162,194,232,278,332,394,464,540,576],[0,4,8,12,18,26,36,48,62,80,104,136,180,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new i1([0,6,12,18,24,30,36,44,54,66,80,96,116,140,168,200,238,284,336,396,464,522,576],[0,4,8,12,18,26,36,48,62,80,104,134,174,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new i1([0,4,8,12,16,20,24,30,36,44,52,62,74,90,110,134,162,196,238,288,342,418,576],[0,4,8,12,16,22,30,40,52,66,84,106,136,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new i1([0,4,8,12,16,20,24,30,36,42,50,60,72,88,106,128,156,190,230,276,330,384,576],[0,4,8,12,16,22,28,38,50,64,80,100,126,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new i1([0,4,8,12,16,20,24,30,36,44,54,66,82,102,126,156,194,240,296,364,448,550,576],[0,4,8,12,16,22,30,42,58,78,104,138,180,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new i1([0,6,12,18,24,30,36,44,54,66,80,96,116,140,168,200,238,284,336,396,464,522,576],[0/3,12/3,24/3,36/3,54/3,78/3,108/3,144/3,186/3,240/3,312/3,402/3,522/3,576/3],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new i1([0,6,12,18,24,30,36,44,54,66,80,96,116,140,168,200,238,284,336,396,464,522,576],[0/3,12/3,24/3,36/3,54/3,78/3,108/3,144/3,186/3,240/3,312/3,402/3,522/3,576/3],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new i1([0,12,24,36,48,60,72,88,108,132,160,192,232,280,336,400,476,566,568,570,572,574,576],[0/3,24/3,48/3,72/3,108/3,156/3,216/3,288/3,372/3,480/3,486/3,492/3,498/3,576/3],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0])];var b=D1(h0+m0+1),w=D1(h0),B=D1(J),e=D1(J);this.adj43=e;function L(s,d){var x=K.ATHformula(d,s);return x-=C,x=Math.pow(10,x/10+s.ATHlower),x}function I(s){for(var d=s.internal_flags.ATH.l,x=s.internal_flags.ATH.psfb21,y=s.internal_flags.ATH.s,R=s.internal_flags.ATH.psfb12,t=s.internal_flags,c=s.out_samplerate,_=0;_<f.SBMAX_l;_++){var n=t.scalefac_band.l[_],u=t.scalefac_band.l[_+1];d[_]=It.MAX_VALUE;for(var v=n;v<u;v++){var r=v*c/1152,i=L(s,r);d[_]=Math.min(d[_],i)}}for(var _=0;_<f.PSFB21;_++){var n=t.scalefac_band.psfb21[_],u=t.scalefac_band.psfb21[_+1];x[_]=It.MAX_VALUE;for(var v=n;v<u;v++){var r=v*c/1152,i=L(s,r);x[_]=Math.min(x[_],i)}}for(var _=0;_<f.SBMAX_s;_++){var n=t.scalefac_band.s[_],u=t.scalefac_band.s[_+1];y[_]=It.MAX_VALUE;for(var v=n;v<u;v++){var r=v*c/384,i=L(s,r);y[_]=Math.min(y[_],i)}y[_]*=t.scalefac_band.s[_+1]-t.scalefac_band.s[_]}for(var _=0;_<f.PSFB12;_++){var n=t.scalefac_band.psfb12[_],u=t.scalefac_band.psfb12[_+1];R[_]=It.MAX_VALUE;for(var v=n;v<u;v++){var r=v*c/384,i=L(s,r);R[_]=Math.min(R[_],i)}R[_]*=t.scalefac_band.s[13]-t.scalefac_band.s[12]}if(s.noATH){for(var _=0;_<f.SBMAX_l;_++)d[_]=1e-20;for(var _=0;_<f.PSFB21;_++)x[_]=1e-20;for(var _=0;_<f.SBMAX_s;_++)y[_]=1e-20;for(var _=0;_<f.PSFB12;_++)R[_]=1e-20}t.ATH.floor=10*Math.log10(L(s,-1))}this.iteration_init=function(s){var d=s.internal_flags,x=d.l3_side,y;if(d.iteration_init_init==0){for(d.iteration_init_init=1,x.main_data_begin=0,I(s),B[0]=0,y=1;y<J;y++)B[y]=Math.pow(y,4/3);for(y=0;y<J-1;y++)e[y]=y+1-Math.pow(.5*(B[y]+B[y+1]),.75);for(e[y]=.5,y=0;y<h0;y++)w[y]=Math.pow(2,(y-210)*-.1875);for(y=0;y<=h0+m0;y++)b[y]=Math.pow(2,(y-210-m0)*.25);M.huffman_init(d);{var R,t,c,_;for(y=s.exp_nspsytune>>2&63,y>=32&&(y-=64),R=Math.pow(10,y/4/10),y=s.exp_nspsytune>>8&63,y>=32&&(y-=64),t=Math.pow(10,y/4/10),y=s.exp_nspsytune>>14&63,y>=32&&(y-=64),c=Math.pow(10,y/4/10),y=s.exp_nspsytune>>20&63,y>=32&&(y-=64),_=c*Math.pow(10,y/4/10),y=0;y<f.SBMAX_l;y++){var n;y<=6?n=R:y<=13?n=t:y<=20?n=c:n=_,d.nsPsy.longfact[y]=n}for(y=0;y<f.SBMAX_s;y++){var n;y<=5?n=R:y<=10?n=t:y<=11?n=c:n=_,d.nsPsy.shortfact[y]=n}}}},this.on_pe=function(s,d,x,y,R,t){var c=s.internal_flags,_=0,n,u=vr(2),v,r=new da(_),i=F.ResvMaxBits(s,y,r,t);_=r.bits;var l=_+i;for(l>de.MAX_BITS_PER_GRANULE&&(l=de.MAX_BITS_PER_GRANULE),n=0,v=0;v<c.channels_out;++v)x[v]=Math.min(de.MAX_BITS_PER_CHANNEL,_/c.channels_out),u[v]=0|x[v]*d[R][v]/700-x[v],u[v]>y*3/4&&(u[v]=y*3/4),u[v]<0&&(u[v]=0),u[v]+x[v]>de.MAX_BITS_PER_CHANNEL&&(u[v]=Math.max(0,de.MAX_BITS_PER_CHANNEL-x[v])),n+=u[v];if(n>i)for(v=0;v<c.channels_out;++v)u[v]=i*u[v]/n;for(v=0;v<c.channels_out;++v)x[v]+=u[v],i-=u[v];for(n=0,v=0;v<c.channels_out;++v)n+=x[v];if(n>de.MAX_BITS_PER_GRANULE){var S=0;for(v=0;v<c.channels_out;++v)x[v]*=de.MAX_BITS_PER_GRANULE,x[v]/=n,S+=x[v]}return l},this.reduce_side=function(s,d,x,y){ut(s[0]+s[1]<=de.MAX_BITS_PER_GRANULE);var R=.33*(.5-d)/.5;R<0&&(R=0),R>.5&&(R=.5);var t=0|R*.5*(s[0]+s[1]);t>de.MAX_BITS_PER_CHANNEL-s[0]&&(t=de.MAX_BITS_PER_CHANNEL-s[0]),t<0&&(t=0),s[1]>=125&&(s[1]-t>125?(s[0]<x&&(s[0]+=t),s[1]-=t):(s[0]+=s[1]-125,s[1]=125)),t=s[0]+s[1],t>y&&(s[0]=y*s[0]/t,s[1]=y*s[1]/t),ut(s[0]<=de.MAX_BITS_PER_CHANNEL),ut(s[1]<=de.MAX_BITS_PER_CHANNEL),ut(s[0]+s[1]<=de.MAX_BITS_PER_GRANULE)},this.athAdjust=function(s,d,x){var y=90.30873362,R=94.82444863,t=Zt.FAST_LOG10_X(d,10),c=s*s,_=0;return t-=x,c>1e-20&&(_=1+Zt.FAST_LOG10_X(c,10/y)),_<0&&(_=0),t*=_,t+=x+y-R,Math.pow(10,.1*t)},this.calc_xmin=function(s,d,x,y){var R=0,t=s.internal_flags,c,_=0,n=0,u=t.ATH,v=x.xr,r=s.VBR==Z1.vbr_mtrh?1:0,i=t.masking_lower;for((s.VBR==Z1.vbr_mtrh||s.VBR==Z1.vbr_mt)&&(i=1),c=0;c<x.psy_lmax;c++){var l,S,Y,k,O,a;s.VBR==Z1.vbr_rh||s.VBR==Z1.vbr_mtrh?S=athAdjust(u.adjust,u.l[c],u.floor):S=u.adjust*u.l[c],O=x.width[c],Y=S/O,k=o0,a=O>>1,l=0;do{var o,j;o=v[_]*v[_],l+=o,k+=o<Y?o:Y,_++,j=v[_]*v[_],l+=j,k+=j<Y?j:Y,_++}while(--a>0);if(l>S&&n++,c==f.SBPSY_l){var e0=S*t.nsPsy.longfact[c];k<e0&&(k=e0)}if(r!=0&&(S=k),!s.ATHonly){var f0=d.en.l[c];if(f0>0){var e0;e0=l*d.thm.l[c]*i/f0,r!=0&&(e0*=t.nsPsy.longfact[c]),S<e0&&(S=e0)}}r!=0?y[R++]=S:y[R++]=S*t.nsPsy.longfact[c]}var y0=575;if(x.block_type!=f.SHORT_TYPE)for(var p0=576;p0--!=0&&E1.EQ(v[p0],0);)y0=p0;x.max_nonzero_coeff=y0;for(var w0=x.sfb_smin;c<x.psymax;w0++,c+=3){var O,F0,k0;for(s.VBR==Z1.vbr_rh||s.VBR==Z1.vbr_mtrh?k0=athAdjust(u.adjust,u.s[w0],u.floor):k0=u.adjust*u.s[w0],O=x.width[c],F0=0;F0<3;F0++){var l=0,S,Y,k,a=O>>1;Y=k0/O,k=o0;do{var o,j;o=v[_]*v[_],l+=o,k+=o<Y?o:Y,_++,j=v[_]*v[_],l+=j,k+=j<Y?j:Y,_++}while(--a>0);if(l>k0&&n++,w0==f.SBPSY_s){var e0=k0*t.nsPsy.shortfact[w0];k<e0&&(k=e0)}if(r!=0?S=k:S=k0,!s.ATHonly&&!s.ATHshort){var f0=d.en.s[w0][F0];if(f0>0){var e0;e0=l*d.thm.s[w0][F0]*i/f0,r!=0&&(e0*=t.nsPsy.shortfact[w0]),S<e0&&(S=e0)}}r!=0?y[R++]=S:y[R++]=S*t.nsPsy.shortfact[w0]}s.useTemporal&&(y[R-3]>y[R-3+1]&&(y[R-3+1]+=(y[R-3]-y[R-3+1])*t.decay),y[R-3+1]>y[R-3+2]&&(y[R-3+2]+=(y[R-3+1]-y[R-3+2])*t.decay))}return n};function E(s){this.s=s}this.calc_noise_core=function(s,d,x,y){var R=0,t=d.s,c=s.l3_enc;if(t>s.count1)for(;x--!=0;){var _;_=s.xr[t],t++,R+=_*_,_=s.xr[t],t++,R+=_*_}else if(t>s.big_values){var n=D1(2);for(n[0]=0,n[1]=y;x--!=0;){var _;_=Math.abs(s.xr[t])-n[c[t]],t++,R+=_*_,_=Math.abs(s.xr[t])-n[c[t]],t++,R+=_*_}}else for(;x--!=0;){var _;_=Math.abs(s.xr[t])-B[c[t]]*y,t++,R+=_*_,_=Math.abs(s.xr[t])-B[c[t]]*y,t++,R+=_*_}return d.s=t,R},this.calc_noise=function(s,d,x,y,R){var t=0,c=0,_,n,u=0,v=0,r=0,i=-20,l=0,S=s.scalefac,Y=0;for(y.over_SSD=0,_=0;_<s.psymax;_++){var k=s.global_gain-(S[Y++]+(s.preflag!=0?s0[_]:0)<<s.scalefac_scale+1)-s.subblock_gain[s.window[_]]*8,O=0;if(R!=null&&R.step[_]==k)O=R.noise[_],l+=s.width[_],x[t++]=O/d[c++],O=R.noise_log[_];else{var a=q(k);if(n=s.width[_]>>1,l+s.width[_]>s.max_nonzero_coeff){var o;o=s.max_nonzero_coeff-l+1,o>0?n=o>>1:n=0}var j=new E(l);O=this.calc_noise_core(s,j,n,a),l=j.s,R!=null&&(R.step[_]=k,R.noise[_]=O),O=x[t++]=O/d[c++],O=Zt.FAST_LOG10(Math.max(O,1e-20)),R!=null&&(R.noise_log[_]=O)}if(R!=null&&(R.global_gain=s.global_gain),r+=O,O>0){var e0;e0=Math.max(0|O*10+.5,1),y.over_SSD+=e0*e0,u++,v+=O}i=Math.max(i,O)}return y.over_count=u,y.tot_noise=r,y.over_noise=v,y.max_noise=i,u},this.set_pinfo=function(s,d,x,y,R){var t=s.internal_flags,c,_,n,u,v,r=d.scalefac_scale==0?.5:1,i=d.scalefac,l=D1(L3Side.SFBMAX),S=D1(L3Side.SFBMAX),Y=new CalcNoiseResult;calc_xmin(s,x,d,l),calc_noise(d,l,S,Y,null);var k=0;for(_=d.sfb_lmax,d.block_type!=f.SHORT_TYPE&&d.mixed_block_flag==0&&(_=22),c=0;c<_;c++){var O=t.scalefac_band.l[c],a=t.scalefac_band.l[c+1],o=a-O;for(u=0;k<a;k++)u+=d.xr[k]*d.xr[k];u/=o,v=1e15,t.pinfo.en[y][R][c]=v*u,t.pinfo.xfsf[y][R][c]=v*l[c]*S[c]/o,x.en.l[c]>0&&!s.ATHonly?u=u/x.en.l[c]:u=0,t.pinfo.thr[y][R][c]=v*Math.max(u*x.thm.l[c],t.ATH.l[c]),t.pinfo.LAMEsfb[y][R][c]=0,d.preflag!=0&&c>=11&&(t.pinfo.LAMEsfb[y][R][c]=-r*s0[c]),c<f.SBPSY_l&&(ut(i[c]>=0),t.pinfo.LAMEsfb[y][R][c]-=r*i[c])}if(d.block_type==f.SHORT_TYPE)for(_=c,c=d.sfb_smin;c<f.SBMAX_s;c++)for(var O=t.scalefac_band.s[c],a=t.scalefac_band.s[c+1],o=a-O,j=0;j<3;j++){for(u=0,n=O;n<a;n++)u+=d.xr[k]*d.xr[k],k++;u=Math.max(u/o,1e-20),v=1e15,t.pinfo.en_s[y][R][3*c+j]=v*u,t.pinfo.xfsf_s[y][R][3*c+j]=v*l[_]*S[_]/o,x.en.s[c][j]>0?u=u/x.en.s[c][j]:u=0,(s.ATHonly||s.ATHshort)&&(u=0),t.pinfo.thr_s[y][R][3*c+j]=v*Math.max(u*x.thm.s[c][j],t.ATH.s[c]),t.pinfo.LAMEsfb_s[y][R][3*c+j]=-2*d.subblock_gain[j],c<f.SBPSY_s&&(t.pinfo.LAMEsfb_s[y][R][3*c+j]-=r*i[_]),_++}t.pinfo.LAMEqss[y][R]=d.global_gain,t.pinfo.LAMEmainbits[y][R]=d.part2_3_length+d.part2_length,t.pinfo.LAMEsfbits[y][R]=d.part2_length,t.pinfo.over[y][R]=Y.over_count,t.pinfo.max_noise[y][R]=Y.max_noise*10,t.pinfo.over_noise[y][R]=Y.over_noise*10,t.pinfo.tot_noise[y][R]=Y.tot_noise*10,t.pinfo.over_SSD[y][R]=Y.over_SSD}}var I1=B1,cr=z.System,dr=z.Arrays,vt=z.new_int,Dt=z.assert;function Pt(){var M=null;this.qupvt=null,this.setModules=function(n){this.qupvt=n,M=n};function F(n){this.bits=0|n}var K=[[0,0],[0,0],[0,0],[0,0],[0,0],[0,1],[1,1],[1,1],[1,2],[2,2],[2,3],[2,3],[3,4],[3,4],[3,4],[4,5],[4,5],[4,6],[5,6],[5,6],[5,7],[6,7],[6,7]];function q(n,u,v,r,i,l){var S=.5946/u;for(n=n>>1;n--!=0;)i[l++]=S>v[r++]?0:1,i[l++]=S>v[r++]?0:1}function o0(n,u,v,r,i,l){n=n>>1;var S=n%2;for(n=n>>1;n--!=0;){var Y,k,O,a,o,j,e0,f0;Y=v[r++]*u,k=v[r++]*u,o=0|Y,O=v[r++]*u,j=0|k,a=v[r++]*u,e0=0|O,Y+=M.adj43[o],f0=0|a,k+=M.adj43[j],i[l++]=0|Y,O+=M.adj43[e0],i[l++]=0|k,a+=M.adj43[f0],i[l++]=0|O,i[l++]=0|a}if(S!=0){var Y,k,o,j;Y=v[r++]*u,k=v[r++]*u,o=0|Y,j=0|k,Y+=M.adj43[o],k+=M.adj43[j],i[l++]=0|Y,i[l++]=0|k}}function X(n,u,v,r,i){var l,S,Y=0,k,O=0,a=0,o=0,j=u,e0=0,f0=j,y0=0,p0=n,w0=0;for(k=i!=null&&r.global_gain==i.global_gain,r.block_type==f.SHORT_TYPE?S=38:S=21,l=0;l<=S;l++){var F0=-1;if((k||r.block_type==f.NORM_TYPE)&&(F0=r.global_gain-(r.scalefac[l]+(r.preflag!=0?M.pretab[l]:0)<<r.scalefac_scale+1)-r.subblock_gain[r.window[l]]*8),Dt(r.width[l]>=0),k&&i.step[l]==F0)O!=0&&(o0(O,v,p0,w0,f0,y0),O=0),a!=0&&(q(a,v,p0,w0,f0,y0),a=0);else{var k0=r.width[l];if(Y+r.width[l]>r.max_nonzero_coeff){var b0;b0=r.max_nonzero_coeff-Y+1,dr.fill(u,r.max_nonzero_coeff,576,0),k0=b0,k0<0&&(k0=0),l=S+1}if(O==0&&a==0&&(f0=j,y0=e0,p0=n,w0=o),i!=null&&i.sfb_count1>0&&l>=i.sfb_count1&&i.step[l]>0&&F0>=i.step[l]?(O!=0&&(o0(O,v,p0,w0,f0,y0),O=0,f0=j,y0=e0,p0=n,w0=o),a+=k0):(a!=0&&(q(a,v,p0,w0,f0,y0),a=0,f0=j,y0=e0,p0=n,w0=o),O+=k0),k0<=0){a!=0&&(q(a,v,p0,w0,f0,y0),a=0),O!=0&&(o0(O,v,p0,w0,f0,y0),O=0);break}}l<=S&&(e0+=r.width[l],o+=r.width[l],Y+=r.width[l])}O!=0&&(o0(O,v,p0,w0,f0,y0),O=0),a!=0&&(q(a,v,p0,w0,f0,y0),a=0)}function J(n,u,v){var r=0,i=0;do{var l=n[u++],S=n[u++];r<l&&(r=l),i<S&&(i=S)}while(u<v);return r<i&&(r=i),r}function h0(n,u,v,r,i,l){var S=ae.ht[r].xlen*65536+ae.ht[i].xlen,Y=0,k;do{var O=n[u++],a=n[u++];O!=0&&(O>14&&(O=15,Y+=S),O*=16),a!=0&&(a>14&&(a=15,Y+=S),O+=a),Y+=ae.largetbl[O]}while(u<v);return k=Y&65535,Y>>=16,Y>k&&(Y=k,r=i),l.bits+=Y,r}function m0(n,u,v,r){var i=0,l=ae.ht[1].hlen;do{var S=n[u+0]*2+n[u+1];u+=2,i+=l[S]}while(u<v);return r.bits+=i,1}function C(n,u,v,r,i){var l=0,S,Y=ae.ht[r].xlen,k;r==2?k=ae.table23:k=ae.table56;do{var O=n[u+0]*Y+n[u+1];u+=2,l+=k[O]}while(u<v);return S=l&65535,l>>=16,l>S&&(l=S,r++),i.bits+=l,r}function s0(n,u,v,r,i){var l=0,S=0,Y=0,k=ae.ht[r].xlen,O=ae.ht[r].hlen,a=ae.ht[r+1].hlen,o=ae.ht[r+2].hlen;do{var j=n[u+0]*k+n[u+1];u+=2,l+=O[j],S+=a[j],Y+=o[j]}while(u<v);var e0=r;return l>S&&(l=S,e0++),l>Y&&(l=Y,e0=r+2),i.bits+=l,e0}var b=[1,2,5,7,7,10,10,13,13,13,13,13,13,13,13];function w(n,u,v,r){var i=J(n,u,v);switch(i){case 0:return i;case 1:return m0(n,u,v,r);case 2:case 3:return C(n,u,v,b[i-1],r);case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 12:case 13:case 14:case 15:return s0(n,u,v,b[i-1],r);default:if(i>I1.IXMAX_VAL)return r.bits=I1.LARGE_BITS,-1;i-=15;var l;for(l=24;l<32&&!(ae.ht[l].linmax>=i);l++);var S;for(S=l-8;S<24&&!(ae.ht[S].linmax>=i);S++);return h0(n,u,v,S,l,r)}}this.noquant_count_bits=function(n,u,v){var r=u.l3_enc,i=Math.min(576,u.max_nonzero_coeff+2>>1<<1);for(v!=null&&(v.sfb_count1=0);i>1&&!(r[i-1]|r[i-2]);i-=2);u.count1=i;for(var l=0,S=0;i>3;i-=4){var Y;if(((r[i-1]|r[i-2]|r[i-3]|r[i-4])&2147483647)>1)break;Y=((r[i-4]*2+r[i-3])*2+r[i-2])*2+r[i-1],l+=ae.t32l[Y],S+=ae.t33l[Y]}var k=l;if(u.count1table_select=0,l>S&&(k=S,u.count1table_select=1),u.count1bits=k,u.big_values=i,i==0)return k;if(u.block_type==f.SHORT_TYPE)l=3*n.scalefac_band.s[3],l>u.big_values&&(l=u.big_values),S=u.big_values;else if(u.block_type==f.NORM_TYPE){if(l=u.region0_count=n.bv_scf[i-2],S=u.region1_count=n.bv_scf[i-1],S=n.scalefac_band.l[l+S+2],l=n.scalefac_band.l[l+1],S<i){var O=new F(k);u.table_select[2]=w(r,S,i,O),k=O.bits}}else u.region0_count=7,u.region1_count=f.SBMAX_l-1-7-1,l=n.scalefac_band.l[7+1],S=i,l>S&&(l=S);if(l=Math.min(l,i),S=Math.min(S,i),0<l){var O=new F(k);u.table_select[0]=w(r,0,l,O),k=O.bits}if(l<S){var O=new F(k);u.table_select[1]=w(r,l,S,O),k=O.bits}if(n.use_best_huffman==2&&(u.part2_3_length=k,best_huffman_divide(n,u),k=u.part2_3_length),v!=null&&u.block_type==f.NORM_TYPE){for(var a=0;n.scalefac_band.l[a]<u.big_values;)a++;v.sfb_count1=a}return k},this.count_bits=function(n,u,v,r){var i=v.l3_enc,l=I1.IXMAX_VAL/M.IPOW20(v.global_gain);if(v.xrpow_max>l)return I1.LARGE_BITS;if(X(u,i,M.IPOW20(v.global_gain),v,r),n.substep_shaping&2)for(var S=0,Y=v.global_gain+v.scalefac_scale,k=.634521682242439/M.IPOW20(Y),O=0;O<v.sfbmax;O++){var a=v.width[O];if(n.pseudohalf[O]==0)S+=a;else{var o;for(o=S,S+=a;o<S;++o)i[o]=u[o]>=k?i[o]:0}}return this.noquant_count_bits(n,v,r)};function B(n,u,v,r,i,l,S){for(var Y=u.big_values,k=0;k<=7+15;k++)r[k]=I1.LARGE_BITS;for(var k=0;k<16;k++){var O=n.scalefac_band.l[k+1];if(O>=Y)break;var a=0,o=new F(a),j=w(v,0,O,o);a=o.bits;for(var e0=0;e0<8;e0++){var f0=n.scalefac_band.l[k+e0+2];if(f0>=Y)break;var y0=a;o=new F(y0);var p0=w(v,O,f0,o);y0=o.bits,r[k+e0]>y0&&(r[k+e0]=y0,i[k+e0]=k,l[k+e0]=j,S[k+e0]=p0)}}}function e(n,u,v,r,i,l,S,Y){for(var k=u.big_values,O=2;O<f.SBMAX_l+1;O++){var a=n.scalefac_band.l[O];if(a>=k)break;var o=i[O-2]+u.count1bits;if(v.part2_3_length<=o)break;var j=new F(o),e0=w(r,a,k,j);o=j.bits,!(v.part2_3_length<=o)&&(v.assign(u),v.part2_3_length=o,v.region0_count=l[O-2],v.region1_count=O-2-l[O-2],v.table_select[0]=S[O-2],v.table_select[1]=Y[O-2],v.table_select[2]=e0)}}this.best_huffman_divide=function(n,u){var v=new $1,r=u.l3_enc,i=vt(7+15+1),l=vt(7+15+1),S=vt(7+15+1),Y=vt(7+15+1);if(!(u.block_type==f.SHORT_TYPE&&n.mode_gr==1)){v.assign(u),u.block_type==f.NORM_TYPE&&(B(n,u,r,i,l,S,Y),e(n,v,u,r,i,l,S,Y));var k=v.big_values;if(!(k==0||(r[k-2]|r[k-1])>1)&&(k=u.count1+2,!(k>576))){v.assign(u),v.count1=k;for(var O=0,a=0;k>v.big_values;k-=4){var o=((r[k-4]*2+r[k-3])*2+r[k-2])*2+r[k-1];O+=ae.t32l[o],a+=ae.t33l[o]}if(v.big_values=k,v.count1table_select=0,O>a&&(O=a,v.count1table_select=1),v.count1bits=O,v.block_type==f.NORM_TYPE)e(n,v,u,r,i,l,S,Y);else{if(v.part2_3_length=O,O=n.scalefac_band.l[7+1],O>k&&(O=k),O>0){var j=new F(v.part2_3_length);v.table_select[0]=w(r,0,O,j),v.part2_3_length=j.bits}if(k>O){var j=new F(v.part2_3_length);v.table_select[1]=w(r,O,k,j),v.part2_3_length=j.bits}u.part2_3_length>v.part2_3_length&&u.assign(v)}}}};var L=[1,1,1,1,8,2,2,2,4,4,4,8,8,8,16,16],I=[1,2,4,8,1,2,4,8,2,4,8,2,4,8,4,8],E=[0,0,0,0,3,1,1,1,2,2,2,3,3,3,4,4],s=[0,1,2,3,0,1,2,3,1,2,3,1,2,3,2,3];Pt.slen1_tab=E,Pt.slen2_tab=s;function d(n,u){for(var v,r=u.tt[1][n],i=u.tt[0][n],l=0;l<ae.scfsi_band.length-1;l++){for(v=ae.scfsi_band[l];v<ae.scfsi_band[l+1]&&!(i.scalefac[v]!=r.scalefac[v]&&r.scalefac[v]>=0);v++);if(v==ae.scfsi_band[l+1]){for(v=ae.scfsi_band[l];v<ae.scfsi_band[l+1];v++)r.scalefac[v]=-1;u.scfsi[n][l]=1}}var S=0,Y=0;for(v=0;v<11;v++)r.scalefac[v]!=-1&&(Y++,S<r.scalefac[v]&&(S=r.scalefac[v]));for(var k=0,O=0;v<f.SBPSY_l;v++)r.scalefac[v]!=-1&&(O++,k<r.scalefac[v]&&(k=r.scalefac[v]));for(var l=0;l<16;l++)if(S<L[l]&&k<I[l]){var a=E[l]*Y+s[l]*O;r.part2_length>a&&(r.part2_length=a,r.scalefac_compress=l)}}this.best_scalefac_store=function(n,u,v,r){var i=r.tt[u][v],l,S,Y,k,O=0;for(Y=0,l=0;l<i.sfbmax;l++){var a=i.width[l];for(Y+=a,k=-a;k<0&&i.l3_enc[k+Y]==0;k++);k==0&&(i.scalefac[l]=O=-2)}if(i.scalefac_scale==0&&i.preflag==0){var o=0;for(l=0;l<i.sfbmax;l++)i.scalefac[l]>0&&(o|=i.scalefac[l]);if(!(o&1)&&o!=0){for(l=0;l<i.sfbmax;l++)i.scalefac[l]>0&&(i.scalefac[l]>>=1);i.scalefac_scale=O=1}}if(i.preflag==0&&i.block_type!=f.SHORT_TYPE&&n.mode_gr==2){for(l=11;l<f.SBPSY_l&&!(i.scalefac[l]<M.pretab[l]&&i.scalefac[l]!=-2);l++);if(l==f.SBPSY_l){for(l=11;l<f.SBPSY_l;l++)i.scalefac[l]>0&&(i.scalefac[l]-=M.pretab[l]);i.preflag=O=1}}for(S=0;S<4;S++)r.scfsi[v][S]=0;for(n.mode_gr==2&&u==1&&r.tt[0][v].block_type!=f.SHORT_TYPE&&r.tt[1][v].block_type!=f.SHORT_TYPE&&(d(v,r),O=0),l=0;l<i.sfbmax;l++)i.scalefac[l]==-2&&(i.scalefac[l]=0);O!=0&&(n.mode_gr==2?this.scale_bitcount(i):this.scale_bitcount_lsf(n,i))};function x(n,u){for(var v=0;v<u;++v)if(n[v]<0)return!1;return!0}var y=[0,18,36,54,54,36,54,72,54,72,90,72,90,108,108,126],R=[0,18,36,54,51,35,53,71,52,70,88,69,87,105,104,122],t=[0,10,20,30,33,21,31,41,32,42,52,43,53,63,64,74];this.scale_bitcount=function(n){var u,v,r=0,i=0,l,S=n.scalefac;if(Dt(x(S,n.sfbmax)),n.block_type==f.SHORT_TYPE)l=y,n.mixed_block_flag!=0&&(l=R);else if(l=t,n.preflag==0){for(v=11;v<f.SBPSY_l&&!(S[v]<M.pretab[v]);v++);if(v==f.SBPSY_l)for(n.preflag=1,v=11;v<f.SBPSY_l;v++)S[v]-=M.pretab[v]}for(v=0;v<n.sfbdivide;v++)r<S[v]&&(r=S[v]);for(;v<n.sfbmax;v++)i<S[v]&&(i=S[v]);for(n.part2_length=I1.LARGE_BITS,u=0;u<16;u++)r<L[u]&&i<I[u]&&n.part2_length>l[u]&&(n.part2_length=l[u],n.scalefac_compress=u);return n.part2_length==I1.LARGE_BITS};var c=[[15,15,7,7],[15,15,7,0],[7,3,0,0],[15,31,31,0],[7,7,7,0],[3,3,0,0]];this.scale_bitcount_lsf=function(n,u){var v,r,i,l,S,Y,k,O,a=vt(4),o=u.scalefac;for(u.preflag!=0?v=2:v=0,k=0;k<4;k++)a[k]=0;if(u.block_type==f.SHORT_TYPE){r=1;var j=M.nr_of_sfb_block[v][r];for(O=0,i=0;i<4;i++)for(l=j[i]/3,k=0;k<l;k++,O++)for(S=0;S<3;S++)o[O*3+S]>a[i]&&(a[i]=o[O*3+S])}else{r=0;var j=M.nr_of_sfb_block[v][r];for(O=0,i=0;i<4;i++)for(l=j[i],k=0;k<l;k++,O++)o[O]>a[i]&&(a[i]=o[O])}for(Y=!1,i=0;i<4;i++)a[i]>c[v][i]&&(Y=!0);if(!Y){var e0,f0,y0,p0;for(u.sfb_partition_table=M.nr_of_sfb_block[v][r],i=0;i<4;i++)u.slen[i]=_[a[i]];switch(e0=u.slen[0],f0=u.slen[1],y0=u.slen[2],p0=u.slen[3],v){case 0:u.scalefac_compress=(e0*5+f0<<4)+(y0<<2)+p0;break;case 1:u.scalefac_compress=400+(e0*5+f0<<2)+y0;break;case 2:u.scalefac_compress=500+e0*3+f0;break;default:cr.err.printf(`intensity stereo not implemented yet
`);break}}if(!Y)for(Dt(u.sfb_partition_table!=null),u.part2_length=0,i=0;i<4;i++)u.part2_length+=u.slen[i]*u.sfb_partition_table[i];return Y};var _=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4];this.huffman_init=function(n){for(var u=2;u<=576;u+=2){for(var v=0,r;n.scalefac_band.l[++v]<u;);for(r=K[v][0];n.scalefac_band.l[r+1]>u;)r--;for(r<0&&(r=K[v][0]),n.bv_scf[u-2]=r,r=K[v][1];n.scalefac_band.l[r+n.bv_scf[u-2]+2]>u;)r--;r<0&&(r=K[v][1]),n.bv_scf[u-1]=r}}}var Yt=Pt,b1=z.System,hr=z.Arrays,fr=z.new_byte,mr=z.new_float_n,pr=z.new_int,Be=z.assert;Lt.EQ=function(M,F){return Math.abs(M)>Math.abs(F)?Math.abs(M-F)<=Math.abs(M)*1e-6:Math.abs(M-F)<=Math.abs(F)*1e-6},Lt.NEQ=function(M,F){return!Lt.EQ(M,F)};function Lt(){var M=this,F=32773,K=null,q=null,o0=null,X=null;this.setModules=function(c,_,n,u){K=c,q=_,o0=n,X=u};var J=null,h0=0,m0=0,C=0;this.getframebits=function(c){var _=c.internal_flags,n;_.bitrate_index!=0?n=ae.bitrate_table[c.version][_.bitrate_index]:n=c.brate;var u=0|(c.version+1)*72e3*n/c.out_samplerate+_.padding;return 8*u};function s0(c){b1.arraycopy(c.header[c.w_ptr].buf,0,J,m0,c.sideinfo_len),m0+=c.sideinfo_len,h0+=c.sideinfo_len*8,c.w_ptr=c.w_ptr+1&de.MAX_HEADER_BUF-1}function b(c,_,n){for(;n>0;){var u;C==0&&(C=8,m0++,Be(c.header[c.w_ptr].write_timing>=h0),c.header[c.w_ptr].write_timing==h0&&s0(c),J[m0]=0),u=Math.min(n,C),n-=u,C-=u,J[m0]|=_>>n<<C,h0+=u}}function w(c,_,n){for(;n>0;){var u;C==0&&(C=8,m0++,J[m0]=0),u=Math.min(n,C),n-=u,C-=u,J[m0]|=_>>n<<C,h0+=u}}function B(c,_){var n=c.internal_flags,u;if(_>=8&&(b(n,76,8),_-=8),_>=8&&(b(n,65,8),_-=8),_>=8&&(b(n,77,8),_-=8),_>=8&&(b(n,69,8),_-=8),_>=32){var v=o0.getLameShortVersion();if(_>=32)for(u=0;u<v.length&&_>=8;++u)_-=8,b(n,v.charAt(u),8)}for(;_>=1;_-=1)b(n,n.ancillary_flag,1),n.ancillary_flag^=c.disable_reservoir?0:1}function e(c,_,n){for(var u=c.header[c.h_ptr].ptr;n>0;){var v=Math.min(n,8-(u&7));n-=v,c.header[c.h_ptr].buf[u>>3]|=_>>n<<8-(u&7)-v,u+=v}c.header[c.h_ptr].ptr=u}function L(c,_){c<<=8;for(var n=0;n<8;n++)c<<=1,_<<=1,(_^c)&65536&&(_^=F);return _}this.CRC_writeheader=function(c,_){var n=65535;n=L(_[2]&255,n),n=L(_[3]&255,n);for(var u=6;u<c.sideinfo_len;u++)n=L(_[u]&255,n);_[4]=byte(n>>8),_[5]=byte(n&255)};function I(c,_){var n=c.internal_flags,u,v,r;if(u=n.l3_side,n.header[n.h_ptr].ptr=0,hr.fill(n.header[n.h_ptr].buf,0,n.sideinfo_len,0),c.out_samplerate<16e3?e(n,4094,12):e(n,4095,12),e(n,c.version,1),e(n,4-3,2),e(n,c.error_protection?0:1,1),e(n,n.bitrate_index,4),e(n,n.samplerate_index,2),e(n,n.padding,1),e(n,c.extension,1),e(n,c.mode.ordinal(),2),e(n,n.mode_ext,2),e(n,c.copyright,1),e(n,c.original,1),e(n,c.emphasis,2),c.error_protection&&e(n,0,16),c.version==1){for(Be(u.main_data_begin>=0),e(n,u.main_data_begin,9),n.channels_out==2?e(n,u.private_bits,3):e(n,u.private_bits,5),r=0;r<n.channels_out;r++){var i;for(i=0;i<4;i++)e(n,u.scfsi[r][i],1)}for(v=0;v<2;v++)for(r=0;r<n.channels_out;r++){var l=u.tt[v][r];e(n,l.part2_3_length+l.part2_length,12),e(n,l.big_values/2,9),e(n,l.global_gain,8),e(n,l.scalefac_compress,4),l.block_type!=f.NORM_TYPE?(e(n,1,1),e(n,l.block_type,2),e(n,l.mixed_block_flag,1),l.table_select[0]==14&&(l.table_select[0]=16),e(n,l.table_select[0],5),l.table_select[1]==14&&(l.table_select[1]=16),e(n,l.table_select[1],5),e(n,l.subblock_gain[0],3),e(n,l.subblock_gain[1],3),e(n,l.subblock_gain[2],3)):(e(n,0,1),l.table_select[0]==14&&(l.table_select[0]=16),e(n,l.table_select[0],5),l.table_select[1]==14&&(l.table_select[1]=16),e(n,l.table_select[1],5),l.table_select[2]==14&&(l.table_select[2]=16),e(n,l.table_select[2],5),Be(0<=l.region0_count&&l.region0_count<16),Be(0<=l.region1_count&&l.region1_count<8),e(n,l.region0_count,4),e(n,l.region1_count,3)),e(n,l.preflag,1),e(n,l.scalefac_scale,1),e(n,l.count1table_select,1)}}else for(Be(u.main_data_begin>=0),e(n,u.main_data_begin,8),e(n,u.private_bits,n.channels_out),v=0,r=0;r<n.channels_out;r++){var l=u.tt[v][r];e(n,l.part2_3_length+l.part2_length,12),e(n,l.big_values/2,9),e(n,l.global_gain,8),e(n,l.scalefac_compress,9),l.block_type!=f.NORM_TYPE?(e(n,1,1),e(n,l.block_type,2),e(n,l.mixed_block_flag,1),l.table_select[0]==14&&(l.table_select[0]=16),e(n,l.table_select[0],5),l.table_select[1]==14&&(l.table_select[1]=16),e(n,l.table_select[1],5),e(n,l.subblock_gain[0],3),e(n,l.subblock_gain[1],3),e(n,l.subblock_gain[2],3)):(e(n,0,1),l.table_select[0]==14&&(l.table_select[0]=16),e(n,l.table_select[0],5),l.table_select[1]==14&&(l.table_select[1]=16),e(n,l.table_select[1],5),l.table_select[2]==14&&(l.table_select[2]=16),e(n,l.table_select[2],5),Be(0<=l.region0_count&&l.region0_count<16),Be(0<=l.region1_count&&l.region1_count<8),e(n,l.region0_count,4),e(n,l.region1_count,3)),e(n,l.scalefac_scale,1),e(n,l.count1table_select,1)}c.error_protection&&CRC_writeheader(n,n.header[n.h_ptr].buf);{var S=n.h_ptr;Be(n.header[S].ptr==n.sideinfo_len*8),n.h_ptr=S+1&de.MAX_HEADER_BUF-1,n.header[n.h_ptr].write_timing=n.header[S].write_timing+_,n.h_ptr==n.w_ptr&&b1.err.println(`Error: MAX_HEADER_BUF too small in bitstream.c 
`)}}function E(c,_){var n=ae.ht[_.count1table_select+32],u,v=0,r=_.big_values,i=_.big_values;for(Be(_.count1table_select<2),u=(_.count1-_.big_values)/4;u>0;--u){var l=0,S=0,Y;Y=_.l3_enc[r+0],Y!=0&&(S+=8,_.xr[i+0]<0&&l++),Y=_.l3_enc[r+1],Y!=0&&(S+=4,l*=2,_.xr[i+1]<0&&l++),Y=_.l3_enc[r+2],Y!=0&&(S+=2,l*=2,_.xr[i+2]<0&&l++),Y=_.l3_enc[r+3],Y!=0&&(S++,l*=2,_.xr[i+3]<0&&l++),r+=4,i+=4,b(c,l+n.table[S],n.hlen[S]),v+=n.hlen[S]}return v}function s(c,_,n,u,v){var r=ae.ht[_],i=0;if(_==0)return i;for(var l=n;l<u;l+=2){var S=0,Y=0,k=r.xlen,O=r.xlen,a=0,o=v.l3_enc[l],j=v.l3_enc[l+1];if(o!=0&&(v.xr[l]<0&&a++,S--),_>15){if(o>14){var e0=o-15;Be(e0<=r.linmax),a|=e0<<1,Y=k,o=15}if(j>14){var f0=j-15;Be(f0<=r.linmax),a<<=k,a|=f0,Y+=k,j=15}O=16}j!=0&&(a<<=1,v.xr[l+1]<0&&a++,S--),o=o*O+j,Y-=S,S+=r.hlen[o],b(c,r.table[o],S),b(c,a,Y),i+=S+Y}return i}function d(c,_){var n=3*c.scalefac_band.s[3];n>_.big_values&&(n=_.big_values);var u=s(c,_.table_select[0],0,n,_);return u+=s(c,_.table_select[1],n,_.big_values,_),u}function x(c,_){var n,u,v,r;n=_.big_values;var i=_.region0_count+1;return Be(i<c.scalefac_band.l.length),v=c.scalefac_band.l[i],i+=_.region1_count+1,Be(i<c.scalefac_band.l.length),r=c.scalefac_band.l[i],v>n&&(v=n),r>n&&(r=n),u=s(c,_.table_select[0],0,v,_),u+=s(c,_.table_select[1],v,r,_),u+=s(c,_.table_select[2],r,n,_),u}function y(c){var _,n,u,v,r=0,i=c.internal_flags,l=i.l3_side;if(c.version==1)for(_=0;_<2;_++)for(n=0;n<i.channels_out;n++){var S=l.tt[_][n],Y=Yt.slen1_tab[S.scalefac_compress],k=Yt.slen2_tab[S.scalefac_compress];for(v=0,u=0;u<S.sfbdivide;u++)S.scalefac[u]!=-1&&(b(i,S.scalefac[u],Y),v+=Y);for(;u<S.sfbmax;u++)S.scalefac[u]!=-1&&(b(i,S.scalefac[u],k),v+=k);Be(v==S.part2_length),S.block_type==f.SHORT_TYPE?v+=d(i,S):v+=x(i,S),v+=E(i,S),Be(v==S.part2_3_length+S.part2_length),r+=v}else for(_=0,n=0;n<i.channels_out;n++){var S=l.tt[_][n],O,a,o=0;if(Be(S.sfb_partition_table!=null),v=0,u=0,a=0,S.block_type==f.SHORT_TYPE){for(;a<4;a++){var j=S.sfb_partition_table[a]/3,e0=S.slen[a];for(O=0;O<j;O++,u++)b(i,Math.max(S.scalefac[u*3+0],0),e0),b(i,Math.max(S.scalefac[u*3+1],0),e0),b(i,Math.max(S.scalefac[u*3+2],0),e0),o+=3*e0}v+=d(i,S)}else{for(;a<4;a++){var j=S.sfb_partition_table[a],e0=S.slen[a];for(O=0;O<j;O++,u++)b(i,Math.max(S.scalefac[u],0),e0),o+=e0}v+=x(i,S)}v+=E(i,S),Be(v==S.part2_3_length),Be(o==S.part2_length),r+=o+v}return r}function R(){this.total=0}function t(c,_){var n=c.internal_flags,u,v,r,i,l;return l=n.w_ptr,i=n.h_ptr-1,i==-1&&(i=de.MAX_HEADER_BUF-1),u=n.header[i].write_timing-h0,_.total=u,u>=0&&(v=1+i-l,i<l&&(v=1+i-l+de.MAX_HEADER_BUF),u-=v*8*n.sideinfo_len),r=M.getframebits(c),u+=r,_.total+=r,_.total%8!=0?_.total=1+_.total/8:_.total=_.total/8,_.total+=m0+1,u<0&&b1.err.println(`strange error flushing buffer ... 
`),u}this.flush_bitstream=function(c){var _=c.internal_flags,n,u,v=_.h_ptr-1;if(v==-1&&(v=de.MAX_HEADER_BUF-1),n=_.l3_side,!((u=t(c,new R))<0)){if(B(c,u),Be(_.header[v].write_timing+this.getframebits(c)==h0),_.ResvSize=0,n.main_data_begin=0,_.findReplayGain){var r=K.GetTitleGain(_.rgdata);Be(NEQ(r,ft.GAIN_NOT_ENOUGH_SAMPLES)),_.RadioGain=Math.floor(r*10+.5)|0}_.findPeakSample&&(_.noclipGainChange=Math.ceil(Math.log10(_.PeakSample/32767)*20*10)|0,_.noclipGainChange>0&&(EQ(c.scale,1)||EQ(c.scale,0))?_.noclipScale=Math.floor(32767/_.PeakSample*100)/100:_.noclipScale=-1)}},this.add_dummy_byte=function(c,_,n){for(var u=c.internal_flags,v;n-- >0;)for(w(u,_,8),v=0;v<de.MAX_HEADER_BUF;++v)u.header[v].write_timing+=8},this.format_bitstream=function(c){var _=c.internal_flags,n;n=_.l3_side;var u=this.getframebits(c);B(c,n.resvDrain_pre),I(c,u);var v=8*_.sideinfo_len;if(v+=y(c),B(c,n.resvDrain_post),v+=n.resvDrain_post,n.main_data_begin+=(u-v)/8,t(c,new R)!=_.ResvSize&&b1.err.println("Internal buffer inconsistency. flushbits <> ResvSize"),n.main_data_begin*8!=_.ResvSize&&(b1.err.printf(`bit reservoir error: 
l3_side.main_data_begin: %d 
Resvoir size:             %d 
resv drain (post)         %d 
resv drain (pre)          %d 
header and sideinfo:      %d 
data bits:                %d 
total bits:               %d (remainder: %d) 
bitsperframe:             %d 
`,8*n.main_data_begin,_.ResvSize,n.resvDrain_post,n.resvDrain_pre,8*_.sideinfo_len,v-n.resvDrain_post-8*_.sideinfo_len,v,v%8,u),b1.err.println("This is a fatal error.  It has several possible causes:"),b1.err.println("90%%  LAME compiled with buggy version of gcc using advanced optimizations"),b1.err.println(" 9%%  Your system is overclocked"),b1.err.println(" 1%%  bug in LAME encoding library"),_.ResvSize=n.main_data_begin*8),h0>1e9){var r;for(r=0;r<de.MAX_HEADER_BUF;++r)_.header[r].write_timing-=h0;h0=0}return 0},this.copy_buffer=function(c,_,n,u,v){var r=m0+1;if(r<=0)return 0;if(u!=0&&r>u)return-1;if(b1.arraycopy(J,0,_,n,r),m0=-1,C=0,v!=0){var i=pr(1);if(i[0]=c.nMusicCRC,X.updateMusicCRC(i,_,n,r),c.nMusicCRC=i[0],r>0&&(c.VBR_seek_table.nBytesWritten+=r),c.decode_on_the_fly){for(var l=mr([2,1152]),S=r,Y=-1,k;Y!=0;)if(Y=q.hip_decode1_unclipped(c.hip,_,n,S,l[0],l[1]),S=0,Y==-1&&(Y=0),Y>0){if(c.findPeakSample){for(k=0;k<Y;k++)l[0][k]>c.PeakSample?c.PeakSample=l[0][k]:-l[0][k]>c.PeakSample&&(c.PeakSample=-l[0][k]);if(c.channels_out>1)for(k=0;k<Y;k++)l[1][k]>c.PeakSample?c.PeakSample=l[1][k]:-l[1][k]>c.PeakSample&&(c.PeakSample=-l[1][k])}if(c.findReplayGain&&K.AnalyzeSamples(c.rgdata,l[0],0,l[1],0,Y,c.channels_out)==ft.GAIN_ANALYSIS_ERROR)return-6}}}return r},this.init_bit_stream_w=function(c){J=fr(_e.LAME_MAXMP3BUFFER),c.h_ptr=c.w_ptr=0,c.header[c.h_ptr].write_timing=0,m0=-1,C=0,h0=0}}var L1=Lt,br=z.System,ue=z.VbrMode,jt=z.ShortBlock,P1=z.new_float,ma=z.new_int_n,xr=z.new_short_n,O1=z.assert;function Ee(){var M=this,F=128*1024;Ee.V9=410,Ee.V8=420,Ee.V7=430,Ee.V6=440,Ee.V5=450,Ee.V4=460,Ee.V3=470,Ee.V2=480,Ee.V1=490,Ee.V0=500,Ee.R3MIX=1e3,Ee.STANDARD=1001,Ee.EXTREME=1002,Ee.INSANE=1003,Ee.STANDARD_FAST=1004,Ee.EXTREME_FAST=1005,Ee.MEDIUM=1006,Ee.MEDIUM_FAST=1007;var K=16384+F;Ee.LAME_MAXMP3BUFFER=K;var q,o0,X,J,h0,m0=new W1,C,s0,b;this.enc=new f,this.setModules=function(a,o,j,e0,f0,y0,p0,w0,F0){q=a,o0=o,X=j,J=e0,h0=f0,C=y0,s0=w0,b=F0,this.enc.setModules(o0,m0,J,C)};function w(){this.mask_adjust=0,this.mask_adjust_short=0,this.bo_l_weight=P1(f.SBMAX_l),this.bo_s_weight=P1(f.SBMAX_s)}function B(){this.lowerlimit=0}function e(a,o){this.lowpass=o}var L=4294479419;function I(a){var o;return a.class_id=L,o=a.internal_flags=new de,a.mode=Te.NOT_SET,a.original=1,a.in_samplerate=44100,a.num_channels=2,a.num_samples=-1,a.bWriteVbrTag=!0,a.quality=-1,a.short_blocks=null,o.subblock_gain=-1,a.lowpassfreq=0,a.highpassfreq=0,a.lowpasswidth=-1,a.highpasswidth=-1,a.VBR=ue.vbr_off,a.VBR_q=4,a.ATHcurve=-1,a.VBR_mean_bitrate_kbps=128,a.VBR_min_bitrate_kbps=0,a.VBR_max_bitrate_kbps=0,a.VBR_hard_min=0,o.VBR_min_bitrate=1,o.VBR_max_bitrate=13,a.quant_comp=-1,a.quant_comp_short=-1,a.msfix=-1,o.resample_ratio=1,o.OldValue[0]=180,o.OldValue[1]=180,o.CurrentStep[0]=4,o.CurrentStep[1]=4,o.masking_lower=1,o.nsPsy.attackthre=-1,o.nsPsy.attackthre_s=-1,a.scale=-1,a.athaa_type=-1,a.ATHtype=-1,a.athaa_loudapprox=-1,a.athaa_sensitivity=0,a.useTemporal=null,a.interChRatio=-1,o.mf_samples_to_encode=f.ENCDELAY+f.POSTDELAY,a.encoder_padding=0,o.mf_size=f.ENCDELAY-f.MDCTDELAY,a.findReplayGain=!1,a.decode_on_the_fly=!1,o.decode_on_the_fly=!1,o.findReplayGain=!1,o.findPeakSample=!1,o.RadioGain=0,o.AudiophileGain=0,o.noclipGainChange=0,o.noclipScale=-1,a.preset=0,a.write_id3tag_automatic=!0,0}this.lame_init=function(){var a=new Bt;return I(a),a.lame_allocated_gfp=1,a};function E(a){return a>1?0:a<=0?1:Math.cos(Math.PI/2*a)}this.nearestBitrateFullIndex=function(a){var o=[8,16,24,32,40,48,56,64,80,96,112,128,160,192,224,256,320],j=0,e0=0,f0=0,y0=0;y0=o[16],f0=16,e0=o[16],j=16;for(var p0=0;p0<16;p0++)if(Math.max(a,o[p0+1])!=a){y0=o[p0+1],f0=p0+1,e0=o[p0],j=p0;break}return y0-a>a-e0?j:f0};function s(a,o){var j=44100;return o>=48e3?j=48e3:o>=44100?j=44100:o>=32e3?j=32e3:o>=24e3?j=24e3:o>=22050?j=22050:o>=16e3?j=16e3:o>=12e3?j=12e3:o>=11025?j=11025:o>=8e3&&(j=8e3),a==-1?j:(a<=15960&&(j=44100),a<=15250&&(j=32e3),a<=11220&&(j=24e3),a<=9970&&(j=22050),a<=7230&&(j=16e3),a<=5420&&(j=12e3),a<=4510&&(j=11025),a<=3970&&(j=8e3),o<j?o>44100?48e3:o>32e3?44100:o>24e3?32e3:o>22050?24e3:o>16e3?22050:o>12e3?16e3:o>11025?12e3:o>8e3?11025:8e3:j)}function d(a,o){switch(a){case 44100:return o.version=1,0;case 48e3:return o.version=1,1;case 32e3:return o.version=1,2;case 22050:return o.version=0,0;case 24e3:return o.version=0,1;case 16e3:return o.version=0,2;case 11025:return o.version=0,0;case 12e3:return o.version=0,1;case 8e3:return o.version=0,2;default:return o.version=0,-1}}function x(a,o,j){j<16e3&&(o=2);for(var e0=ae.bitrate_table[o][1],f0=2;f0<=14;f0++)ae.bitrate_table[o][f0]>0&&Math.abs(ae.bitrate_table[o][f0]-a)<Math.abs(e0-a)&&(e0=ae.bitrate_table[o][f0]);return e0}function y(a,o,j){j<16e3&&(o=2);for(var e0=0;e0<=14;e0++)if(ae.bitrate_table[o][e0]>0&&ae.bitrate_table[o][e0]==a)return e0;return-1}function R(a,o){var j=[new e(8,2e3),new e(16,3700),new e(24,3900),new e(32,5500),new e(40,7e3),new e(48,7500),new e(56,1e4),new e(64,11e3),new e(80,13500),new e(96,15100),new e(112,15600),new e(128,17e3),new e(160,17500),new e(192,18600),new e(224,19400),new e(256,19700),new e(320,20500)],e0=M.nearestBitrateFullIndex(o);a.lowerlimit=j[e0].lowpass}function t(a){var o=a.internal_flags,j=32,e0=-1;if(o.lowpass1>0){for(var f0=999,y0=0;y0<=31;y0++){var p0=y0/31;p0>=o.lowpass2&&(j=Math.min(j,y0)),o.lowpass1<p0&&p0<o.lowpass2&&(f0=Math.min(f0,y0))}f0==999?o.lowpass1=(j-.75)/31:o.lowpass1=(f0-.75)/31,o.lowpass2=j/31}if(o.highpass2>0&&o.highpass2<.9*(.75/31)&&(o.highpass1=0,o.highpass2=0,br.err.println(`Warning: highpass filter disabled.  highpass frequency too small
`)),o.highpass2>0){for(var w0=-1,y0=0;y0<=31;y0++){var p0=y0/31;p0<=o.highpass1&&(e0=Math.max(e0,y0)),o.highpass1<p0&&p0<o.highpass2&&(w0=Math.max(w0,y0))}o.highpass1=e0/31,w0==-1?o.highpass2=(e0+.75)/31:o.highpass2=(w0+.75)/31}for(var y0=0;y0<32;y0++){var F0,k0,p0=y0/31;o.highpass2>o.highpass1?F0=E((o.highpass2-p0)/(o.highpass2-o.highpass1+1e-20)):F0=1,o.lowpass2>o.lowpass1?k0=E((p0-o.lowpass1)/(o.lowpass2-o.lowpass1+1e-20)):k0=1,o.amp_filter[y0]=F0*k0}}function c(a){var o=a.internal_flags;switch(a.quality){default:case 9:o.psymodel=0,o.noise_shaping=0,o.noise_shaping_amp=0,o.noise_shaping_stop=0,o.use_best_huffman=0,o.full_outer_loop=0;break;case 8:a.quality=7;case 7:o.psymodel=1,o.noise_shaping=0,o.noise_shaping_amp=0,o.noise_shaping_stop=0,o.use_best_huffman=0,o.full_outer_loop=0;break;case 6:o.psymodel=1,o.noise_shaping==0&&(o.noise_shaping=1),o.noise_shaping_amp=0,o.noise_shaping_stop=0,o.subblock_gain==-1&&(o.subblock_gain=1),o.use_best_huffman=0,o.full_outer_loop=0;break;case 5:o.psymodel=1,o.noise_shaping==0&&(o.noise_shaping=1),o.noise_shaping_amp=0,o.noise_shaping_stop=0,o.subblock_gain==-1&&(o.subblock_gain=1),o.use_best_huffman=0,o.full_outer_loop=0;break;case 4:o.psymodel=1,o.noise_shaping==0&&(o.noise_shaping=1),o.noise_shaping_amp=0,o.noise_shaping_stop=0,o.subblock_gain==-1&&(o.subblock_gain=1),o.use_best_huffman=1,o.full_outer_loop=0;break;case 3:o.psymodel=1,o.noise_shaping==0&&(o.noise_shaping=1),o.noise_shaping_amp=1,o.noise_shaping_stop=1,o.subblock_gain==-1&&(o.subblock_gain=1),o.use_best_huffman=1,o.full_outer_loop=0;break;case 2:o.psymodel=1,o.noise_shaping==0&&(o.noise_shaping=1),o.substep_shaping==0&&(o.substep_shaping=2),o.noise_shaping_amp=1,o.noise_shaping_stop=1,o.subblock_gain==-1&&(o.subblock_gain=1),o.use_best_huffman=1,o.full_outer_loop=0;break;case 1:o.psymodel=1,o.noise_shaping==0&&(o.noise_shaping=1),o.substep_shaping==0&&(o.substep_shaping=2),o.noise_shaping_amp=2,o.noise_shaping_stop=1,o.subblock_gain==-1&&(o.subblock_gain=1),o.use_best_huffman=1,o.full_outer_loop=0;break;case 0:o.psymodel=1,o.noise_shaping==0&&(o.noise_shaping=1),o.substep_shaping==0&&(o.substep_shaping=2),o.noise_shaping_amp=2,o.noise_shaping_stop=1,o.subblock_gain==-1&&(o.subblock_gain=1),o.use_best_huffman=1,o.full_outer_loop=0;break}}function _(a){var o=a.internal_flags;a.frameNum=0,a.write_id3tag_automatic&&s0.id3tag_write_v2(a),o.bitrate_stereoMode_Hist=ma([16,4+1]),o.bitrate_blockType_Hist=ma([16,4+1+1]),o.PeakSample=0,a.bWriteVbrTag&&C.InitVbrTag(a)}this.lame_init_params=function(a){var o=a.internal_flags;if(o.Class_ID=0,o.ATH==null&&(o.ATH=new sr),o.PSY==null&&(o.PSY=new w),o.rgdata==null&&(o.rgdata=new ir),o.channels_in=a.num_channels,o.channels_in==1&&(a.mode=Te.MONO),o.channels_out=a.mode==Te.MONO?1:2,o.mode_ext=f.MPG_MD_MS_LR,a.mode==Te.MONO&&(a.force_ms=!1),a.VBR==ue.vbr_off&&a.VBR_mean_bitrate_kbps!=128&&a.brate==0&&(a.brate=a.VBR_mean_bitrate_kbps),a.VBR==ue.vbr_off||a.VBR==ue.vbr_mtrh||a.VBR==ue.vbr_mt||(a.free_format=!1),a.VBR==ue.vbr_off&&a.brate==0&&L1.EQ(a.compression_ratio,0)&&(a.compression_ratio=11.025),a.VBR==ue.vbr_off&&a.compression_ratio>0&&(a.out_samplerate==0&&(a.out_samplerate=map2MP3Frequency(int(.97*a.in_samplerate))),a.brate=0|a.out_samplerate*16*o.channels_out/(1e3*a.compression_ratio),o.samplerate_index=d(a.out_samplerate,a),a.free_format||(a.brate=x(a.brate,a.version,a.out_samplerate))),a.out_samplerate!=0&&(a.out_samplerate<16e3?(a.VBR_mean_bitrate_kbps=Math.max(a.VBR_mean_bitrate_kbps,8),a.VBR_mean_bitrate_kbps=Math.min(a.VBR_mean_bitrate_kbps,64)):a.out_samplerate<32e3?(a.VBR_mean_bitrate_kbps=Math.max(a.VBR_mean_bitrate_kbps,8),a.VBR_mean_bitrate_kbps=Math.min(a.VBR_mean_bitrate_kbps,160)):(a.VBR_mean_bitrate_kbps=Math.max(a.VBR_mean_bitrate_kbps,32),a.VBR_mean_bitrate_kbps=Math.min(a.VBR_mean_bitrate_kbps,320))),a.lowpassfreq==0){var j=16e3;switch(a.VBR){case ue.vbr_off:{var e0=new B;R(e0,a.brate),j=e0.lowerlimit;break}case ue.vbr_abr:{var e0=new B;R(e0,a.VBR_mean_bitrate_kbps),j=e0.lowerlimit;break}case ue.vbr_rh:{var f0=[19500,19e3,18600,18e3,17500,16e3,15600,14900,12500,1e4,3950];if(0<=a.VBR_q&&a.VBR_q<=9){var y0=f0[a.VBR_q],p0=f0[a.VBR_q+1],w0=a.VBR_q_frac;j=linear_int(y0,p0,w0)}else j=19500;break}default:{var f0=[19500,19e3,18500,18e3,17500,16500,15500,14500,12500,9500,3950];if(0<=a.VBR_q&&a.VBR_q<=9){var y0=f0[a.VBR_q],p0=f0[a.VBR_q+1],w0=a.VBR_q_frac;j=linear_int(y0,p0,w0)}else j=19500}}a.mode==Te.MONO&&(a.VBR==ue.vbr_off||a.VBR==ue.vbr_abr)&&(j*=1.5),a.lowpassfreq=j|0}if(a.out_samplerate==0&&(2*a.lowpassfreq>a.in_samplerate&&(a.lowpassfreq=a.in_samplerate/2),a.out_samplerate=s(a.lowpassfreq|0,a.in_samplerate)),a.lowpassfreq=Math.min(20500,a.lowpassfreq),a.lowpassfreq=Math.min(a.out_samplerate/2,a.lowpassfreq),a.VBR==ue.vbr_off&&(a.compression_ratio=a.out_samplerate*16*o.channels_out/(1e3*a.brate)),a.VBR==ue.vbr_abr&&(a.compression_ratio=a.out_samplerate*16*o.channels_out/(1e3*a.VBR_mean_bitrate_kbps)),a.bWriteVbrTag||(a.findReplayGain=!1,a.decode_on_the_fly=!1,o.findPeakSample=!1),o.findReplayGain=a.findReplayGain,o.decode_on_the_fly=a.decode_on_the_fly,o.decode_on_the_fly&&(o.findPeakSample=!0),o.findReplayGain&&q.InitGainAnalysis(o.rgdata,a.out_samplerate)==ft.INIT_GAIN_ANALYSIS_ERROR)return a.internal_flags=null,-6;switch(o.decode_on_the_fly&&!a.decode_only&&(o.hip!=null&&b.hip_decode_exit(o.hip),o.hip=b.hip_decode_init()),o.mode_gr=a.out_samplerate<=24e3?1:2,a.framesize=576*o.mode_gr,a.encoder_delay=f.ENCDELAY,o.resample_ratio=a.in_samplerate/a.out_samplerate,a.VBR){case ue.vbr_mt:case ue.vbr_rh:case ue.vbr_mtrh:{var F0=[5.7,6.5,7.3,8.2,10,11.9,13,14,15,16.5];a.compression_ratio=F0[a.VBR_q]}break;case ue.vbr_abr:a.compression_ratio=a.out_samplerate*16*o.channels_out/(1e3*a.VBR_mean_bitrate_kbps);break;default:a.compression_ratio=a.out_samplerate*16*o.channels_out/(1e3*a.brate);break}if(a.mode==Te.NOT_SET&&(a.mode=Te.JOINT_STEREO),a.highpassfreq>0?(o.highpass1=2*a.highpassfreq,a.highpasswidth>=0?o.highpass2=2*(a.highpassfreq+a.highpasswidth):o.highpass2=(1+0)*2*a.highpassfreq,o.highpass1/=a.out_samplerate,o.highpass2/=a.out_samplerate):(o.highpass1=0,o.highpass2=0),a.lowpassfreq>0?(o.lowpass2=2*a.lowpassfreq,a.lowpasswidth>=0?(o.lowpass1=2*(a.lowpassfreq-a.lowpasswidth),o.lowpass1<0&&(o.lowpass1=0)):o.lowpass1=(1-0)*2*a.lowpassfreq,o.lowpass1/=a.out_samplerate,o.lowpass2/=a.out_samplerate):(o.lowpass1=0,o.lowpass2=0),t(a),o.samplerate_index=d(a.out_samplerate,a),o.samplerate_index<0)return a.internal_flags=null,-1;if(a.VBR==ue.vbr_off){if(a.free_format)o.bitrate_index=0;else if(a.brate=x(a.brate,a.version,a.out_samplerate),o.bitrate_index=y(a.brate,a.version,a.out_samplerate),o.bitrate_index<=0)return a.internal_flags=null,-1}else o.bitrate_index=1;a.analysis&&(a.bWriteVbrTag=!1),o.pinfo!=null&&(a.bWriteVbrTag=!1),o0.init_bit_stream_w(o);for(var k0=o.samplerate_index+3*a.version+6*(a.out_samplerate<16e3?1:0),b0=0;b0<f.SBMAX_l+1;b0++)o.scalefac_band.l[b0]=J.sfBandIndex[k0].l[b0];for(var b0=0;b0<f.PSFB21+1;b0++){var ne=(o.scalefac_band.l[22]-o.scalefac_band.l[21])/f.PSFB21,ke=o.scalefac_band.l[21]+b0*ne;o.scalefac_band.psfb21[b0]=ke}o.scalefac_band.psfb21[f.PSFB21]=576;for(var b0=0;b0<f.SBMAX_s+1;b0++)o.scalefac_band.s[b0]=J.sfBandIndex[k0].s[b0];for(var b0=0;b0<f.PSFB12+1;b0++){var ne=(o.scalefac_band.s[13]-o.scalefac_band.s[12])/f.PSFB12,ke=o.scalefac_band.s[12]+b0*ne;o.scalefac_band.psfb12[b0]=ke}o.scalefac_band.psfb12[f.PSFB12]=192,a.version==1?o.sideinfo_len=o.channels_out==1?4+17:4+32:o.sideinfo_len=o.channels_out==1?4+9:4+17,a.error_protection&&(o.sideinfo_len+=2),_(a),o.Class_ID=L;{var te;for(te=0;te<19;te++)o.nsPsy.pefirbuf[te]=700*o.mode_gr*o.channels_out;a.ATHtype==-1&&(a.ATHtype=4)}switch(O1(a.VBR_q<=9),O1(a.VBR_q>=0),a.VBR){case ue.vbr_mt:a.VBR=ue.vbr_mtrh;case ue.vbr_mtrh:{a.useTemporal==null&&(a.useTemporal=!1),X.apply_preset(a,500-a.VBR_q*10,0),a.quality<0&&(a.quality=LAME_DEFAULT_QUALITY),a.quality<5&&(a.quality=0),a.quality>5&&(a.quality=5),o.PSY.mask_adjust=a.maskingadjust,o.PSY.mask_adjust_short=a.maskingadjust_short,a.experimentalY?o.sfb21_extra=!1:o.sfb21_extra=a.out_samplerate>44e3,o.iteration_loop=new VBRNewIterationLoop(h0);break}case ue.vbr_rh:{X.apply_preset(a,500-a.VBR_q*10,0),o.PSY.mask_adjust=a.maskingadjust,o.PSY.mask_adjust_short=a.maskingadjust_short,a.experimentalY?o.sfb21_extra=!1:o.sfb21_extra=a.out_samplerate>44e3,a.quality>6&&(a.quality=6),a.quality<0&&(a.quality=LAME_DEFAULT_QUALITY),o.iteration_loop=new VBROldIterationLoop(h0);break}default:{var he;o.sfb21_extra=!1,a.quality<0&&(a.quality=LAME_DEFAULT_QUALITY),he=a.VBR,he==ue.vbr_off&&(a.VBR_mean_bitrate_kbps=a.brate),X.apply_preset(a,a.VBR_mean_bitrate_kbps,0),a.VBR=he,o.PSY.mask_adjust=a.maskingadjust,o.PSY.mask_adjust_short=a.maskingadjust_short,he==ue.vbr_off?o.iteration_loop=new ur(h0):o.iteration_loop=new ABRIterationLoop(h0);break}}if(O1(a.scale>=0),a.VBR!=ue.vbr_off){if(o.VBR_min_bitrate=1,o.VBR_max_bitrate=14,a.out_samplerate<16e3&&(o.VBR_max_bitrate=8),a.VBR_min_bitrate_kbps!=0&&(a.VBR_min_bitrate_kbps=x(a.VBR_min_bitrate_kbps,a.version,a.out_samplerate),o.VBR_min_bitrate=y(a.VBR_min_bitrate_kbps,a.version,a.out_samplerate),o.VBR_min_bitrate<0)||a.VBR_max_bitrate_kbps!=0&&(a.VBR_max_bitrate_kbps=x(a.VBR_max_bitrate_kbps,a.version,a.out_samplerate),o.VBR_max_bitrate=y(a.VBR_max_bitrate_kbps,a.version,a.out_samplerate),o.VBR_max_bitrate<0))return-1;a.VBR_min_bitrate_kbps=ae.bitrate_table[a.version][o.VBR_min_bitrate],a.VBR_max_bitrate_kbps=ae.bitrate_table[a.version][o.VBR_max_bitrate],a.VBR_mean_bitrate_kbps=Math.min(ae.bitrate_table[a.version][o.VBR_max_bitrate],a.VBR_mean_bitrate_kbps),a.VBR_mean_bitrate_kbps=Math.max(ae.bitrate_table[a.version][o.VBR_min_bitrate],a.VBR_mean_bitrate_kbps)}return a.tune&&(o.PSY.mask_adjust+=a.tune_value_a,o.PSY.mask_adjust_short+=a.tune_value_a),c(a),O1(a.scale>=0),a.athaa_type<0?o.ATH.useAdjust=3:o.ATH.useAdjust=a.athaa_type,o.ATH.aaSensitivityP=Math.pow(10,a.athaa_sensitivity/-10),a.short_blocks==null&&(a.short_blocks=jt.short_block_allowed),a.short_blocks==jt.short_block_allowed&&(a.mode==Te.JOINT_STEREO||a.mode==Te.STEREO)&&(a.short_blocks=jt.short_block_coupled),a.quant_comp<0&&(a.quant_comp=1),a.quant_comp_short<0&&(a.quant_comp_short=0),a.msfix<0&&(a.msfix=0),a.exp_nspsytune=a.exp_nspsytune|1,a.internal_flags.nsPsy.attackthre<0&&(a.internal_flags.nsPsy.attackthre=W1.NSATTACKTHRE),a.internal_flags.nsPsy.attackthre_s<0&&(a.internal_flags.nsPsy.attackthre_s=W1.NSATTACKTHRE_S),O1(a.scale>=0),a.scale<0&&(a.scale=1),a.ATHtype<0&&(a.ATHtype=4),a.ATHcurve<0&&(a.ATHcurve=4),a.athaa_loudapprox<0&&(a.athaa_loudapprox=2),a.interChRatio<0&&(a.interChRatio=0),a.useTemporal==null&&(a.useTemporal=!0),o.slot_lag=o.frac_SpF=0,a.VBR==ue.vbr_off&&(o.slot_lag=o.frac_SpF=(a.version+1)*72e3*a.brate%a.out_samplerate|0),J.iteration_init(a),m0.psymodel_init(a),O1(a.scale>=0),0};function n(a,o){(a.in_buffer_0==null||a.in_buffer_nsamples<o)&&(a.in_buffer_0=P1(o),a.in_buffer_1=P1(o),a.in_buffer_nsamples=o)}this.lame_encode_flush=function(a,o,j,e0){var f0=a.internal_flags,y0=xr([2,1152]),p0=0,w0,F0,k0,b0,ne=f0.mf_samples_to_encode-f.POSTDELAY,ke=u(a);if(f0.mf_samples_to_encode<1)return 0;for(w0=0,a.in_samplerate!=a.out_samplerate&&(ne+=16*a.out_samplerate/a.in_samplerate),k0=a.framesize-ne%a.framesize,k0<576&&(k0+=a.framesize),a.encoder_padding=k0,b0=(ne+k0)/a.framesize;b0>0&&p0>=0;){var te=ke-f0.mf_size,he=a.frameNum;te*=a.in_samplerate,te/=a.out_samplerate,te>1152&&(te=1152),te<1&&(te=1),F0=e0-w0,e0==0&&(F0=0),p0=this.lame_encode_buffer(a,y0[0],y0[1],te,o,j,F0),j+=p0,w0+=p0,b0-=he!=a.frameNum?1:0}if(f0.mf_samples_to_encode=0,p0<0||(F0=e0-w0,e0==0&&(F0=0),o0.flush_bitstream(a),p0=o0.copy_buffer(f0,o,j,F0,1),p0<0))return p0;if(j+=p0,w0+=p0,F0=e0-w0,e0==0&&(F0=0),a.write_id3tag_automatic){if(s0.id3tag_write_v1(a),p0=o0.copy_buffer(f0,o,j,F0,0),p0<0)return p0;w0+=p0}return w0},this.lame_encode_buffer=function(a,o,j,e0,f0,y0,p0){var w0=a.internal_flags,F0=[null,null];if(w0.Class_ID!=L)return-3;if(e0==0)return 0;n(w0,e0),F0[0]=w0.in_buffer_0,F0[1]=w0.in_buffer_1;for(var k0=0;k0<e0;k0++)F0[0][k0]=o[k0],w0.channels_in>1&&(F0[1][k0]=j[k0]);return v(a,F0[0],F0[1],e0,f0,y0,p0)};function u(a){var o=f.BLKSIZE+a.framesize-f.FFTOFFSET;return o=Math.max(o,512+a.framesize-32),o}function v(a,o,j,e0,f0,y0,p0){var w0=a.internal_flags,F0=0,k0,b0,ne,ke,te,he=[null,null],fe=[null,null];if(w0.Class_ID!=L)return-3;if(e0==0)return 0;if(te=o0.copy_buffer(w0,f0,y0,p0,0),te<0)return te;if(y0+=te,F0+=te,fe[0]=o,fe[1]=j,L1.NEQ(a.scale,0)&&L1.NEQ(a.scale,1))for(b0=0;b0<e0;++b0)fe[0][b0]*=a.scale,w0.channels_out==2&&(fe[1][b0]*=a.scale);if(L1.NEQ(a.scale_left,0)&&L1.NEQ(a.scale_left,1))for(b0=0;b0<e0;++b0)fe[0][b0]*=a.scale_left;if(L1.NEQ(a.scale_right,0)&&L1.NEQ(a.scale_right,1))for(b0=0;b0<e0;++b0)fe[1][b0]*=a.scale_right;if(a.num_channels==2&&w0.channels_out==1)for(b0=0;b0<e0;++b0)fe[0][b0]=.5*(fe[0][b0]+fe[1][b0]),fe[1][b0]=0;ke=u(a),he[0]=w0.mfbuf[0],he[1]=w0.mfbuf[1];for(var Me=0;e0>0;){var Ie=[null,null],w1=0,e1=0;Ie[0]=fe[0],Ie[1]=fe[1];var Ze=new i;if(O(a,he,Ie,Me,e0,Ze),w1=Ze.n_in,e1=Ze.n_out,w0.findReplayGain&&!w0.decode_on_the_fly&&q.AnalyzeSamples(w0.rgdata,he[0],w0.mf_size,he[1],w0.mf_size,e1,w0.channels_out)==ft.GAIN_ANALYSIS_ERROR)return-6;if(e0-=w1,Me+=w1,w0.channels_out==2,w0.mf_size+=e1,O1(w0.mf_size<=de.MFSIZE),w0.mf_samples_to_encode<1&&(w0.mf_samples_to_encode=f.ENCDELAY+f.POSTDELAY),w0.mf_samples_to_encode+=e1,w0.mf_size>=ke){var o1=p0-F0;if(p0==0&&(o1=0),k0=r(a,he[0],he[1],f0,y0,o1),k0<0)return k0;for(y0+=k0,F0+=k0,w0.mf_size-=a.framesize,w0.mf_samples_to_encode-=a.framesize,ne=0;ne<w0.channels_out;ne++)for(b0=0;b0<w0.mf_size;b0++)he[ne][b0]=he[ne][b0+a.framesize]}}return F0}function r(a,o,j,e0,f0,y0){var p0=M.enc.lame_encode_mp3_frame(a,o,j,e0,f0,y0);return a.frameNum++,p0}function i(){this.n_in=0,this.n_out=0}function l(){this.num_used=0}function S(a,o){return o!=0?S(o,a%o):a}function Y(a,o,j){var e0=Math.PI*o;a/=j,a<0&&(a=0),a>1&&(a=1);var f0=a-.5,y0=.42-.5*Math.cos(2*a*Math.PI)+.08*Math.cos(4*a*Math.PI);return Math.abs(f0)<1e-9?e0/Math.PI:y0*Math.sin(j*e0*f0)/(Math.PI*j*f0)}function k(a,o,j,e0,f0,y0,p0,w0,F0){var k0=a.internal_flags,b0,ne=0,ke,te=a.out_samplerate/S(a.out_samplerate,a.in_samplerate);te>de.BPC&&(te=de.BPC);var he=Math.abs(k0.resample_ratio-Math.floor(.5+k0.resample_ratio))<1e-4?1:0,fe=1/k0.resample_ratio;fe>1&&(fe=1);var Me=31;Me%2==0&&--Me,Me+=he;var Ie=Me+1;if(k0.fill_buffer_resample_init==0){for(k0.inbuf_old[0]=P1(Ie),k0.inbuf_old[1]=P1(Ie),b0=0;b0<=2*te;++b0)k0.blackfilt[b0]=P1(Ie);for(k0.itime[0]=0,k0.itime[1]=0,ne=0;ne<=2*te;ne++){var w1=0,e1=(ne-te)/(2*te);for(b0=0;b0<=Me;b0++)w1+=k0.blackfilt[ne][b0]=Y(b0-e1,fe,Me);for(b0=0;b0<=Me;b0++)k0.blackfilt[ne][b0]/=w1}k0.fill_buffer_resample_init=1}var Ze=k0.inbuf_old[F0];for(ke=0;ke<e0;ke++){var o1,Y1;if(o1=ke*k0.resample_ratio,ne=0|Math.floor(o1-k0.itime[F0]),Me+ne-Me/2>=p0)break;var e1=o1-k0.itime[F0]-(ne+.5*(Me%2));Y1=0|Math.floor(e1*2*te+te+.5);var V1=0;for(b0=0;b0<=Me;++b0){var je=b0+ne-Me/2,j1;j1=je<0?Ze[Ie+je]:f0[y0+je],V1+=j1*k0.blackfilt[Y1][b0]}o[j+ke]=V1}if(w0.num_used=Math.min(p0,Me+ne-Me/2),k0.itime[F0]+=w0.num_used-ke*k0.resample_ratio,w0.num_used>=Ie)for(b0=0;b0<Ie;b0++)Ze[b0]=f0[y0+w0.num_used+b0-Ie];else{var T1=Ie-w0.num_used;for(b0=0;b0<T1;++b0)Ze[b0]=Ze[b0+w0.num_used];for(ne=0;b0<Ie;++b0,++ne)Ze[b0]=f0[y0+ne];O1(ne==w0.num_used)}return ke}function O(a,o,j,e0,f0,y0){var p0=a.internal_flags;if(p0.resample_ratio<.9999||p0.resample_ratio>1.0001)for(var w0=0;w0<p0.channels_out;w0++){var F0=new l;y0.n_out=k(a,o[w0],p0.mf_size,a.framesize,j[w0],e0,f0,F0,w0),y0.n_in=F0.num_used}else{y0.n_out=Math.min(a.framesize,f0),y0.n_in=y0.n_out;for(var k0=0;k0<y0.n_out;++k0)o[0][p0.mf_size+k0]=j[0][e0+k0],p0.channels_out==2&&(o[1][p0.mf_size+k0]=j[1][e0+k0])}}}var wr=Ee,x1=z.VbrMode;function yr(){function M(C,s0,b,w,B,e,L,I,E,s,d,x,y,R,t){this.vbr_q=C,this.quant_comp=s0,this.quant_comp_s=b,this.expY=w,this.st_lrm=B,this.st_s=e,this.masking_adj=L,this.masking_adj_short=I,this.ath_lower=E,this.ath_curve=s,this.ath_sensitivity=d,this.interch=x,this.safejoint=y,this.sfb21mod=R,this.msfix=t}function F(C,s0,b,w,B,e,L,I,E,s,d,x,y,R){this.quant_comp=s0,this.quant_comp_s=b,this.safejoint=w,this.nsmsfix=B,this.st_lrm=e,this.st_s=L,this.nsbass=I,this.scale=E,this.masking_adj=s,this.ath_lower=d,this.ath_curve=x,this.interch=y,this.sfscale=R}var K;this.setModules=function(C){K=C};var q=[new M(0,9,9,0,5.2,125,-4.2,-6.3,4.8,1,0,0,2,21,.97),new M(1,9,9,0,5.3,125,-3.6,-5.6,4.5,1.5,0,0,2,21,1.35),new M(2,9,9,0,5.6,125,-2.2,-3.5,2.8,2,0,0,2,21,1.49),new M(3,9,9,1,5.8,130,-1.8,-2.8,2.6,3,-4,0,2,20,1.64),new M(4,9,9,1,6,135,-.7,-1.1,1.1,3.5,-8,0,2,0,1.79),new M(5,9,9,1,6.4,140,.5,.4,-7.5,4,-12,2e-4,0,0,1.95),new M(6,9,9,1,6.6,145,.67,.65,-14.7,6.5,-19,4e-4,0,0,2.3),new M(7,9,9,1,6.6,145,.8,.75,-19.7,8,-22,6e-4,0,0,2.7),new M(8,9,9,1,6.6,145,1.2,1.15,-27.5,10,-23,7e-4,0,0,0),new M(9,9,9,1,6.6,145,1.6,1.6,-36,11,-25,8e-4,0,0,0),new M(10,9,9,1,6.6,145,2,2,-36,12,-25,8e-4,0,0,0)],o0=[new M(0,9,9,0,4.2,25,-7,-4,7.5,1,0,0,2,26,.97),new M(1,9,9,0,4.2,25,-5.6,-3.6,4.5,1.5,0,0,2,21,1.35),new M(2,9,9,0,4.2,25,-4.4,-1.8,2,2,0,0,2,18,1.49),new M(3,9,9,1,4.2,25,-3.4,-1.25,1.1,3,-4,0,2,15,1.64),new M(4,9,9,1,4.2,25,-2.2,.1,0,3.5,-8,0,2,0,1.79),new M(5,9,9,1,4.2,25,-1,1.65,-7.7,4,-12,2e-4,0,0,1.95),new M(6,9,9,1,4.2,25,-0,2.47,-7.7,6.5,-19,4e-4,0,0,2),new M(7,9,9,1,4.2,25,.5,2,-14.5,8,-22,6e-4,0,0,2),new M(8,9,9,1,4.2,25,1,2.4,-22,10,-23,7e-4,0,0,2),new M(9,9,9,1,4.2,25,1.5,2.95,-30,11,-25,8e-4,0,0,2),new M(10,9,9,1,4.2,25,2,2.95,-36,12,-30,8e-4,0,0,2)];function X(C,s0,b){var w=C.VBR==x1.vbr_rh?q:o0,B=C.VBR_q_frac,e=w[s0],L=w[s0+1],I=e;e.st_lrm=e.st_lrm+B*(L.st_lrm-e.st_lrm),e.st_s=e.st_s+B*(L.st_s-e.st_s),e.masking_adj=e.masking_adj+B*(L.masking_adj-e.masking_adj),e.masking_adj_short=e.masking_adj_short+B*(L.masking_adj_short-e.masking_adj_short),e.ath_lower=e.ath_lower+B*(L.ath_lower-e.ath_lower),e.ath_curve=e.ath_curve+B*(L.ath_curve-e.ath_curve),e.ath_sensitivity=e.ath_sensitivity+B*(L.ath_sensitivity-e.ath_sensitivity),e.interch=e.interch+B*(L.interch-e.interch),e.msfix=e.msfix+B*(L.msfix-e.msfix),m0(C,I.vbr_q),b!=0?C.quant_comp=I.quant_comp:Math.abs(C.quant_comp- -1)>0||(C.quant_comp=I.quant_comp),b!=0?C.quant_comp_short=I.quant_comp_s:Math.abs(C.quant_comp_short- -1)>0||(C.quant_comp_short=I.quant_comp_s),I.expY!=0&&(C.experimentalY=I.expY!=0),b!=0?C.internal_flags.nsPsy.attackthre=I.st_lrm:Math.abs(C.internal_flags.nsPsy.attackthre- -1)>0||(C.internal_flags.nsPsy.attackthre=I.st_lrm),b!=0?C.internal_flags.nsPsy.attackthre_s=I.st_s:Math.abs(C.internal_flags.nsPsy.attackthre_s- -1)>0||(C.internal_flags.nsPsy.attackthre_s=I.st_s),b!=0?C.maskingadjust=I.masking_adj:Math.abs(C.maskingadjust-0)>0||(C.maskingadjust=I.masking_adj),b!=0?C.maskingadjust_short=I.masking_adj_short:Math.abs(C.maskingadjust_short-0)>0||(C.maskingadjust_short=I.masking_adj_short),b!=0?C.ATHlower=-I.ath_lower/10:Math.abs(-C.ATHlower*10-0)>0||(C.ATHlower=-I.ath_lower/10),b!=0?C.ATHcurve=I.ath_curve:Math.abs(C.ATHcurve- -1)>0||(C.ATHcurve=I.ath_curve),b!=0?C.athaa_sensitivity=I.ath_sensitivity:Math.abs(C.athaa_sensitivity- -1)>0||(C.athaa_sensitivity=I.ath_sensitivity),I.interch>0&&(b!=0?C.interChRatio=I.interch:Math.abs(C.interChRatio- -1)>0||(C.interChRatio=I.interch)),I.safejoint>0&&(C.exp_nspsytune=C.exp_nspsytune|I.safejoint),I.sfb21mod>0&&(C.exp_nspsytune=C.exp_nspsytune|I.sfb21mod<<20),b!=0?C.msfix=I.msfix:Math.abs(C.msfix- -1)>0||(C.msfix=I.msfix),b==0&&(C.VBR_q=s0,C.VBR_q_frac=B)}var J=[new F(8,9,9,0,0,6.6,145,0,.95,0,-30,11,.0012,1),new F(16,9,9,0,0,6.6,145,0,.95,0,-25,11,.001,1),new F(24,9,9,0,0,6.6,145,0,.95,0,-20,11,.001,1),new F(32,9,9,0,0,6.6,145,0,.95,0,-15,11,.001,1),new F(40,9,9,0,0,6.6,145,0,.95,0,-10,11,9e-4,1),new F(48,9,9,0,0,6.6,145,0,.95,0,-10,11,9e-4,1),new F(56,9,9,0,0,6.6,145,0,.95,0,-6,11,8e-4,1),new F(64,9,9,0,0,6.6,145,0,.95,0,-2,11,8e-4,1),new F(80,9,9,0,0,6.6,145,0,.95,0,0,8,7e-4,1),new F(96,9,9,0,2.5,6.6,145,0,.95,0,1,5.5,6e-4,1),new F(112,9,9,0,2.25,6.6,145,0,.95,0,2,4.5,5e-4,1),new F(128,9,9,0,1.95,6.4,140,0,.95,0,3,4,2e-4,1),new F(160,9,9,1,1.79,6,135,0,.95,-2,5,3.5,0,1),new F(192,9,9,1,1.49,5.6,125,0,.97,-4,7,3,0,0),new F(224,9,9,1,1.25,5.2,125,0,.98,-6,9,2,0,0),new F(256,9,9,1,.97,5.2,125,0,1,-8,10,1,0,0),new F(320,9,9,1,.9,5.2,125,0,1,-10,12,0,0,0)];function h0(C,s0,b){var w=s0,B=K.nearestBitrateFullIndex(s0);if(C.VBR=x1.vbr_abr,C.VBR_mean_bitrate_kbps=w,C.VBR_mean_bitrate_kbps=Math.min(C.VBR_mean_bitrate_kbps,320),C.VBR_mean_bitrate_kbps=Math.max(C.VBR_mean_bitrate_kbps,8),C.brate=C.VBR_mean_bitrate_kbps,C.VBR_mean_bitrate_kbps>320&&(C.disable_reservoir=!0),J[B].safejoint>0&&(C.exp_nspsytune=C.exp_nspsytune|2),J[B].sfscale>0&&(C.internal_flags.noise_shaping=2),Math.abs(J[B].nsbass)>0){var e=int(J[B].nsbass*4);e<0&&(e+=64),C.exp_nspsytune=C.exp_nspsytune|e<<2}return b!=0?C.quant_comp=J[B].quant_comp:Math.abs(C.quant_comp- -1)>0||(C.quant_comp=J[B].quant_comp),b!=0?C.quant_comp_short=J[B].quant_comp_s:Math.abs(C.quant_comp_short- -1)>0||(C.quant_comp_short=J[B].quant_comp_s),b!=0?C.msfix=J[B].nsmsfix:Math.abs(C.msfix- -1)>0||(C.msfix=J[B].nsmsfix),b!=0?C.internal_flags.nsPsy.attackthre=J[B].st_lrm:Math.abs(C.internal_flags.nsPsy.attackthre- -1)>0||(C.internal_flags.nsPsy.attackthre=J[B].st_lrm),b!=0?C.internal_flags.nsPsy.attackthre_s=J[B].st_s:Math.abs(C.internal_flags.nsPsy.attackthre_s- -1)>0||(C.internal_flags.nsPsy.attackthre_s=J[B].st_s),b!=0?C.scale=J[B].scale:Math.abs(C.scale- -1)>0||(C.scale=J[B].scale),b!=0?C.maskingadjust=J[B].masking_adj:Math.abs(C.maskingadjust-0)>0||(C.maskingadjust=J[B].masking_adj),J[B].masking_adj>0?b!=0?C.maskingadjust_short=J[B].masking_adj*.9:Math.abs(C.maskingadjust_short-0)>0||(C.maskingadjust_short=J[B].masking_adj*.9):b!=0?C.maskingadjust_short=J[B].masking_adj*1.1:Math.abs(C.maskingadjust_short-0)>0||(C.maskingadjust_short=J[B].masking_adj*1.1),b!=0?C.ATHlower=-J[B].ath_lower/10:Math.abs(-C.ATHlower*10-0)>0||(C.ATHlower=-J[B].ath_lower/10),b!=0?C.ATHcurve=J[B].ath_curve:Math.abs(C.ATHcurve- -1)>0||(C.ATHcurve=J[B].ath_curve),b!=0?C.interChRatio=J[B].interch:Math.abs(C.interChRatio- -1)>0||(C.interChRatio=J[B].interch),s0}this.apply_preset=function(C,s0,b){switch(s0){case _e.R3MIX:{s0=_e.V3,C.VBR=x1.vbr_mtrh;break}case _e.MEDIUM:{s0=_e.V4,C.VBR=x1.vbr_rh;break}case _e.MEDIUM_FAST:{s0=_e.V4,C.VBR=x1.vbr_mtrh;break}case _e.STANDARD:{s0=_e.V2,C.VBR=x1.vbr_rh;break}case _e.STANDARD_FAST:{s0=_e.V2,C.VBR=x1.vbr_mtrh;break}case _e.EXTREME:{s0=_e.V0,C.VBR=x1.vbr_rh;break}case _e.EXTREME_FAST:{s0=_e.V0,C.VBR=x1.vbr_mtrh;break}case _e.INSANE:return s0=320,C.preset=s0,h0(C,s0,b),C.VBR=x1.vbr_off,s0}switch(C.preset=s0,s0){case _e.V9:return X(C,9,b),s0;case _e.V8:return X(C,8,b),s0;case _e.V7:return X(C,7,b),s0;case _e.V6:return X(C,6,b),s0;case _e.V5:return X(C,5,b),s0;case _e.V4:return X(C,4,b),s0;case _e.V3:return X(C,3,b),s0;case _e.V2:return X(C,2,b),s0;case _e.V1:return X(C,1,b),s0;case _e.V0:return X(C,0,b),s0}return 8<=s0&&s0<=320?h0(C,s0,b):(C.preset=0,s0)};function m0(C,s0){var b=0;return 0>s0&&(b=-1,s0=0),9<s0&&(b=-1,s0=9),C.VBR_q=s0,C.VBR_q_frac=0,b}}var Sr=yr;function Mr(){this.setModules=function(M,F){}}var Ar=Mr;function Rr(){this.over_noise=0,this.tot_noise=0,this.max_noise=0,this.over_count=0,this.over_SSD=0,this.bits=0}var Gt=Rr,pa=z.new_float,Br=z.new_int;function Er(){this.global_gain=0,this.sfb_count1=0,this.step=Br(39),this.noise=pa(39),this.noise_log=pa(39)}var Tr=Er,N1=z.System,ba=z.VbrMode,zt=z.Util,et=z.Arrays,ct=z.new_float,dt=z.assert;function kr(){var M;this.rv=null;var F;this.qupvt=null;var K,q=new Ar,o0;this.setModules=function(E,s,d,x){M=E,F=s,this.rv=s,K=d,this.qupvt=d,o0=x,q.setModules(K,o0)},this.ms_convert=function(E,s){for(var d=0;d<576;++d){var x=E.tt[s][0].xr[d],y=E.tt[s][1].xr[d];E.tt[s][0].xr[d]=(x+y)*(zt.SQRT2*.5),E.tt[s][1].xr[d]=(x-y)*(zt.SQRT2*.5)}};function X(E,s,d,x){x=0;for(var y=0;y<=d;++y){var R=Math.abs(E.xr[y]);x+=R,s[y]=Math.sqrt(R*Math.sqrt(R)),s[y]>E.xrpow_max&&(E.xrpow_max=s[y])}return x}this.init_xrpow=function(E,s,d){var x=0,y=0|s.max_nonzero_coeff;if(s.xrpow_max=0,et.fill(d,y,576,0),x=X(s,d,y,x),x>1e-20){var R=0;E.substep_shaping&2&&(R=1);for(var t=0;t<s.psymax;t++)E.pseudohalf[t]=R;return!0}return et.fill(s.l3_enc,0,576,0),!1};function J(E,s){var d=E.ATH,x=s.xr;if(s.block_type!=f.SHORT_TYPE)for(var y=!1,R=f.PSFB21-1;R>=0&&!y;R--){var t=E.scalefac_band.psfb21[R],c=E.scalefac_band.psfb21[R+1],_=K.athAdjust(d.adjust,d.psfb21[R],d.floor);E.nsPsy.longfact[21]>1e-12&&(_*=E.nsPsy.longfact[21]);for(var n=c-1;n>=t;n--)if(Math.abs(x[n])<_)x[n]=0;else{y=!0;break}}else for(var u=0;u<3;u++)for(var y=!1,R=f.PSFB12-1;R>=0&&!y;R--){var t=E.scalefac_band.s[12]*3+(E.scalefac_band.s[13]-E.scalefac_band.s[12])*u+(E.scalefac_band.psfb12[R]-E.scalefac_band.psfb12[0]),c=t+(E.scalefac_band.psfb12[R+1]-E.scalefac_band.psfb12[R]),v=K.athAdjust(d.adjust,d.psfb12[R],d.floor);E.nsPsy.shortfact[12]>1e-12&&(v*=E.nsPsy.shortfact[12]);for(var n=c-1;n>=t;n--)if(Math.abs(x[n])<v)x[n]=0;else{y=!0;break}}}this.init_outer_loop=function(E,s){s.part2_3_length=0,s.big_values=0,s.count1=0,s.global_gain=210,s.scalefac_compress=0,s.table_select[0]=0,s.table_select[1]=0,s.table_select[2]=0,s.subblock_gain[0]=0,s.subblock_gain[1]=0,s.subblock_gain[2]=0,s.subblock_gain[3]=0,s.region0_count=0,s.region1_count=0,s.preflag=0,s.scalefac_scale=0,s.count1table_select=0,s.part2_length=0,s.sfb_lmax=f.SBPSY_l,s.sfb_smin=f.SBPSY_s,s.psy_lmax=E.sfb21_extra?f.SBMAX_l:f.SBPSY_l,s.psymax=s.psy_lmax,s.sfbmax=s.sfb_lmax,s.sfbdivide=11;for(var d=0;d<f.SBMAX_l;d++)s.width[d]=E.scalefac_band.l[d+1]-E.scalefac_band.l[d],s.window[d]=3;if(s.block_type==f.SHORT_TYPE){var x=ct(576);s.sfb_smin=0,s.sfb_lmax=0,s.mixed_block_flag!=0&&(s.sfb_smin=3,s.sfb_lmax=E.mode_gr*2+4),s.psymax=s.sfb_lmax+3*((E.sfb21_extra?f.SBMAX_s:f.SBPSY_s)-s.sfb_smin),s.sfbmax=s.sfb_lmax+3*(f.SBPSY_s-s.sfb_smin),s.sfbdivide=s.sfbmax-18,s.psy_lmax=s.sfb_lmax;var y=E.scalefac_band.l[s.sfb_lmax];N1.arraycopy(s.xr,0,x,0,576);for(var d=s.sfb_smin;d<f.SBMAX_s;d++)for(var R=E.scalefac_band.s[d],t=E.scalefac_band.s[d+1],c=0;c<3;c++)for(var _=R;_<t;_++)s.xr[y++]=x[3*_+c];for(var n=s.sfb_lmax,d=s.sfb_smin;d<f.SBMAX_s;d++)s.width[n]=s.width[n+1]=s.width[n+2]=E.scalefac_band.s[d+1]-E.scalefac_band.s[d],s.window[n]=0,s.window[n+1]=1,s.window[n+2]=2,n+=3}s.count1bits=0,s.sfb_partition_table=K.nr_of_sfb_block[0][0],s.slen[0]=0,s.slen[1]=0,s.slen[2]=0,s.slen[3]=0,s.max_nonzero_coeff=575,et.fill(s.scalefac,0),J(E,s)};function h0(E){this.ordinal=E}h0.BINSEARCH_NONE=new h0(0),h0.BINSEARCH_UP=new h0(1),h0.BINSEARCH_DOWN=new h0(2);function m0(E,s,d,x,y){var R,t=E.CurrentStep[x],c=!1,_=E.OldValue[x],n=h0.BINSEARCH_NONE;for(s.global_gain=_,d-=s.part2_length;;){var u;if(R=o0.count_bits(E,y,s,null),t==1||R==d)break;R>d?(n==h0.BINSEARCH_DOWN&&(c=!0),c&&(t/=2),n=h0.BINSEARCH_UP,u=t):(n==h0.BINSEARCH_UP&&(c=!0),c&&(t/=2),n=h0.BINSEARCH_DOWN,u=-t),s.global_gain+=u,s.global_gain<0&&(s.global_gain=0,c=!0),s.global_gain>255&&(s.global_gain=255,c=!0)}for(dt(s.global_gain>=0),dt(s.global_gain<256);R>d&&s.global_gain<255;)s.global_gain++,R=o0.count_bits(E,y,s,null);return E.CurrentStep[x]=_-s.global_gain>=4?4:2,E.OldValue[x]=s.global_gain,s.part2_3_length=R,R}this.trancate_smallspectrums=function(E,s,d,x){var y=ct(m1.SFBMAX);if(!(!(E.substep_shaping&4)&&s.block_type==f.SHORT_TYPE||E.substep_shaping&128)){K.calc_noise(s,d,y,new Gt,null);for(var t=0;t<576;t++){var R=0;s.l3_enc[t]!=0&&(R=Math.abs(s.xr[t])),x[t]=R}var t=0,c=8;s.block_type==f.SHORT_TYPE&&(c=6);do{var _,n,u,v,r=s.width[c];if(t+=r,!(y[c]>=1)&&(et.sort(x,t-r,r),!E1.EQ(x[t-1],0))){_=(1-y[c])*d[c],n=0,v=0;do{var i;for(u=1;v+u<r&&!E1.NEQ(x[v+t-r],x[v+t+u-r]);u++);if(i=x[v+t-r]*x[v+t-r]*u,_<i){v!=0&&(n=x[v+t-r-1]);break}_-=i,v+=u}while(v<r);if(!E1.EQ(n,0))do Math.abs(s.xr[t-r])<=n&&(s.l3_enc[t-r]=0);while(--r>0)}}while(++c<s.psymax);s.part2_3_length=o0.noquant_count_bits(E,s,null)}};function C(E){for(var s=0;s<E.sfbmax;s++)if(E.scalefac[s]+E.subblock_gain[E.window[s]]==0)return!1;return!0}function s0(E){return zt.FAST_LOG10(.368+.632*E*E*E)}function b(E,s){for(var d=1e-37,x=0;x<s.psymax;x++)d+=s0(E[x]);return Math.max(1e-20,d)}function w(E,s,d,x,y){var R;switch(E){default:case 9:{s.over_count>0?(R=d.over_SSD<=s.over_SSD,d.over_SSD==s.over_SSD&&(R=d.bits<s.bits)):R=d.max_noise<0&&d.max_noise*10+d.bits<=s.max_noise*10+s.bits;break}case 0:R=d.over_count<s.over_count||d.over_count==s.over_count&&d.over_noise<s.over_noise||d.over_count==s.over_count&&E1.EQ(d.over_noise,s.over_noise)&&d.tot_noise<s.tot_noise;break;case 8:d.max_noise=b(y,x);case 1:R=d.max_noise<s.max_noise;break;case 2:R=d.tot_noise<s.tot_noise;break;case 3:R=d.tot_noise<s.tot_noise&&d.max_noise<s.max_noise;break;case 4:R=d.max_noise<=0&&s.max_noise>.2||d.max_noise<=0&&s.max_noise<0&&s.max_noise>d.max_noise-.2&&d.tot_noise<s.tot_noise||d.max_noise<=0&&s.max_noise>0&&s.max_noise>d.max_noise-.2&&d.tot_noise<s.tot_noise+s.over_noise||d.max_noise>0&&s.max_noise>-.05&&s.max_noise>d.max_noise-.1&&d.tot_noise+d.over_noise<s.tot_noise+s.over_noise||d.max_noise>0&&s.max_noise>-.1&&s.max_noise>d.max_noise-.15&&d.tot_noise+d.over_noise+d.over_noise<s.tot_noise+s.over_noise+s.over_noise;break;case 5:R=d.over_noise<s.over_noise||E1.EQ(d.over_noise,s.over_noise)&&d.tot_noise<s.tot_noise;break;case 6:R=d.over_noise<s.over_noise||E1.EQ(d.over_noise,s.over_noise)&&(d.max_noise<s.max_noise||E1.EQ(d.max_noise,s.max_noise)&&d.tot_noise<=s.tot_noise);break;case 7:R=d.over_count<s.over_count||d.over_noise<s.over_noise;break}return s.over_count==0&&(R=R&&d.bits<s.bits),R}function B(E,s,d,x,y){var R=E.internal_flags,t;s.scalefac_scale==0?t=1.2968395546510096:t=1.6817928305074292;for(var c=0,_=0;_<s.sfbmax;_++)c<d[_]&&(c=d[_]);var n=R.noise_shaping_amp;switch(n==3&&(y?n=2:n=1),n){case 2:break;case 1:c>1?c=Math.pow(c,.5):c*=.95;break;case 0:default:c>1?c=1:c*=.95;break}for(var u=0,_=0;_<s.sfbmax;_++){var v=s.width[_],r;if(u+=v,!(d[_]<c)){if(R.substep_shaping&2&&(R.pseudohalf[_]=R.pseudohalf[_]==0?1:0,R.pseudohalf[_]==0&&R.noise_shaping_amp==2))return;for(s.scalefac[_]++,r=-v;r<0;r++)x[u+r]*=t,x[u+r]>s.xrpow_max&&(s.xrpow_max=x[u+r]);if(R.noise_shaping_amp==2)return}}}function e(E,s){for(var d=1.2968395546510096,x=0,y=0;y<E.sfbmax;y++){var R=E.width[y],t=E.scalefac[y];if(E.preflag!=0&&(t+=K.pretab[y]),x+=R,t&1){t++;for(var c=-R;c<0;c++)s[x+c]*=d,s[x+c]>E.xrpow_max&&(E.xrpow_max=s[x+c])}E.scalefac[y]=t>>1}E.preflag=0,E.scalefac_scale=1}function L(E,s,d){var x,y=s.scalefac;for(x=0;x<s.sfb_lmax;x++)if(y[x]>=16)return!0;for(var R=0;R<3;R++){var t=0,c=0;for(x=s.sfb_lmax+R;x<s.sfbdivide;x+=3)t<y[x]&&(t=y[x]);for(;x<s.sfbmax;x+=3)c<y[x]&&(c=y[x]);if(!(t<16&&c<8)){if(s.subblock_gain[R]>=7)return!0;s.subblock_gain[R]++;var _=E.scalefac_band.l[s.sfb_lmax];for(x=s.sfb_lmax+R;x<s.sfbmax;x+=3){var n,u=s.width[x],v=y[x];if(v=v-(4>>s.scalefac_scale),v>=0){y[x]=v,_+=u*3;continue}y[x]=0;{var r=210+(v<<s.scalefac_scale+1);n=K.IPOW20(r)}_+=u*(R+1);for(var i=-u;i<0;i++)d[_+i]*=n,d[_+i]>s.xrpow_max&&(s.xrpow_max=d[_+i]);_+=u*(3-R-1)}{var n=K.IPOW20(202);_+=s.width[x]*(R+1);for(var i=-s.width[x];i<0;i++)d[_+i]*=n,d[_+i]>s.xrpow_max&&(s.xrpow_max=d[_+i])}}}return!1}function I(E,s,d,x,y){var R=E.internal_flags;B(E,s,d,x,y);var t=C(s);return t?!1:(R.mode_gr==2?t=o0.scale_bitcount(s):t=o0.scale_bitcount_lsf(R,s),t?(R.noise_shaping>1&&(et.fill(R.pseudohalf,0),s.scalefac_scale==0?(e(s,x),t=!1):s.block_type==f.SHORT_TYPE&&R.subblock_gain>0&&(t=L(R,s,x)||C(s))),t||(R.mode_gr==2?t=o0.scale_bitcount(s):t=o0.scale_bitcount_lsf(R,s)),!t):!0)}this.outer_loop=function(E,s,d,x,y,R){var t=E.internal_flags,c=new $1,_=ct(576),n=ct(m1.SFBMAX),u=new Gt,v,r=new Tr,i=9999999,l=!1,S=!1,Y=0;if(m0(t,s,R,y,x),t.noise_shaping==0)return 100;K.calc_noise(s,d,n,u,r),u.bits=s.part2_3_length,c.assign(s);var k=0;for(N1.arraycopy(x,0,_,0,576);!l;){do{var O=new Gt,a,o=255;if(t.substep_shaping&2?a=20:a=3,t.sfb21_extra&&(n[c.sfbmax]>1||c.block_type==f.SHORT_TYPE&&(n[c.sfbmax+1]>1||n[c.sfbmax+2]>1))||!I(E,c,n,x,S))break;c.scalefac_scale!=0&&(o=254);var j=R-c.part2_length;if(j<=0)break;for(;(c.part2_3_length=o0.count_bits(t,x,c,r))>j&&c.global_gain<=o;)c.global_gain++;if(c.global_gain>o)break;if(u.over_count==0){for(;(c.part2_3_length=o0.count_bits(t,x,c,r))>i&&c.global_gain<=o;)c.global_gain++;if(c.global_gain>o)break}if(K.calc_noise(c,d,n,O,r),O.bits=c.part2_3_length,s.block_type!=f.SHORT_TYPE?v=E.quant_comp:v=E.quant_comp_short,v=w(v,u,O,c,n)?1:0,v!=0)i=s.part2_3_length,u=O,s.assign(c),k=0,N1.arraycopy(x,0,_,0,576);else if(t.full_outer_loop==0&&(++k>a&&u.over_count==0||t.noise_shaping_amp==3&&S&&k>30||t.noise_shaping_amp==3&&S&&c.global_gain-Y>15))break}while(c.global_gain+c.scalefac_scale<255);t.noise_shaping_amp==3?S?l=!0:(c.assign(s),N1.arraycopy(_,0,x,0,576),k=0,Y=c.global_gain,S=!0):l=!0}return dt(s.global_gain+s.scalefac_scale<=255),E.VBR==ba.vbr_rh||E.VBR==ba.vbr_mtrh?N1.arraycopy(_,0,x,0,576):t.substep_shaping&1&&trancate_smallspectrums(t,s,d,x),u.over_count},this.iteration_finish_one=function(E,s,d){var x=E.l3_side,y=x.tt[s][d];o0.best_scalefac_store(E,s,d,x),E.use_best_huffman==1&&o0.best_huffman_divide(E,y),F.ResvAdjust(E,y)},this.VBR_encode_granule=function(E,s,d,x,y,R,t){var c=E.internal_flags,_=new $1,n=ct(576),u=t,v=t+1,r=(t+R)/2,i,l,S=0,Y=c.sfb21_extra;dt(u<=LameInternalFlags.MAX_BITS_PER_CHANNEL),et.fill(_.l3_enc,0);do r>u-42?c.sfb21_extra=!1:c.sfb21_extra=Y,l=outer_loop(E,s,d,x,y,r),l<=0?(S=1,v=s.part2_3_length,_.assign(s),N1.arraycopy(x,0,n,0,576),t=v-32,i=t-R,r=(t+R)/2):(R=r+32,i=t-R,r=(t+R)/2,S!=0&&(S=2,s.assign(_),N1.arraycopy(n,0,x,0,576)));while(i>12);c.sfb21_extra=Y,S==2&&N1.arraycopy(_.l3_enc,0,s.l3_enc,0,576),dt(s.part2_3_length<=u)},this.get_framebits=function(E,s){var d=E.internal_flags;d.bitrate_index=d.VBR_min_bitrate;var x=M.getframebits(E);d.bitrate_index=1,x=M.getframebits(E);for(var y=1;y<=d.VBR_max_bitrate;y++){d.bitrate_index=y;var R=new MeanBits(x);s[y]=F.ResvFrameBegin(E,R),x=R.bits}},this.VBR_old_prepare=function(E,s,d,x,y,R,t,c,_){var n=E.internal_flags,u,v=0,r=1,i=0;n.bitrate_index=n.VBR_max_bitrate;var l=F.ResvFrameBegin(E,new MeanBits(0))/n.mode_gr;get_framebits(E,R);for(var S=0;S<n.mode_gr;S++){var Y=K.on_pe(E,s,c[S],l,S,0);n.mode_ext==f.MPG_MD_MS_LR&&(ms_convert(n.l3_side,S),K.reduce_side(c[S],d[S],l,Y));for(var k=0;k<n.channels_out;++k){var O=n.l3_side.tt[S][k];O.block_type!=f.SHORT_TYPE?(v=1.28/(1+Math.exp(3.5-s[S][k]/300))-.05,u=n.PSY.mask_adjust-v):(v=2.56/(1+Math.exp(3.5-s[S][k]/300))-.14,u=n.PSY.mask_adjust_short-v),n.masking_lower=Math.pow(10,u*.1),init_outer_loop(n,O),_[S][k]=K.calc_xmin(E,x[S][k],O,y[S][k]),_[S][k]!=0&&(r=0),t[S][k]=126,i+=c[S][k]}}for(var S=0;S<n.mode_gr;S++)for(var k=0;k<n.channels_out;k++)i>R[n.VBR_max_bitrate]&&(c[S][k]*=R[n.VBR_max_bitrate],c[S][k]/=i),t[S][k]>c[S][k]&&(t[S][k]=c[S][k]);return r},this.bitpressure_strategy=function(E,s,d,x){for(var y=0;y<E.mode_gr;y++)for(var R=0;R<E.channels_out;R++){for(var t=E.l3_side.tt[y][R],c=s[y][R],_=0,n=0;n<t.psy_lmax;n++)c[_++]*=1+.029*n*n/f.SBMAX_l/f.SBMAX_l;if(t.block_type==f.SHORT_TYPE)for(var n=t.sfb_smin;n<f.SBMAX_s;n++)c[_++]*=1+.029*n*n/f.SBMAX_s/f.SBMAX_s,c[_++]*=1+.029*n*n/f.SBMAX_s/f.SBMAX_s,c[_++]*=1+.029*n*n/f.SBMAX_s/f.SBMAX_s;x[y][R]=0|Math.max(d[y][R],.9*x[y][R])}},this.VBR_new_prepare=function(E,s,d,x,y,R){var t=E.internal_flags,c=1,_=0,n=0,u;if(E.free_format){t.bitrate_index=0;var v=new MeanBits(_);u=F.ResvFrameBegin(E,v),_=v.bits,y[0]=u}else{t.bitrate_index=t.VBR_max_bitrate;var v=new MeanBits(_);F.ResvFrameBegin(E,v),_=v.bits,get_framebits(E,y),u=y[t.VBR_max_bitrate]}for(var r=0;r<t.mode_gr;r++){K.on_pe(E,s,R[r],_,r,0),t.mode_ext==f.MPG_MD_MS_LR&&ms_convert(t.l3_side,r);for(var i=0;i<t.channels_out;++i){var l=t.l3_side.tt[r][i];t.masking_lower=Math.pow(10,t.PSY.mask_adjust*.1),init_outer_loop(t,l),K.calc_xmin(E,d[r][i],l,x[r][i])!=0&&(c=0),n+=R[r][i]}}for(var r=0;r<t.mode_gr;r++)for(var i=0;i<t.channels_out;i++)n>u&&(R[r][i]*=u,R[r][i]/=n);return c},this.calc_target_bits=function(E,s,d,x,y,R){var t=E.internal_flags,c=t.l3_side,_,n,u,v,r=0;t.bitrate_index=t.VBR_max_bitrate;var i=new MeanBits(r);for(R[0]=F.ResvFrameBegin(E,i),r=i.bits,t.bitrate_index=1,r=M.getframebits(E)-t.sideinfo_len*8,y[0]=r/(t.mode_gr*t.channels_out),r=E.VBR_mean_bitrate_kbps*E.framesize*1e3,t.substep_shaping&1&&(r*=1.09),r/=E.out_samplerate,r-=t.sideinfo_len*8,r/=t.mode_gr*t.channels_out,_=.93+.07*(11-E.compression_ratio)/(11-5.5),_<.9&&(_=.9),_>1&&(_=1),n=0;n<t.mode_gr;n++){var l=0;for(u=0;u<t.channels_out;u++){if(x[n][u]=int(_*r),s[n][u]>700){var S=int((s[n][u]-700)/1.4),Y=c.tt[n][u];x[n][u]=int(_*r),Y.block_type==f.SHORT_TYPE&&S<r/2&&(S=r/2),S>r*3/2?S=r*3/2:S<0&&(S=0),x[n][u]+=S}x[n][u]>LameInternalFlags.MAX_BITS_PER_CHANNEL&&(x[n][u]=LameInternalFlags.MAX_BITS_PER_CHANNEL),l+=x[n][u]}if(l>LameInternalFlags.MAX_BITS_PER_GRANULE)for(u=0;u<t.channels_out;++u)x[n][u]*=LameInternalFlags.MAX_BITS_PER_GRANULE,x[n][u]/=l}if(t.mode_ext==f.MPG_MD_MS_LR)for(n=0;n<t.mode_gr;n++)K.reduce_side(x[n],d[n],r*t.channels_out,LameInternalFlags.MAX_BITS_PER_GRANULE);for(v=0,n=0;n<t.mode_gr;n++)for(u=0;u<t.channels_out;u++)x[n][u]>LameInternalFlags.MAX_BITS_PER_CHANNEL&&(x[n][u]=LameInternalFlags.MAX_BITS_PER_CHANNEL),v+=x[n][u];if(v>R[0])for(n=0;n<t.mode_gr;n++)for(u=0;u<t.channels_out;u++)x[n][u]*=R[0],x[n][u]/=v}}var Cr=kr,xa=z.assert;function gr(){var M;this.setModules=function(F){M=F},this.ResvFrameBegin=function(F,K){var q=F.internal_flags,o0,X=q.l3_side,J=M.getframebits(F);K.bits=(J-q.sideinfo_len*8)/q.mode_gr;var h0=8*256*q.mode_gr-8;F.brate>320?o0=8*int(F.brate*1e3/(F.out_samplerate/1152)/8+.5):(o0=8*1440,F.strict_ISO&&(o0=8*int(32e4/(F.out_samplerate/1152)/8+.5))),q.ResvMax=o0-J,q.ResvMax>h0&&(q.ResvMax=h0),(q.ResvMax<0||F.disable_reservoir)&&(q.ResvMax=0);var m0=K.bits*q.mode_gr+Math.min(q.ResvSize,q.ResvMax);return m0>o0&&(m0=o0),xa(q.ResvMax%8==0),xa(q.ResvMax>=0),X.resvDrain_pre=0,q.pinfo!=null&&(q.pinfo.mean_bits=K.bits/2,q.pinfo.resvsize=q.ResvSize),m0},this.ResvMaxBits=function(F,K,q,o0){var X=F.internal_flags,J,h0=X.ResvSize,m0=X.ResvMax;o0!=0&&(h0+=K),X.substep_shaping&1&&(m0*=.9),q.bits=K,h0*10>m0*9?(J=h0-m0*9/10,q.bits+=J,X.substep_shaping|=128):(J=0,X.substep_shaping&=127,!F.disable_reservoir&&!(X.substep_shaping&1)&&(q.bits-=.1*K));var C=h0<X.ResvMax*6/10?h0:X.ResvMax*6/10;return C-=J,C<0&&(C=0),C},this.ResvAdjust=function(F,K){F.ResvSize-=K.part2_3_length+K.part2_length},this.ResvFrameEnd=function(F,K){var q,o0=F.l3_side;F.ResvSize+=K*F.mode_gr;var X=0;o0.resvDrain_post=0,o0.resvDrain_pre=0,(q=F.ResvSize%8)!=0&&(X+=q),q=F.ResvSize-X-F.ResvMax,q>0&&(X+=q);{var J=Math.min(o0.main_data_begin*8,X)/8;o0.resvDrain_pre+=8*J,X-=8*J,F.ResvSize-=8*J,o0.main_data_begin-=J}o0.resvDrain_post+=X,F.ResvSize-=X}}var Ir=gr;function Lr(){var M="http://www.mp3dev.org/",F=3,K=98,q=4,o0=0,X=93;this.getLameVersion=function(){return F+"."+K+"."+q},this.getLameShortVersion=function(){return F+"."+K+"."+q},this.getLameVeryShortVersion=function(){return"LAME"+F+"."+K+"r"},this.getPsyVersion=function(){return o0+"."+X},this.getLameUrl=function(){return M},this.getLameOsBitness=function(){return"32bits"}}var Or=Lr,Nr=z.System,Ut=z.VbrMode,wa=z.ShortBlock,Vr=z.Arrays,Ot=z.new_byte,Hr=z.assert;ht.NUMTOCENTRIES=100,ht.MAXFRAMESIZE=2880;function ht(){var M,F,K;this.setModules=function(r,i,l){M=r,F=i,K=l};var q=1,o0=2,X=4,J=8,h0=ht.NUMTOCENTRIES,m0=ht.MAXFRAMESIZE,C=h0+4+4+4+4+4,s0=C+9+1+1+8+1+1+3+1+1+2+4+2+2,b=128,w=64,B=32,e=null,L="Xing",I="Info",E=[0,49345,49537,320,49921,960,640,49729,50689,1728,1920,51009,1280,50625,50305,1088,52225,3264,3456,52545,3840,53185,52865,3648,2560,51905,52097,2880,51457,2496,2176,51265,55297,6336,6528,55617,6912,56257,55937,6720,7680,57025,57217,8e3,56577,7616,7296,56385,5120,54465,54657,5440,55041,6080,5760,54849,53761,4800,4992,54081,4352,53697,53377,4160,61441,12480,12672,61761,13056,62401,62081,12864,13824,63169,63361,14144,62721,13760,13440,62529,15360,64705,64897,15680,65281,16320,16e3,65089,64001,15040,15232,64321,14592,63937,63617,14400,10240,59585,59777,10560,60161,11200,10880,59969,60929,11968,12160,61249,11520,60865,60545,11328,58369,9408,9600,58689,9984,59329,59009,9792,8704,58049,58241,9024,57601,8640,8320,57409,40961,24768,24960,41281,25344,41921,41601,25152,26112,42689,42881,26432,42241,26048,25728,42049,27648,44225,44417,27968,44801,28608,28288,44609,43521,27328,27520,43841,26880,43457,43137,26688,30720,47297,47489,31040,47873,31680,31360,47681,48641,32448,32640,48961,32e3,48577,48257,31808,46081,29888,30080,46401,30464,47041,46721,30272,29184,45761,45953,29504,45313,29120,28800,45121,20480,37057,37249,20800,37633,21440,21120,37441,38401,22208,22400,38721,21760,38337,38017,21568,39937,23744,23936,40257,24320,40897,40577,24128,23040,39617,39809,23360,39169,22976,22656,38977,34817,18624,18816,35137,19200,35777,35457,19008,19968,36545,36737,20288,36097,19904,19584,35905,17408,33985,34177,17728,34561,18368,18048,34369,33281,17088,17280,33601,16640,33217,32897,16448];function s(r,i){if(r.nVbrNumFrames++,r.sum+=i,r.seen++,!(r.seen<r.want)&&(r.pos<r.size&&(r.bag[r.pos]=r.sum,r.pos++,r.seen=0),r.pos==r.size)){for(var l=1;l<r.size;l+=2)r.bag[l/2]=r.bag[l];r.want*=2,r.pos/=2}}function d(r,i){if(!(r.pos<=0))for(var l=1;l<h0;++l){var S=l/h0,Y,k,O=0|Math.floor(S*r.pos);O>r.pos-1&&(O=r.pos-1),Y=r.bag[O],k=r.sum;var a=0|256*Y/k;a>255&&(a=255),i[l]=255&a}}this.addVbrFrame=function(r){var i=r.internal_flags,l=Tables.bitrate_table[r.version][i.bitrate_index];Hr(i.VBR_seek_table.bag!=null),s(i.VBR_seek_table,l)};function x(r,i){var l=r[i+0]&255;return l<<=8,l|=r[i+1]&255,l<<=8,l|=r[i+2]&255,l<<=8,l|=r[i+3]&255,l}function y(r,i,l){r[i+0]=255&(l>>24&255),r[i+1]=255&(l>>16&255),r[i+2]=255&(l>>8&255),r[i+3]=255&(l&255)}function R(r,i,l){r[i+0]=255&(l>>8&255),r[i+1]=255&(l&255)}function t(r,i){return new String(r,i,L.length(),e).equals(L)||new String(r,i,I.length(),e).equals(I)}function c(r,i,l){return 255&(r<<i|l&~(-1<<i))}function _(r,i){var l=r.internal_flags;i[0]=c(i[0],8,255),i[1]=c(i[1],3,7),i[1]=c(i[1],1,r.out_samplerate<16e3?0:1),i[1]=c(i[1],1,r.version),i[1]=c(i[1],2,4-3),i[1]=c(i[1],1,r.error_protection?0:1),i[2]=c(i[2],4,l.bitrate_index),i[2]=c(i[2],2,l.samplerate_index),i[2]=c(i[2],1,0),i[2]=c(i[2],1,r.extension),i[3]=c(i[3],2,r.mode.ordinal()),i[3]=c(i[3],2,l.mode_ext),i[3]=c(i[3],1,r.copyright),i[3]=c(i[3],1,r.original),i[3]=c(i[3],2,r.emphasis),i[0]=255;var S=255&(i[1]&241),Y;r.version==1?Y=b:r.out_samplerate<16e3?Y=B:Y=w,r.VBR==Ut.vbr_off&&(Y=r.brate);var k;r.free_format?k=0:k=255&16*M.BitrateIndex(Y,r.version,r.out_samplerate),r.version==1?(i[1]=255&(S|10),S=255&(i[2]&13),i[2]=255&(k|S)):(i[1]=255&(S|2),S=255&(i[2]&13),i[2]=255&(k|S))}this.getVbrTag=function(r){var i=new VBRTagData,l=0;i.flags=0;var S=r[l+1]>>3&1,Y=r[l+2]>>2&3,k=r[l+3]>>6&3,O=r[l+2]>>4&15;if(O=Tables.bitrate_table[S][O],r[l+1]>>4==14?i.samprate=Tables.samplerate_table[2][Y]:i.samprate=Tables.samplerate_table[S][Y],S!=0?k!=3?l+=32+4:l+=17+4:k!=3?l+=17+4:l+=9+4,!t(r,l))return null;l+=4,i.hId=S;var a=i.flags=x(r,l);if(l+=4,a&q&&(i.frames=x(r,l),l+=4),a&o0&&(i.bytes=x(r,l),l+=4),a&X){if(i.toc!=null)for(var o=0;o<h0;o++)i.toc[o]=r[l+o];l+=h0}i.vbrScale=-1,a&J&&(i.vbrScale=x(r,l),l+=4),i.headersize=(S+1)*72e3*O/i.samprate,l+=21;var j=r[l+0]<<4;j+=r[l+1]>>4;var e0=(r[l+1]&15)<<8;return e0+=r[l+2]&255,(j<0||j>3e3)&&(j=-1),(e0<0||e0>3e3)&&(e0=-1),i.encDelay=j,i.encPadding=e0,i},this.InitVbrTag=function(r){var i=r.internal_flags,l;r.version==1?l=b:r.out_samplerate<16e3?l=B:l=w,r.VBR==Ut.vbr_off&&(l=r.brate);var S=(r.version+1)*72e3*l/r.out_samplerate,Y=i.sideinfo_len+s0;if(i.VBR_seek_table.TotalFrameSize=S,S<Y||S>m0){r.bWriteVbrTag=!1;return}i.VBR_seek_table.nVbrNumFrames=0,i.VBR_seek_table.nBytesWritten=0,i.VBR_seek_table.sum=0,i.VBR_seek_table.seen=0,i.VBR_seek_table.want=1,i.VBR_seek_table.pos=0,i.VBR_seek_table.bag==null&&(i.VBR_seek_table.bag=new int[400],i.VBR_seek_table.size=400);var k=Ot(m0);_(r,k);for(var O=i.VBR_seek_table.TotalFrameSize,a=0;a<O;++a)F.add_dummy_byte(r,k[a]&255,1)};function n(r,i){var l=i^r;return i=i>>8^E[l&255],i}this.updateMusicCRC=function(r,i,l,S){for(var Y=0;Y<S;++Y)r[0]=n(i[l+Y],r[0])};function u(r,i,l,S,Y){var k=r.internal_flags,O=0,a=r.encoder_delay,o=r.encoder_padding,j=100-10*r.VBR_q-r.quality,e0=K.getLameVeryShortVersion(),f0,y0=0,p0,w0=[1,5,3,2,4,0,3],F0=0|(r.lowpassfreq/100+.5>255?255:r.lowpassfreq/100+.5),k0=0,b0=0,ne=0,ke=r.internal_flags.noise_shaping,te=0,he=0,fe=0,Me=0,Ie=0,w1=(r.exp_nspsytune&1)!=0,e1=(r.exp_nspsytune&2)!=0,Ze=!1,o1=!1,Y1=r.internal_flags.nogap_total,V1=r.internal_flags.nogap_current,je=r.ATHtype,j1=0,T1;switch(r.VBR){case vbr_abr:T1=r.VBR_mean_bitrate_kbps;break;case vbr_off:T1=r.brate;break;default:T1=r.VBR_min_bitrate_kbps}switch(r.VBR.ordinal()<w0.length?f0=w0[r.VBR.ordinal()]:f0=0,p0=16*y0+f0,k.findReplayGain&&(k.RadioGain>510&&(k.RadioGain=510),k.RadioGain<-510&&(k.RadioGain=-510),b0=8192,b0|=3072,k.RadioGain>=0?b0|=k.RadioGain:(b0|=512,b0|=-k.RadioGain)),k.findPeakSample&&(k0=Math.abs(0|k.PeakSample/32767*Math.pow(2,23)+.5)),Y1!=-1&&(V1>0&&(o1=!0),V1<Y1-1&&(Ze=!0)),j1=je+((w1?1:0)<<4)+((e1?1:0)<<5)+((Ze?1:0)<<6)+((o1?1:0)<<7),j<0&&(j=0),r.mode){case MONO:te=0;break;case STEREO:te=1;break;case DUAL_CHANNEL:te=2;break;case JOINT_STEREO:r.force_ms?te=4:te=3;break;case NOT_SET:default:te=7;break}r.in_samplerate<=32e3?fe=0:r.in_samplerate==48e3?fe=2:r.in_samplerate>48e3?fe=3:fe=1,(r.short_blocks==wa.short_block_forced||r.short_blocks==wa.short_block_dispensed||r.lowpassfreq==-1&&r.highpassfreq==-1||r.scale_left<r.scale_right||r.scale_left>r.scale_right||r.disable_reservoir&&r.brate<320||r.noATH||r.ATHonly||je==0||r.in_samplerate<=32e3)&&(he=1),Me=ke+(te<<2)+(he<<5)+(fe<<6),Ie=k.nMusicCRC,y(l,S+O,j),O+=4;for(var Ge=0;Ge<9;Ge++)l[S+O+Ge]=255&e0.charAt(Ge);O+=9,l[S+O]=255&p0,O++,l[S+O]=255&F0,O++,y(l,S+O,k0),O+=4,R(l,S+O,b0),O+=2,R(l,S+O,ne),O+=2,l[S+O]=255&j1,O++,T1>=255?l[S+O]=255:l[S+O]=255&T1,O++,l[S+O]=255&a>>4,l[S+O+1]=255&(a<<4)+(o>>8),l[S+O+2]=255&o,O+=3,l[S+O]=255&Me,O++,l[S+O++]=0,R(l,S+O,r.preset),O+=2,y(l,S+O,i),O+=4,R(l,S+O,Ie),O+=2;for(var tt=0;tt<O;tt++)Y=n(l[S+tt],Y);return R(l,S+O,Y),O+=2,O}function v(r){r.seek(0);var i=Ot(10);r.readFully(i);var l;return new String(i,"ISO-8859-1").startsWith("ID3")?l=0:l=((i[6]&127)<<21|(i[7]&127)<<14|(i[8]&127)<<7|i[9]&127)+i.length,l}this.getLameTagFrame=function(r,i){var l=r.internal_flags;if(!r.bWriteVbrTag||l.Class_ID!=_e.LAME_ID||l.VBR_seek_table.pos<=0)return 0;if(i.length<l.VBR_seek_table.TotalFrameSize)return l.VBR_seek_table.TotalFrameSize;Vr.fill(i,0,l.VBR_seek_table.TotalFrameSize,0),_(r,i);var S=Ot(h0);if(r.free_format)for(var Y=1;Y<h0;++Y)S[Y]=255&255*Y/100;else d(l.VBR_seek_table,S);var k=l.sideinfo_len;r.error_protection&&(k-=2),r.VBR==Ut.vbr_off?(i[k++]=255&I.charAt(0),i[k++]=255&I.charAt(1),i[k++]=255&I.charAt(2),i[k++]=255&I.charAt(3)):(i[k++]=255&L.charAt(0),i[k++]=255&L.charAt(1),i[k++]=255&L.charAt(2),i[k++]=255&L.charAt(3)),y(i,k,q+o0+X+J),k+=4,y(i,k,l.VBR_seek_table.nVbrNumFrames),k+=4;var O=l.VBR_seek_table.nBytesWritten+l.VBR_seek_table.TotalFrameSize;y(i,k,0|O),k+=4,Nr.arraycopy(S,0,i,k,S.length),k+=S.length,r.error_protection&&F.CRC_writeheader(l,i);for(var a=0,Y=0;Y<k;Y++)a=n(i[Y],a);return k+=u(r,O,i,k,a),l.VBR_seek_table.TotalFrameSize},this.putVbrTag=function(r,i){var l=r.internal_flags;if(l.VBR_seek_table.pos<=0||(i.seek(i.length()),i.length()==0))return-1;var S=v(i);i.seek(S);var Y=Ot(m0),k=getLameTagFrame(r,Y);return k>Y.length?-1:(k<1||i.write(Y,0,k),0)}}var $r=ht,ya=z.new_byte,Fr=z.assert,_e=wr,qr=Sr,ft=$e,Xr=I1,Zr=Cr,Dr=Yt,Pr=Ir,Te=lt,E1=L1;function Yr(){this.setModules=function(M,F){}}function jr(){this.setModules=function(M,F,K){}}function Gr(){}function zr(){this.setModules=function(M,F){}}function Ur(M,F,K){arguments.length!=3&&(console.error("WARN: Mp3Encoder(channels, samplerate, kbps) not specified"),M=1,F=44100,K=128);var q=new _e,o0=new Yr,X=new ft,J=new E1,h0=new qr,m0=new Xr,C=new Zr,s0=new $r,b=new Or,w=new zr,B=new Pr,e=new Dr,L=new jr,I=new Gr;q.setModules(X,J,h0,m0,C,s0,b,w,I),J.setModules(X,I,b,s0),w.setModules(J,b),h0.setModules(q),C.setModules(J,B,m0,e),m0.setModules(e,B,q.enc.psy),B.setModules(J),e.setModules(m0),s0.setModules(q,J,b),o0.setModules(L,I),L.setModules(b,w,h0);var E=q.lame_init();E.num_channels=M,E.in_samplerate=F,E.brate=K,E.mode=Te.STEREO,E.quality=3,E.bWriteVbrTag=!1,E.disable_reservoir=!0,E.write_id3tag_automatic=!1,q.lame_init_params(E);var s=1152,d=0|1.25*s+7200,x=ya(d);this.encodeBuffer=function(y,R){M==1&&(R=y),Fr(y.length==R.length),y.length>s&&(s=y.length,d=0|1.25*s+7200,x=ya(d));var t=q.lame_encode_buffer(E,y,R,y.length,x,0,d);return new Int8Array(x.subarray(0,t))},this.flush=function(){var y=q.lame_encode_flush(E,x,0,d);return new Int8Array(x.subarray(0,y))}}function Nt(M){return M.charCodeAt(0)<<24|M.charCodeAt(1)<<16|M.charCodeAt(2)<<8|M.charCodeAt(3)}Nt("RIFF"),Nt("WAVE"),Nt("fmt "),Nt("data");var Kr=Ur,Sa=function(M,F){if(!(M instanceof F))throw new TypeError("Cannot call a class as a function")},Ma=function(){function M(F,K){for(var q=0;q<K.length;q++){var o0=K[q];o0.enumerable=o0.enumerable||!1,o0.configurable=!0,"value"in o0&&(o0.writable=!0),Object.defineProperty(F,o0.key,o0)}}return function(F,K,q){return K&&M(F.prototype,K),q&&M(F,q),F}}(),Qr=function(){function M(F){Sa(this,M),this.config={sampleRate:44100,bitRate:128},Object.assign(this.config,F),this.mp3Encoder=new Kr(1,this.config.sampleRate,this.config.bitRate),this.maxSamples=1152,this.samplesMono=null,this.clearBuffer()}return Ma(M,[{key:"clearBuffer",value:function(){this.dataBuffer=[]}},{key:"appendToBuffer",value:function(K){this.dataBuffer.push(new Int8Array(K))}},{key:"floatTo16BitPCM",value:function(K,q){for(var o0=0;o0<K.length;o0++){var X=Math.max(-1,Math.min(1,K[o0]));q[o0]=X<0?X*32768:X*32767}}},{key:"convertBuffer",value:function(K){var q=new Float32Array(K),o0=new Int16Array(K.length);return this.floatTo16BitPCM(q,o0),o0}},{key:"encode",value:function(K){this.samplesMono=this.convertBuffer(K);for(var q=this.samplesMono.length,o0=0;q>=0;o0+=this.maxSamples){var X=this.samplesMono.subarray(o0,o0+this.maxSamples),J=this.mp3Encoder.encodeBuffer(X);this.appendToBuffer(J),q-=this.maxSamples}}},{key:"finish",value:function(){return this.appendToBuffer(this.mp3Encoder.flush()),this.dataBuffer}}]),M}(),Wr=function(){function M(F){Sa(this,M),this.config={bitRate:128,startRecordingAt:300,deviceId:null},this.activeStream=null,this.context=null,this.microphone=null,this.processor=null,this.startTime=0,Object.assign(this.config,F)}return Ma(M,[{key:"addMicrophoneListener",value:function(K){var q=this;this.activeStream=K,this.timerToStart=setTimeout(function(){delete q.timerToStart},this.config.startRecordingAt),this.microphone=this.context.createMediaStreamSource(K),this.processor=this.context.createScriptProcessor(0,1,1),this.processor.onaudioprocess=function(o0){q.timerToStart||q.lameEncoder.encode(o0.inputBuffer.getChannelData(0))},this.microphone.connect(this.processor),this.processor.connect(this.context.destination)}},{key:"stop",value:function(){return this.processor&&this.microphone&&(this.microphone.disconnect(),this.processor.disconnect(),this.context&&this.context.state!=="closed"&&this.context.close(),this.processor.onaudioprocess=null,this.activeStream.getAudioTracks().forEach(function(K){return K.stop()})),this}},{key:"start",value:function(){var K=this,q=window.AudioContext||window.webkitAudioContext;this.context=new q,this.config.sampleRate=this.context.sampleRate,this.lameEncoder=new Qr(this.config);var o0=this.config.deviceId?{deviceId:{exact:this.config.deviceId}}:!0;return new Promise(function(X,J){navigator.mediaDevices.getUserMedia({audio:o0}).then(function(h0){K.addMicrophoneListener(h0),X(h0)}).catch(function(h0){J(h0)})})}},{key:"getMp3",value:function(){var K=this,q=this.lameEncoder.finish();return new Promise(function(o0,X){q.length===0?X(new Error("No buffer to send")):(o0([q,new Blob(q,{type:"audio/mp3"})]),K.lameEncoder.clearBuffer())})}}]),M}();return Wr})})(Ya);var ps=Ya.exports;const bs=rs(ps),xs={key:0,class:"flex justify-center items-center w-full px-6 md:px-4"},ws={class:"flex items-start space-x-4 bg-orange-100 rounded-lg p-2 mb-2 px-4"},ys={class:"text-sm"},Ss={class:"text-sm"},Ms={key:1,class:"flex justify-center items-center w-full px-6 md:px-4"},As={class:"flex items-center justify-between space-x-4 bg-orange-100 rounded-lg p-2 mb-2 px-4"},Rs={class:"flex items-start justify-between space-x-4"},Bs={class:"text-sm"},Es={class:"text-sm"},Ts={class:"absolute"},ks=["onKeydown","placeholder","disabled"],Cs=["accept"],gs=["disabled"],Is={key:1,xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"},Ls={class:"bg-white rounded-md w-full p-4"},Os=["onKeydown","placeholder","disabled"],Ns=["accept"],Vs={key:0,class:"bg-slate-50 rounded-lg border px-2 mb-2"},Hs={class:"flex items-center justify-between"},$s={class:"flex items-center"},Fs={class:"text-red-500 mr-2"},qs={key:0,class:"animate-pulse"},Xs={key:0,xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"},Zs={key:1,xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"},Ds={key:0,class:"text-sm"},Ps={key:1,class:"text-sm"},Ys={class:"flex gap-2"},js=["src"],Gs={class:"flex gap-x-4 items-center text-gray-600"},zs={class:"flex gap-x-4 text-sm items-center"},Us={class:"absolute"},Ks={class:"ms-[-5px]"},Qs={key:1,class:"text-[14px] flex items-center gap-2 bg-gray-100 p-1 px-2 rounded-md"},Ws={class:"ml-auto"},Js=["disabled"],e2={key:1,xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24"},t2={__name:"ChatForm",props:["contact","chatLimitReached","simpleForm"],emits:["response","viewTemplate"],setup(N,{emit:G}){const W=L0(null),S0=N,l0=L0(null),x0=L0(!1),_0=L0(null),I0=L0(!1);L0(null);const ee=L0([]),q0=L0(0),Y0=L0(null),D0=L0(0),j0=L0(null),K0=L0(0),E0=L0(null),M0=L0(!1),Z=L0(null),i0=L0(!1),z=L0({uuid:S0.contact.uuid,message:null,type:null,file:null}),W0=L0({uuid:S0.contact.uuid,message:null,type:null,file:null}),G0=L0(!1),we=L0(null);Fa(()=>{z.value.uuid=S0.contact.uuid});const ge=G,se=()=>{ge("viewTemplate",!0)},oe=async()=>{if(z.value.message=_0.value,l0.value=!0,z.value.message!=null||z.value.file!=null){const $0=new FormData;$0.append("message",z.value.message),$0.append("type",z.value.type),$0.append("uuid",z.value.uuid),z.value.file&&$0.append("file",z.value.file);try{const n0=await it.post("/chats",$0);i0.value==!0&&await ye(),z.value.message=null,_0.value=null,z.value.file=null,l0.value=!1}catch{}}else i0.value==!0&&await ye(),l0.value=!1},ye=async()=>{const $0=new FormData;$0.append("type",W0.value.type),$0.append("uuid",W0.value.uuid),W0.value.file&&$0.append("file",W0.value.file);try{const n0=await it.post("/chats",$0);i0.value==!0&&Ye()}catch{}},J0=L0(null),P0=()=>{const $0=J0.value;$0.style.height="auto",$0.style.height=$0.scrollHeight+"px"},ie=$0=>{_0.value!=null&&_0.value.trim()!=""&&oe()},Fe=qt(()=>{if(S0.contact.last_inbound_chat){const $0=new Date(S0.contact.last_inbound_chat.created_at);return new Date-$0<24*60*60*1e3}return!1}),d1=$0=>{const n0=$0.target.files[0],O0=new FileReader;O0.onload=A1=>{z.value.file=n0,oe()},O0.readAsDataURL(n0)},h1=()=>{switch(z.value.type){case"image":return".jpg, .png";case"document":return".txt, .pdf, .ppt, .doc, .xls, .docx, .pptx, .xlsx";case"audio":return".mp3, .ogg";case"video":return".mp4";default:return""}},t1=$0=>{$0.stopPropagation(),G0.value=!G0.value},We=()=>{G0.value=!1},a1=$0=>{const n0=J0.value,O0=_0.value||"",A1=n0.selectionStart||0,ce=n0.selectionEnd||0,Oe=O0.substring(0,A1)+$0.i+O0.substring(ce);_0.value=Oe,setTimeout(()=>{n0.focus(),n0.setSelectionRange(A1+$0.i.length,A1+$0.i.length)},0)},r1=$0=>{we.value&&!we.value.contains($0.target)&&!J0.value.contains($0.target)&&We()},S1=async()=>{try{i0.value=!0,await W.value.start(),I0.value=!0,f()}catch($0){console.error("Error accessing microphone:",$0)}},M1=async()=>{if(I0.value)try{const[$0,n0]=await W.value.stop().getMp3(),O0=new File($0,"audio-message.mp3",{type:n0.type,lastModified:Date.now()});E0.value=URL.createObjectURL(n0),W0.value.type="audio",W0.value.file=O0,I0.value=!1,k1()}catch($0){console.error("Error stopping recording:",$0)}},Ye=()=>{E0.value&&URL.revokeObjectURL(E0.value),E0.value=null,q0.value=0,D0.value=0,K0.value=0,ee.value=[],W0.value.type=null,W0.value.file=null,C1()},X0=()=>{Z.value&&(M0.value?(Z.value.pause(),C1()):(Z.value.play(),H1()),M0.value=!M0.value)},f=()=>{q0.value=0,Y0.value=setInterval(()=>{q0.value++},1e3)},H1=()=>{D0.value=0,j0.value=setInterval(()=>{Z.value&&(D0.value=Math.floor(Z.value.currentTime))},100)},k1=()=>{Y0.value&&(clearInterval(Y0.value),Y0.value=null)},C1=()=>{j0.value&&(clearInterval(j0.value),j0.value=null)},g1=$0=>{const n0=Math.floor($0/60),O0=$0%60;return`${n0.toString().padStart(2,"0")}:${O0.toString().padStart(2,"0")}`},s1=async()=>{var $0,n0;x0.value=!0;try{const O0=await it.get("/automation/chat/suggestion",{params:{contact:S0.contact.uuid}});O0.data.success?(z.value.type="text",_0.value=O0.data.data.text):console.error("Failed to get suggestion:",O0.data.message)}catch(O0){console.error("Error getting suggestion:",((n0=($0=O0.response)==null?void 0:$0.data)==null?void 0:n0.message)||O0.message)}finally{x0.value=!1}};return Mt(()=>{document.addEventListener("click",r1),W.value=new bs({bitRate:128})}),_a(()=>{document.removeEventListener("click",r1),k1(),C1(),E0.value&&URL.revokeObjectURL(E0.value)}),($0,n0)=>(U(),r0(v1,null,[S0.chatLimitReached?(U(),r0("div",xs,[p("div",ws,[n0[21]||(n0[21]=Qe('<span class="text-red-700"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 36 36"><path fill="currentColor" d="M18 21.32a1.3 1.3 0 0 0 1.3-1.3V14a1.3 1.3 0 1 0-2.6 0v6a1.3 1.3 0 0 0 1.3 1.32Z" class="clr-i-outline clr-i-outline-path-1"></path><circle cx="17.95" cy="24.27" r="1.5" fill="currentColor" class="clr-i-outline clr-i-outline-path-2"></circle><path fill="currentColor" d="M30.33 25.54L20.59 7.6a3 3 0 0 0-5.27 0L5.57 25.54A3 3 0 0 0 8.21 30h19.48a3 3 0 0 0 2.64-4.43Zm-1.78 1.94a1 1 0 0 1-.86.49H8.21a1 1 0 0 1-.88-1.48l9.74-17.94a1 1 0 0 1 1.76 0l9.74 17.94a1 1 0 0 1-.02.99Z" class="clr-i-outline clr-i-outline-path-3"></path><path fill="none" d="M0 0h36v36H0z"></path></svg></span>',1)),p("div",null,[p("div",ys,R0($0.$t("Maximum chat limit reached")),1),p("div",Ss,R0($0.$t("You have reached the maximum chat limit for your subscription! Please upgrade to send/receive more messages")),1)])])])):g0("",!0),!Fe.value&&!S0.chatLimitReached?(U(),r0("div",Ms,[p("div",As,[p("div",Rs,[n0[22]||(n0[22]=Qe('<span class="text-red-700"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 36 36"><path fill="currentColor" d="M18 21.32a1.3 1.3 0 0 0 1.3-1.3V14a1.3 1.3 0 1 0-2.6 0v6a1.3 1.3 0 0 0 1.3 1.32Z" class="clr-i-outline clr-i-outline-path-1"></path><circle cx="17.95" cy="24.27" r="1.5" fill="currentColor" class="clr-i-outline clr-i-outline-path-2"></circle><path fill="currentColor" d="M30.33 25.54L20.59 7.6a3 3 0 0 0-5.27 0L5.57 25.54A3 3 0 0 0 8.21 30h19.48a3 3 0 0 0 2.64-4.43Zm-1.78 1.94a1 1 0 0 1-.86.49H8.21a1 1 0 0 1-.88-1.48l9.74-17.94a1 1 0 0 1 1.76 0l9.74 17.94a1 1 0 0 1-.02.99Z" class="clr-i-outline clr-i-outline-path-3"></path><path fill="none" d="M0 0h36v36H0z"></path></svg></span>',1)),p("div",null,[p("div",Bs,R0($0.$t("24 hour limit")),1),p("div",Es,R0($0.$t("Whatsapp does not allow sending messages 24 hours after they last messaged you. However, you can send them a template message")),1)])]),p("button",{onClick:n0[0]||(n0[0]=O0=>se()),class:"rounded-md bg-primary px-3 py-1 text-sm text-white shadow-sm w-[25%]"},"Send Template")])])):g0("",!0),N.simpleForm&&Fe.value&&!S0.chatLimitReached?(U(),r0("form",{key:2,onSubmit:n0[9]||(n0[9]=Q1(O0=>oe(),["prevent"])),class:"flex items-center px-2 md:px-10 space-x-2"},[p("div",{class:Ce(["flex items-center w-full rounded-lg py-4 md:py-2 pl-2 pr-2",l0.value?"bg-gray-200":"bg-white"])},[p("div",Ts,[p("button",{type:"button",onClick:t1},""),G0.value?(U(),r0("div",{key:0,class:"absolute left-0 bottom-full",ref_key:"emojiPickerRef",ref:we},[Re(xe(La),{native:!0,onSelect:a1})],512)):g0("",!0)]),ia(p("textarea",{ref_key:"textInputRef",ref:J0,onFocus:n0[1]||(n0[1]=O0=>z.value.type="text"),onKeydown:Ia(Q1(ie,["exact","prevent"]),["enter"]),class:Ce(["w-full ml-3 outline-none resize-none text-sm md:text-base pl-6",l0.value?"bg-gray-200":"bg-white"]),"onUpdate:modelValue":n0[2]||(n0[2]=O0=>_0.value=O0),onInput:P0,type:"text",rows:"1",placeholder:$0.$t("Type your message..."),disabled:l0.value},"            ",42,ks),[[la,_0.value]]),p("input",{type:"file",class:"sr-only",accept:h1(),id:"file-upload",onChange:n0[3]||(n0[3]=O0=>d1(O0))},null,40,Cs),p("label",{onClick:n0[4]||(n0[4]=O0=>z.value.type="image"),for:"file-upload",class:"text-slate-500 mr-2 cursor-pointer"},n0[23]||(n0[23]=[Qe('<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><g fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5"><path d="M6.5 8a2 2 0 1 0 4 0a2 2 0 0 0-4 0Zm14.427 1.99c-6.61-.908-12.31 4-11.927 10.51"></path><path d="M3 13.066c2.78-.385 5.275.958 6.624 3.1"></path><path d="M3 12c0-4.243 0-6.364 1.318-7.682C5.636 3 7.758 3 12 3c4.243 0 6.364 0 7.682 1.318C21 5.636 21 7.758 21 12c0 4.243 0 6.364-1.318 7.682C18.364 21 16.242 21 12 21c-4.243 0-6.364 0-7.682-1.318C3 18.364 3 16.242 3 12Z"></path></g></svg>',1)])),p("label",{onClick:n0[5]||(n0[5]=O0=>z.value.type="document"),for:"file-upload",class:"text-slate-500 mr-1 cursor-pointer"},n0[24]||(n0[24]=[p("svg",{xmlns:"http://www.w3.org/2000/svg",width:"22",height:"22",viewBox:"0 0 24 24"},[p("g",{fill:"none",stroke:"currentColor","stroke-width":"1.5"},[p("path",{d:"M3 10c0-3.771 0-5.657 1.172-6.828C5.343 2 7.229 2 11 2h2c3.771 0 5.657 0 6.828 1.172C21 4.343 21 6.229 21 10v4c0 3.771 0 5.657-1.172 6.828C18.657 22 16.771 22 13 22h-2c-3.771 0-5.657 0-6.828-1.172C3 19.657 3 17.771 3 14v-4Z"}),p("path",{"stroke-linecap":"round",d:"M8 10h8m-8 4h5"})])],-1)])),p("label",{onClick:n0[6]||(n0[6]=O0=>z.value.type="audio"),for:"file-upload",class:"text-slate-500 mr-1 cursor-pointer"},n0[25]||(n0[25]=[p("svg",{xmlns:"http://www.w3.org/2000/svg",width:"22",height:"22",viewBox:"0 0 1024 1024"},[p("path",{fill:"currentColor",d:"M842 454c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8c0 140.3-113.7 254-254 254S258 594.3 258 454c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8c0 168.7 126.6 307.9 290 327.6V884H326.7c-13.7 0-24.7 14.3-24.7 32v36c0 4.4 2.8 8 6.2 8h407.6c3.4 0 6.2-3.6 6.2-8v-36c0-17.7-11-32-24.7-32H548V782.1c165.3-18 294-158 294-328.1M512 624c93.9 0 170-75.2 170-168V232c0-92.8-76.1-168-170-168s-170 75.2-170 168v224c0 92.8 76.1 168 170 168m-94-392c0-50.6 41.9-92 94-92s94 41.4 94 92v224c0 50.6-41.9 92-94 92s-94-41.4-94-92z"})],-1)])),p("label",{onClick:n0[7]||(n0[7]=O0=>z.value.type="video"),for:"file-upload",class:"text-slate-500 mr-2 cursor-pointer"},n0[26]||(n0[26]=[p("svg",{xmlns:"http://www.w3.org/2000/svg",width:"28",height:"28",viewBox:"0 0 32 32"},[p("path",{fill:"currentColor",d:"M6.5 5.5A4.5 4.5 0 0 0 2 10v12a4.5 4.5 0 0 0 4.5 4.5h12A4.5 4.5 0 0 0 23 22v-1.5l4.2 3.15c1.153.865 2.8.042 2.8-1.4V9.75c0-1.442-1.647-2.265-2.8-1.4L23 11.5V10a4.5 4.5 0 0 0-4.5-4.5zM23 14l5-3.75v11.5L23 18zm-2-4v12a2.5 2.5 0 0 1-2.5 2.5h-12A2.5 2.5 0 0 1 4 22V10a2.5 2.5 0 0 1 2.5-2.5h12A2.5 2.5 0 0 1 21 10"})],-1)])),p("label",{onClick:n0[8]||(n0[8]=O0=>se()),class:"text-slate-500 mr-4 cursor-pointer"},n0[27]||(n0[27]=[p("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 256 256"},[p("path",{fill:"currentColor",d:"M216 80h-32V48a16 16 0 0 0-16-16H40a16 16 0 0 0-16 16v128a8 8 0 0 0 13 6.22L72 154v30a16 16 0 0 0 16 16h93.59L219 230.22a8 8 0 0 0 5 1.78a8 8 0 0 0 8-8V96a16 16 0 0 0-16-16M66.55 137.78L40 159.25V48h128v88H71.58a8 8 0 0 0-5.03 1.78M216 207.25l-26.55-21.47a8 8 0 0 0-5-1.78H88v-32h80a16 16 0 0 0 16-16V96h32Z"})],-1)])),p("button",{class:"flex items-center",type:"submit",disabled:_0.value===null||_0.value.trim()===""||l0.value},[l0.value?(U(),r0("svg",Is,n0[29]||(n0[29]=[Qe('<circle cx="12" cy="2" r="0" fill="currentColor"><animate attributeName="r" begin="0" calcMode="spline" dur="1s" keySplines="0.2 0.2 0.4 0.8;0.2 0.2 0.4 0.8;0.2 0.2 0.4 0.8" repeatCount="indefinite" values="0;2;0;0"></animate></circle><circle cx="12" cy="2" r="0" fill="currentColor" transform="rotate(45 12 12)"><animate attributeName="r" begin="0.125s" calcMode="spline" dur="1s" keySplines="0.2 0.2 0.4 0.8;0.2 0.2 0.4 0.8;0.2 0.2 0.4 0.8" repeatCount="indefinite" values="0;2;0;0"></animate></circle><circle cx="12" cy="2" r="0" fill="currentColor" transform="rotate(90 12 12)"><animate attributeName="r" begin="0.25s" calcMode="spline" dur="1s" keySplines="0.2 0.2 0.4 0.8;0.2 0.2 0.4 0.8;0.2 0.2 0.4 0.8" repeatCount="indefinite" values="0;2;0;0"></animate></circle><circle cx="12" cy="2" r="0" fill="currentColor" transform="rotate(135 12 12)"><animate attributeName="r" begin="0.375s" calcMode="spline" dur="1s" keySplines="0.2 0.2 0.4 0.8;0.2 0.2 0.4 0.8;0.2 0.2 0.4 0.8" repeatCount="indefinite" values="0;2;0;0"></animate></circle><circle cx="12" cy="2" r="0" fill="currentColor" transform="rotate(180 12 12)"><animate attributeName="r" begin="0.5s" calcMode="spline" dur="1s" keySplines="0.2 0.2 0.4 0.8;0.2 0.2 0.4 0.8;0.2 0.2 0.4 0.8" repeatCount="indefinite" values="0;2;0;0"></animate></circle><circle cx="12" cy="2" r="0" fill="currentColor" transform="rotate(225 12 12)"><animate attributeName="r" begin="0.625s" calcMode="spline" dur="1s" keySplines="0.2 0.2 0.4 0.8;0.2 0.2 0.4 0.8;0.2 0.2 0.4 0.8" repeatCount="indefinite" values="0;2;0;0"></animate></circle><circle cx="12" cy="2" r="0" fill="currentColor" transform="rotate(270 12 12)"><animate attributeName="r" begin="0.75s" calcMode="spline" dur="1s" keySplines="0.2 0.2 0.4 0.8;0.2 0.2 0.4 0.8;0.2 0.2 0.4 0.8" repeatCount="indefinite" values="0;2;0;0"></animate></circle><circle cx="12" cy="2" r="0" fill="currentColor" transform="rotate(315 12 12)"><animate attributeName="r" begin="0.875s" calcMode="spline" dur="1s" keySplines="0.2 0.2 0.4 0.8;0.2 0.2 0.4 0.8;0.2 0.2 0.4 0.8" repeatCount="indefinite" values="0;2;0;0"></animate></circle>',8)]))):(U(),r0("svg",{key:0,class:Ce(_0.value===null||_0.value.trim()===""?"text-slate-300":"text-black"),xmlns:"http://www.w3.org/2000/svg",width:"22",height:"22",viewBox:"0 0 16 16"},n0[28]||(n0[28]=[p("path",{fill:"currentColor",d:"M1.724 1.053a.5.5 0 0 0-.714.545l1.403 4.85a.5.5 0 0 0 .397.354l5.69.953c.268.053.268.437 0 .49l-5.69.953a.5.5 0 0 0-.397.354l-1.403 4.85a.5.5 0 0 0 .714.545l13-6.5a.5.5 0 0 0 0-.894l-13-6.5Z"},null,-1)]),2))],8,gs)],2)],32)):g0("",!0),!N.simpleForm&&Fe.value&&!S0.chatLimitReached?(U(),r0("form",{key:3,onSubmit:n0[20]||(n0[20]=Q1(O0=>oe(),["prevent"])),class:"flex items-center px-2 md:px-10 space-x-2"},[p("div",Ls,[p("div",null,[ia(p("textarea",{ref_key:"textInputRef",ref:J0,onFocus:n0[10]||(n0[10]=O0=>z.value.type="text"),onKeydown:Ia(Q1(ie,["exact","prevent"]),["enter"]),class:Ce(["w-full outline-none resize-none text-sm rounded-md p-2",l0.value?"bg-gray-100":"bg-white"]),"onUpdate:modelValue":n0[11]||(n0[11]=O0=>_0.value=O0),onInput:P0,type:"text",rows:"3",placeholder:$0.$t("Type your message..."),disabled:l0.value},"                ",42,Os),[[la,_0.value]]),p("input",{type:"file",class:"sr-only",accept:h1(),id:"file-upload",onChange:n0[12]||(n0[12]=O0=>d1(O0))},null,40,Ns)]),I0.value||E0.value?(U(),r0("div",Vs,[p("div",Hs,[p("div",$s,[p("span",Fs,[I0.value?(U(),r0("span",qs,n0[30]||(n0[30]=[p("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"},[p("circle",{cx:"12",cy:"12",r:"7",fill:"red",opacity:"0.5"}),p("path",{fill:"#fee2e2","fill-rule":"evenodd",d:"M12 22c5.523 0 10-4.477 10-10S17.523 2 12 2S2 6.477 2 12s4.477 10 10 10m0-3a7 7 0 1 0 0-14a7 7 0 0 0 0 14","clip-rule":"evenodd"})],-1)]))):g0("",!0),E0.value?(U(),r0("span",{key:1,onClick:X0},[M0.value?(U(),r0("svg",Zs,n0[32]||(n0[32]=[p("path",{fill:"none",stroke:"red","stroke-linecap":"round","stroke-width":"1.5",d:"M2 18c0 1.886 0 2.828.586 3.414S4.114 22 6 22s2.828 0 3.414-.586S10 19.886 10 18V6c0-1.886 0-2.828-.586-3.414S7.886 2 6 2s-2.828 0-3.414.586S2 4.114 2 6v8m20-8c0-1.886 0-2.828-.586-3.414S19.886 2 18 2s-2.828 0-3.414.586S14 4.114 14 6v12c0 1.886 0 2.828.586 3.414S16.114 22 18 22s2.828 0 3.414-.586S22 19.886 22 18v-8"},null,-1)]))):(U(),r0("svg",Xs,n0[31]||(n0[31]=[p("path",{fill:"#22c55e",stroke:"#22c55e","stroke-linecap":"round","stroke-width":"1.5",d:"M3 12v6.967c0 2.31 2.534 3.769 4.597 2.648l3.203-1.742M3 8V5.033c0-2.31 2.534-3.769 4.597-2.648l12.812 6.968a2.998 2.998 0 0 1 0 5.294l-6.406 3.484"},null,-1)])))])):g0("",!0)]),I0.value?(U(),r0("span",Ds,R0(g1(q0.value)),1)):(U(),r0("span",Ps,R0(g1(D0.value))+" / "+R0(g1(q0.value)),1))]),p("div",Ys,[I0.value?(U(),r0("button",{key:0,onClick:M1,class:"p-2 rounded-full hover:bg-red-100",title:"Stop Recording"},n0[33]||(n0[33]=[p("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"},[p("path",{fill:"red",stroke:"red","stroke-width":"1.5",d:"M2 12c0-4.714 0-7.071 1.464-8.536C4.93 2 7.286 2 12 2s7.071 0 8.535 1.464C22 4.93 22 7.286 22 12s0 7.071-1.465 8.535C19.072 22 16.714 22 12 22s-7.071 0-8.536-1.465C2 19.072 2 16.714 2 12Z"})],-1)]))):g0("",!0),E0.value?(U(),r0("button",{key:1,onClick:Ye,class:"p-2 rounded-full hover:bg-red-100 text-red-500",title:"Delete Recording"},n0[34]||(n0[34]=[p("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"},[p("path",{fill:"none",stroke:"red","stroke-linecap":"round","stroke-width":"1.5",d:"M9.17 4a3.001 3.001 0 0 1 5.66 0m5.67 2h-17m14.874 9.4c-.177 2.654-.266 3.981-1.131 4.79s-2.195.81-4.856.81h-.774c-2.66 0-3.99 0-4.856-.81c-.865-.809-.953-2.136-1.13-4.79l-.46-6.9m13.666 0l-.2 3M9.5 11l.5 5m4.5-5l-.5 5"})],-1)]))):g0("",!0)])]),p("audio",{ref_key:"audioPlayer",ref:Z,src:E0.value,onEnded:n0[13]||(n0[13]=O0=>M0.value=!1),class:"hidden"},null,40,js)])):g0("",!0),p("div",Gs,[p("div",{onClick:n0[14]||(n0[14]=O0=>se()),class:"flex gap-x-1 text-sm items-center"},[n0[35]||(n0[35]=p("span",null,[p("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 256 256"},[p("path",{fill:"currentColor",d:"M216 80h-32V48a16 16 0 0 0-16-16H40a16 16 0 0 0-16 16v128a8 8 0 0 0 13 6.22L72 154v30a16 16 0 0 0 16 16h93.59L219 230.22a8 8 0 0 0 5 1.78a8 8 0 0 0 8-8V96a16 16 0 0 0-16-16M66.55 137.78L40 159.25V48h128v88H71.58a8 8 0 0 0-5.03 1.78M216 207.25l-26.55-21.47a8 8 0 0 0-5-1.78H88v-32h80a16 16 0 0 0 16-16V96h32Z"})])],-1)),p("button",null,R0($0.$t("Templates")),1)]),n0[46]||(n0[46]=p("div",null,"|",-1)),p("div",zs,[p("div",null,[p("button",{type:"button",class:"py-1",onClick:t1},n0[36]||(n0[36]=[p("span",null,[p("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 16 16"},[p("path",{fill:"currentColor","fill-rule":"evenodd",d:"M4.111 2.18a7 7 0 1 1 7.778 11.64A7 7 0 0 1 4.11 2.18zm.556 10.809a6 6 0 1 0 6.666-9.978a6 6 0 0 0-6.666 9.978M6.5 7a1 1 0 1 1-2 0a1 1 0 0 1 2 0m5 0a1 1 0 1 1-2 0a1 1 0 0 1 2 0M8 11a3 3 0 0 1-2.65-1.58l-.87.48a4 4 0 0 0 7.12-.16l-.9-.43A3 3 0 0 1 8 11","clip-rule":"evenodd"})])],-1)])),p("div",Us,[G0.value?(U(),r0("div",{key:0,class:"absolute left-0 bottom-full",ref_key:"emojiPickerRef",ref:we},[Re(xe(La),{native:!0,onSelect:a1})],512)):g0("",!0)])]),p("div",null,[p("label",{class:"py-1 cursor-pointer",onClick:n0[15]||(n0[15]=O0=>z.value.type="document"),for:"file-upload"},n0[37]||(n0[37]=[p("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 56 56"},[p("path",{fill:"currentColor",d:"M44.09 28.867L26.863 46.094c-4.476 4.5-10.5 4.054-14.343.164c-3.867-3.844-4.313-9.82.187-14.32L36.191 8.453c2.696-2.695 6.657-3.07 9.235-.515c2.555 2.601 2.18 6.539-.492 9.234L21.988 40.14c-1.171 1.195-2.554.843-3.375.047c-.796-.82-1.125-2.18.047-3.376l16.031-16.007c.704-.727.75-1.758.07-2.438c-.679-.656-1.71-.61-2.413.094L16.246 34.563c-2.39 2.39-2.297 6.046-.187 8.156c2.297 2.297 5.789 2.25 8.18-.164l23.085-23.063c4.383-4.383 4.172-10.148.375-13.969c-3.75-3.726-9.586-4.007-13.992.375L10.082 29.547c-5.789 5.789-5.344 14.062-.117 19.289c5.227 5.203 13.5 5.648 19.289-.117l17.344-17.344c.703-.68.68-1.922-.024-2.555c-.68-.726-1.78-.633-2.484.047"})],-1)]))]),p("div",null,[p("label",{onClick:n0[16]||(n0[16]=O0=>z.value.type="audio"),class:"py-1 cursor-pointer",for:"file-upload"},n0[38]||(n0[38]=[p("svg",{xmlns:"http://www.w3.org/2000/svg",width:"22",height:"22",viewBox:"0 0 24 24"},[p("g",{fill:"none",stroke:"currentColor","stroke-width":"1.5"},[p("path",{d:"M9 19a3 3 0 1 1-6 0a3 3 0 0 1 6 0Zm12-2a3 3 0 1 1-6 0a3 3 0 0 1 6 0ZM9 19V8m12 9V6"}),p("path",{"stroke-linecap":"round",d:"m15.735 3.755l-4 1.333c-1.32.44-1.98.66-2.357 1.184S9 7.492 9 8.882V12l12-4v-.45c0-2.533 0-3.8-.83-4.398c-.831-.599-2.032-.198-4.435.603Z"})])],-1)]))]),p("div",null,[p("label",{onClick:n0[17]||(n0[17]=O0=>z.value.type="video"),class:"py-1 cursor-pointer",for:"file-upload"},n0[39]||(n0[39]=[p("svg",{xmlns:"http://www.w3.org/2000/svg",width:"28",height:"28",viewBox:"0 0 32 32"},[p("path",{fill:"currentColor",d:"M6.5 5.5A4.5 4.5 0 0 0 2 10v12a4.5 4.5 0 0 0 4.5 4.5h12A4.5 4.5 0 0 0 23 22v-1.5l4.2 3.15c1.153.865 2.8.042 2.8-1.4V9.75c0-1.442-1.647-2.265-2.8-1.4L23 11.5V10a4.5 4.5 0 0 0-4.5-4.5zM23 14l5-3.75v11.5L23 18zm-2-4v12a2.5 2.5 0 0 1-2.5 2.5h-12A2.5 2.5 0 0 1 4 22V10a2.5 2.5 0 0 1 2.5-2.5h12A2.5 2.5 0 0 1 21 10"})],-1)]))]),p("div",null,[p("label",{class:"py-1 cursor-pointer",onClick:n0[18]||(n0[18]=O0=>z.value.type="image"),for:"file-upload"},n0[40]||(n0[40]=[Qe('<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><g fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5"><path d="M6.5 8a2 2 0 1 0 4 0a2 2 0 0 0-4 0Zm14.427 1.99c-6.61-.908-12.31 4-11.927 10.51"></path><path d="M3 13.066c2.78-.385 5.275.958 6.624 3.1"></path><path d="M3 12c0-4.243 0-6.364 1.318-7.682C5.636 3 7.758 3 12 3c4.243 0 6.364 0 7.682 1.318C21 5.636 21 7.758 21 12c0 4.243 0 6.364-1.318 7.682C18.364 21 16.242 21 12 21c-4.243 0-6.364 0-7.682-1.318C3 18.364 3 16.242 3 12Z"></path></g></svg>',1)]))])]),n0[47]||(n0[47]=p("div",null,"|",-1)),!I0.value&&!E0.value?(U(),r0("button",{key:0,type:"button",class:"py-1 cursor-pointer relative",onClick:S1},n0[41]||(n0[41]=[p("span",{class:"relative"},[p("svg",{xmlns:"http://www.w3.org/2000/svg",width:"22",height:"22",viewBox:"0 0 1024 1024"},[p("path",{fill:"currentColor",d:"M842 454c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8c0 140.3-113.7 254-254 254S258 594.3 258 454c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8c0 168.7 126.6 307.9 290 327.6V884H326.7c-13.7 0-24.7 14.3-24.7 32v36c0 4.4 2.8 8 6.2 8h407.6c3.4 0 6.2-3.6 6.2-8v-36c0-17.7-11-32-24.7-32H548V782.1c165.3-18 294-158 294-328.1M512 624c93.9 0 170-75.2 170-168V232c0-92.8-76.1-168-170-168s-170 75.2-170 168v224c0 92.8 76.1 168 170 168m-94-392c0-50.6 41.9-92 94-92s94 41.4 94 92v224c0 50.6-41.9 92-94 92s-94-41.4-94-92z"})])],-1)]))):g0("",!0),p("div",Ks,[x0.value?(U(),r0("div",Qs,[p("span",null,R0($0.$t("Searching for suggestions")),1),n0[43]||(n0[43]=Qe('<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><circle cx="18" cy="12" r="0" fill="currentColor"><animate attributeName="r" begin=".67" calcMode="spline" dur="1.5s" keySplines="0.2 0.2 0.4 0.8;0.2 0.2 0.4 0.8;0.2 0.2 0.4 0.8" repeatCount="indefinite" values="0;2;0;0"></animate></circle><circle cx="12" cy="12" r="0" fill="currentColor"><animate attributeName="r" begin=".33" calcMode="spline" dur="1.5s" keySplines="0.2 0.2 0.4 0.8;0.2 0.2 0.4 0.8;0.2 0.2 0.4 0.8" repeatCount="indefinite" values="0;2;0;0"></animate></circle><circle cx="6" cy="12" r="0" fill="currentColor"><animate attributeName="r" begin="0" calcMode="spline" dur="1.5s" keySplines="0.2 0.2 0.4 0.8;0.2 0.2 0.4 0.8;0.2 0.2 0.4 0.8" repeatCount="indefinite" values="0;2;0;0"></animate></circle></svg>',1))])):(U(),r0("button",{key:0,class:"text-[14px] flex items-center gap-2 hover:bg-gray-100 p-1 rounded-md",type:"button",onClick:n0[19]||(n0[19]=O0=>s1())},[n0[42]||(n0[42]=Qe('<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><g fill="none" stroke="#000" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" color="#000"><path d="m7 8l2.942 1.74c1.715 1.014 2.4 1.014 4.116 0L17 8"></path><path d="M21.984 12.976c.021-.986.021-1.966 0-2.952c-.065-3.065-.098-4.598-1.229-5.733c-1.131-1.136-2.705-1.175-5.854-1.254a115 115 0 0 0-5.802 0c-3.149.079-4.723.118-5.854 1.254c-1.131 1.135-1.164 2.668-1.23 5.733a69 69 0 0 0 0 2.952c.066 3.065.099 4.598 1.23 5.733c1.131 1.136 2.705 1.175 5.854 1.254c1.305.033 2.601.044 3.901.033"></path><path d="m18.5 14l.258.697c.338.914.507 1.371.84 1.704c.334.334.791.503 1.705.841L22 17.5l-.697.258c-.914.338-1.371.507-1.704.84c-.334.334-.503.791-.841 1.705L18.5 21l-.258-.697c-.338-.914-.507-1.371-.84-1.704c-.334-.334-.791-.503-1.705-.841L15 17.5l.697-.258c.914-.338 1.371-.507 1.704-.84c.334-.334.503-.791.841-1.705z"></path></g></svg>',1)),p("span",null,R0($0.$t("AI Assist")),1)]))]),p("div",Ws,[p("button",{class:"flex items-center gap-x-2 p-1 px-2 rounded-md border border-gray-400 text-sm",disabled:(_0.value===null||_0.value.trim()==="")&&!W0.value.file},[p("span",{class:Ce((_0.value===null||_0.value.trim()==="")&&!W0.value.file?"text-slate-300":"text-black")},"Send",2),p("div",null,[l0.value?(U(),r0("svg",e2,n0[45]||(n0[45]=[Qe('<circle cx="12" cy="2" r="0" fill="currentColor"><animate attributeName="r" begin="0" calcMode="spline" dur="1s" keySplines="0.2 0.2 0.4 0.8;0.2 0.2 0.4 0.8;0.2 0.2 0.4 0.8" repeatCount="indefinite" values="0;2;0;0"></animate></circle><circle cx="12" cy="2" r="0" fill="currentColor" transform="rotate(45 12 12)"><animate attributeName="r" begin="0.125s" calcMode="spline" dur="1s" keySplines="0.2 0.2 0.4 0.8;0.2 0.2 0.4 0.8;0.2 0.2 0.4 0.8" repeatCount="indefinite" values="0;2;0;0"></animate></circle><circle cx="12" cy="2" r="0" fill="currentColor" transform="rotate(90 12 12)"><animate attributeName="r" begin="0.25s" calcMode="spline" dur="1s" keySplines="0.2 0.2 0.4 0.8;0.2 0.2 0.4 0.8;0.2 0.2 0.4 0.8" repeatCount="indefinite" values="0;2;0;0"></animate></circle><circle cx="12" cy="2" r="0" fill="currentColor" transform="rotate(135 12 12)"><animate attributeName="r" begin="0.375s" calcMode="spline" dur="1s" keySplines="0.2 0.2 0.4 0.8;0.2 0.2 0.4 0.8;0.2 0.2 0.4 0.8" repeatCount="indefinite" values="0;2;0;0"></animate></circle><circle cx="12" cy="2" r="0" fill="currentColor" transform="rotate(180 12 12)"><animate attributeName="r" begin="0.5s" calcMode="spline" dur="1s" keySplines="0.2 0.2 0.4 0.8;0.2 0.2 0.4 0.8;0.2 0.2 0.4 0.8" repeatCount="indefinite" values="0;2;0;0"></animate></circle><circle cx="12" cy="2" r="0" fill="currentColor" transform="rotate(225 12 12)"><animate attributeName="r" begin="0.625s" calcMode="spline" dur="1s" keySplines="0.2 0.2 0.4 0.8;0.2 0.2 0.4 0.8;0.2 0.2 0.4 0.8" repeatCount="indefinite" values="0;2;0;0"></animate></circle><circle cx="12" cy="2" r="0" fill="currentColor" transform="rotate(270 12 12)"><animate attributeName="r" begin="0.75s" calcMode="spline" dur="1s" keySplines="0.2 0.2 0.4 0.8;0.2 0.2 0.4 0.8;0.2 0.2 0.4 0.8" repeatCount="indefinite" values="0;2;0;0"></animate></circle><circle cx="12" cy="2" r="0" fill="currentColor" transform="rotate(315 12 12)"><animate attributeName="r" begin="0.875s" calcMode="spline" dur="1s" keySplines="0.2 0.2 0.4 0.8;0.2 0.2 0.4 0.8;0.2 0.2 0.4 0.8" repeatCount="indefinite" values="0;2;0;0"></animate></circle>',8)]))):(U(),r0("svg",{key:0,class:Ce((_0.value===null||_0.value.trim()==="")&&!W0.value.file?"text-slate-300":"text-black"),xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},n0[44]||(n0[44]=[p("path",{fill:"currentColor",d:"M1.724 1.053a.5.5 0 0 0-.714.545l1.403 4.85a.5.5 0 0 0 .397.354l5.69.953c.268.053.268.437 0 .49l-5.69.953a.5.5 0 0 0-.397.354l-1.403 4.85a.5.5 0 0 0 .714.545l13-6.5a.5.5 0 0 0 0-.894l-13-6.5Z"},null,-1)]),2))])],8,Js)])])])],32)):g0("",!0)],64))}},a2={class:"h-20 bg-white border-b border-1 flex items-center justify-between px-4 md:px-4"},r2={class:"flex items-center gap-x-4 cursor-pointer w-3/4"},s2=["src"],n2={key:1,class:"rounded-full w-10 h-10 flex items-center justify-center bg-slate-100"},i2={class:"flex items-center w-full gap-x-8"},l2={class:"w-full flex items-center text-xs"},o2={class:"flex items-center space-x-4"},_2={key:0,class:"flex justify-between items-center bg-white border-b border-1 py-2 px-4 md:px-4"},u2={class:"flex items-center gap-x-2"},v2={class:"text-[13px]"},c2={class:"mt-5 grid grid-cols-1 gap-x-6 gap-y-4"},d2={class:"mt-4 flex"},h2=["disabled"],f2={key:0,xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24"},m2={key:1},p2={__name:"ChatHeader",props:["contact","displayContactInfo","ticketingIsEnabled","ticket","addon"],emits:["toggleView","deleteThread","closeThread"],setup(N,{emit:G}){var W0,G0,we,ge,se,oe,ye;const W=N,S0=qt(()=>qa().props.auth.user),l0=L0(!1),x0=L0(W.displayContactInfo),_0=L0(null),I0=L0(!1),ee=L0({label:(W0=W.ticket)!=null&&W0.user?(we=(G0=W.ticket)==null?void 0:G0.user)==null?void 0:we.full_name:ds("Unassigned"),value:(ge=W.ticket)!=null&&ge.user?(oe=(se=W.ticket)==null?void 0:se.user)==null?void 0:oe.id:0});Fa(()=>{var J0;x0.value=W.displayContactInfo,_0.value=(J0=W.ticket)==null?void 0:J0.status});const q0=G,Y0=()=>{x0.value=!x0.value,q0("toggleView",x0.value)},D0=()=>{wt.visit("/chats/"+W.contact.uuid,{method:"delete",onFinish:()=>{l0.value=!1}})};sa({status:_0});const j0=sa({notes:null,contact:null}),K0=sa({ai_assistant:(ye=W.contact)==null?void 0:ye.ai_assistance_enabled}),E0=J0=>{wt.put("/tickets/"+W.contact.uuid+"/update",{status:J0},{})},M0=()=>{wt.put("/tickets/"+W.contact.uuid+"/assign",{id:ee.value.value},{})};function Z(J0,P0){fetch("/team?search="+J0,{headers:{Accept:"application/json"}}).then(ie=>ie.json()).then(ie=>{P0(ie.rows)}).catch(ie=>{console.error("Error fetching agents:",ie)})}const i0=()=>{j0.contact=W.contact.uuid,j0.post("/notes",{preserveState:!1,onSuccess:()=>{j0.reset(),I0.value=!1}})},z=()=>{K0.ai_assistant=!K0.ai_assistant,K0.post("/automation/contact/"+W.contact.uuid,{preserveState:!0})};return(J0,P0)=>(U(),r0(v1,null,[p("div",a2,[p("div",r2,[Re(xe(st),{href:"/chats",class:"sm:block md:hidden"},{default:Ne(()=>P0[13]||(P0[13]=[p("svg",{xmlns:"http://www.w3.org/2000/svg",width:"2em",height:"2em",viewBox:"0 0 24 24"},[p("path",{fill:"currentColor",d:"M19 11H7.14l3.63-4.36a1 1 0 1 0-1.54-1.28l-5 6a1.19 1.19 0 0 0-.09.15c0 .05 0 .08-.07.13A1 1 0 0 0 4 12a1 1 0 0 0 .07.36c0 .05 0 .08.07.13a1.19 1.19 0 0 0 .09.15l5 6A1 1 0 0 0 10 19a1 1 0 0 0 .64-.23a1 1 0 0 0 .13-1.41L7.14 13H19a1 1 0 0 0 0-2"})],-1)])),_:1}),p("div",{onClick:Y0},[N.contact.avatar?(U(),r0("img",{key:0,class:"rounded-full w-14 h-14",src:N.contact.avatar},null,8,s2)):(U(),r0("div",n2,R0(N.contact.full_name.substring(0,1)),1))]),p("div",i2,[p("div",null,[p("div",{class:"flex items-center",onClick:Y0},[p("span",null,R0(N.contact.full_name),1)]),p("div",l2,[p("span",{onClick:Y0},R0(N.contact.formatted_phone_number),1)])]),N.ticketingIsEnabled&&S0.value.teams[0].role!="agent"?(U(),c1(vs,{key:0,modelValue:ee.value,"onUpdate:modelValue":[P0[0]||(P0[0]=ie=>ee.value=ie),P0[1]||(P0[1]=ie=>M0())],name:"",loadOptions:Z,class:Ce("col-span-1 md:block hidden"),placeholder:"Select Agent"},null,8,["modelValue"])):g0("",!0)])]),p("div",null,[p("div",o2,[_0.value==="open"&&N.ticketingIsEnabled?(U(),r0("button",{key:0,onClick:P0[2]||(P0[2]=ie=>E0("closed")),class:"text-sm md:inline-flex hidden justify-center rounded-md border border-transparent bg-red-800 px-4 py-1 text-white focus:outline-none focus-visible:ring-2 focus-visible:ring-blue-500 focus-visible:ring-offset-2"},R0(J0.$t("Mark as closed")),1)):g0("",!0),_0.value==="closed"&&N.ticketingIsEnabled?(U(),r0("button",{key:1,onClick:P0[3]||(P0[3]=ie=>E0("open")),class:"text-sm md:inline-flex hidden justify-center rounded-md border border-transparent bg-primary px-4 py-1 text-white focus:outline-none focus-visible:ring-2 focus-visible:ring-blue-500 focus-visible:ring-offset-2"},R0(J0.$t("Mark as open")),1)):g0("",!0),x0.value?(U(),r0("div",{key:3,onClick:Y0,class:"bg-slate-200 p-2 rounded-lg text-sm cursor-pointer"},[p("span",null,R0(J0.$t("Back")),1)])):(U(),c1(_s,{key:2},{items:Ne(()=>[Re(us,null,{default:Ne(()=>[Re($t,{onClick:P0[4]||(P0[4]=ie=>{I0.value=!0}),as:"button"},{default:Ne(()=>[Ve(R0(J0.$t("Add notes")),1)]),_:1}),_0.value==="open"&&N.ticketingIsEnabled?(U(),c1($t,{key:0,onClick:P0[5]||(P0[5]=ie=>E0("closed")),as:"button"},{default:Ne(()=>[Ve(R0(J0.$t("Mark as closed")),1)]),_:1})):g0("",!0),_0.value==="closed"&&N.ticketingIsEnabled?(U(),c1($t,{key:1,onClick:P0[6]||(P0[6]=ie=>E0("open")),as:"button"},{default:Ne(()=>[Ve(R0(J0.$t("Mark as open")),1)]),_:1})):g0("",!0),Re($t,{onClick:P0[7]||(P0[7]=ie=>l0.value=!0),as:"button"},{default:Ne(()=>[Ve(R0(J0.$t("Clear chat")),1)]),_:1})]),_:1})]),default:Ne(()=>[P0[14]||(P0[14]=p("button",{type:"button",class:"inline-flex w-full justify-center items-center rounded-md text-sm font-medium text-black hover:bg-opacity-30 focus:outline-none focus-visible:ring-2 focus-visible:ring-white focus-visible:ring-opacity-75"},[p("span",{class:"bg-slate-200 p-1 rounded-full cursor-pointer flex items-center justify-center"},[p("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"},[p("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"1.5",d:"M12 6.75a.75.75 0 1 1 0-1.5a.75.75 0 0 1 0 1.5Zm0 6a.75.75 0 1 1 0-1.5a.75.75 0 0 1 0 1.5Zm0 6a.75.75 0 1 1 0-1.5a.75.75 0 0 1 0 1.5Z"})])])],-1))]),_:1}))])])]),N.addon==1?(U(),r0("div",_2,[p("div",{class:Ce(["text-sm py-1 px-3 rounded-md flex items-center gap-x-2 w-[fit-content]",xe(K0).ai_assistant?"bg-green-50":"bg-red-50"])},[p("span",{class:Ce(xe(K0).ai_assistant?"text-green-500":"text-red-500")},P0[15]||(P0[15]=[p("svg",{xmlns:"http://www.w3.org/2000/svg",width:"10",height:"10",viewBox:"0 0 24 24"},[p("path",{fill:"currentColor",d:"M12 22q-2.075 0-3.9-.788t-3.175-2.137T2.788 15.9T2 12t.788-3.9t2.137-3.175T8.1 2.788T12 2t3.9.788t3.175 2.137T21.213 8.1T22 12t-.788 3.9t-2.137 3.175t-3.175 2.138T12 22"})],-1)]),2),p("span",null,R0(J0.$t("AI Assistant")),1)],2),p("div",u2,[p("span",v2,R0(J0.$t("Enable/disable AI assistant")),1),p("div",{class:Ce(["w-12 h-6 flex items-center bg-gray-300 rounded-full p-1 cursor-pointer",{"bg-primary":xe(K0).ai_assistant}]),onClick:P0[8]||(P0[8]=ie=>z())},[p("div",{class:Ce(["bg-white w-4 h-4 rounded-full shadow-md transform duration-300 ease-in-out",{"translate-x-6":xe(K0).ai_assistant}])},null,2)],2)])])):g0("",!0),Re(Pa,{label:"Add Note",isOpen:I0.value},{default:Ne(()=>[p("div",c2,[p("form",{onSubmit:P0[11]||(P0[11]=Q1(ie=>i0(),["prevent"])),class:""},[Re(cs,{modelValue:xe(j0).notes,"onUpdate:modelValue":P0[9]||(P0[9]=ie=>xe(j0).notes=ie),error:xe(j0).errors.note,name:"",class:Ce("col-span-2")},null,8,["modelValue","error"]),p("div",d2,[p("button",{type:"button",onClick:P0[10]||(P0[10]=Q1(ie=>I0.value=!1,["self"])),class:"inline-flex justify-center rounded-md border border-transparent bg-slate-50 px-4 py-2 text-sm text-slate-500 hover:bg-slate-200 focus:outline-none focus-visible:ring-2 focus-visible:ring-blue-500 focus-visible:ring-offset-2 mr-4"},R0(J0.$t("Cancel")),1),p("button",{class:Ce(["inline-flex justify-center rounded-md border border-transparent bg-primary px-4 py-2 text-sm text-white focus:outline-none focus-visible:ring-2 focus-visible:ring-blue-500 focus-visible:ring-offset-2",{"opacity-50":xe(j0).processing}]),disabled:xe(j0).processing},[xe(j0).processing?(U(),r0("svg",f2,P0[16]||(P0[16]=[p("path",{fill:"currentColor",d:"M12 2A10 10 0 1 0 22 12A10 10 0 0 0 12 2Zm0 18a8 8 0 1 1 8-8A8 8 0 0 1 12 20Z",opacity:".5"},null,-1),p("path",{fill:"currentColor",d:"M20 12h2A10 10 0 0 0 12 2V4A8 8 0 0 1 20 12Z"},[p("animateTransform",{attributeName:"transform",dur:"1s",from:"0 12 12",repeatCount:"indefinite",to:"360 12 12",type:"rotate"})],-1)]))):(U(),r0("span",m2,R0(J0.$t("Save")),1))],10,h2)])],32)])]),_:1},8,["isOpen"]),Re(os,{modelValue:l0.value,"onUpdate:modelValue":P0[12]||(P0[12]=ie=>l0.value=ie),label:J0.$t("Clear chat"),description:J0.$t("Are you sure you want to delete this thread? You can't undo this action"),onConfirm:D0},null,8,["modelValue","label","description"])],64))}},b2={class:"relative text-sm"},x2={class:"cursor-pointer flex items-center space-x-1 bg-slate-50 w-[fit-content] h-[fit-content] rounded-md p-1 px-2 text-sm"},w2={class:"capitalize"},y2={class:"text-slate-500"},S2={key:0,class:"absolute bg-white z-10 px-1 py-2 mt-2 shadow w-full rounded-md text-black"},M2={__name:"TicketStatusToggle",props:{languages:Object,currentLanguage:String,status:String,rowCount:Number},setup(N){const G=N,W=L0(!1),S0=()=>{W.value=!W.value},l0=_0=>{W.value&&!_0.target.closest(".status-dd")&&(W.value=!1)},x0=_0=>_0?_0.charAt(0).toUpperCase()+_0.slice(1):"";return Mt(()=>{document.body.addEventListener("click",l0)}),Xa(()=>{document.body.removeEventListener("click",l0)}),(_0,I0)=>(U(),r0("div",b2,[p("div",{onClick:I0[0]||(I0[0]=ee=>S0()),class:"status-dd"},[p("div",x2,[p("span",w2,R0(_0.$t(x0(G.status))),1),p("span",y2,R0(G.rowCount),1),I0[1]||(I0[1]=p("span",null,[p("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"},[p("path",{fill:"currentColor","fill-rule":"evenodd",d:"M16.53 8.97a.75.75 0 0 1 0 1.06l-4 4a.75.75 0 0 1-1.06 0l-4-4a.75.75 0 1 1 1.06-1.06L12 12.44l3.47-3.47a.75.75 0 0 1 1.06 0","clip-rule":"evenodd"})])],-1))])]),W.value?(U(),r0("div",S2,[p("div",null,[Re(xe(st),{href:"/chats?status=unassigned",class:"block px-2 py-1 cursor-pointer hover:bg-slate-100 rounded-md"},{default:Ne(()=>[Ve(R0(_0.$t("Unassigned")),1)]),_:1}),Re(xe(st),{href:"/chats?status=open",class:"block px-2 py-1 cursor-pointer hover:bg-slate-100 rounded-md"},{default:Ne(()=>[Ve(R0(_0.$t("Open")),1)]),_:1}),Re(xe(st),{href:"/chats?status=closed",class:"block px-2 py-1 cursor-pointer hover:bg-slate-100 rounded-md"},{default:Ne(()=>[Ve(R0(_0.$t("Closed")),1)]),_:1}),Re(xe(st),{href:"/chats?status=all",class:"block px-2 py-1 cursor-pointer hover:bg-slate-100 rounded-md"},{default:Ne(()=>[Ve(R0(_0.$t("All")),1)]),_:1})])])):g0("",!0)]))}},A2={class:"text-sm"},R2={key:0,xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 16 16"},B2={key:1,xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 16 16"},E2={key:0,class:"absolute bg-white z-10 px-1 py-2 mt-2 shadow w-[7em] rounded-md text-black"},T2={__name:"SortDirectionToggle",props:{direction:String,url:String},setup(N){const G=N,W=L0(!1),S0=()=>{W.value=!W.value},l0=_0=>{W.value&&!_0.target.closest(".sort-dd")&&(W.value=!1)};Mt(()=>{document.body.addEventListener("click",l0)}),Xa(()=>{document.body.removeEventListener("click",l0)});const x0=_0=>{wt.post(G.url,{sort:_0},{preserveState:!1})};return(_0,I0)=>(U(),r0("div",A2,[p("span",{onClick:I0[0]||(I0[0]=ee=>S0()),class:"cursor-pointer hover:bg-slate-50 p-1 rounded-full sort-dd block"},[N.direction=="desc"?(U(),r0("svg",R2,I0[3]||(I0[3]=[p("path",{fill:"currentColor",d:"M3.5 13.5a.5.5 0 0 1-1 0V4.707L1.354 5.854a.5.5 0 1 1-.708-.708l2-1.999l.007-.007a.5.5 0 0 1 .7.006l2 2a.5.5 0 1 1-.707.708L3.5 4.707zm4-9.5a.5.5 0 0 1 0-1h1a.5.5 0 0 1 0 1zm0 3a.5.5 0 0 1 0-1h3a.5.5 0 0 1 0 1zm0 3a.5.5 0 0 1 0-1h5a.5.5 0 0 1 0 1zM7 12.5a.5.5 0 0 0 .5.5h7a.5.5 0 0 0 0-1h-7a.5.5 0 0 0-.5.5"},null,-1)]))):(U(),r0("svg",B2,I0[4]||(I0[4]=[p("path",{fill:"currentColor",d:"M3.5 2.5a.5.5 0 0 0-1 0v8.793l-1.146-1.147a.5.5 0 0 0-.708.708l2 1.999l.007.007a.497.497 0 0 0 .7-.006l2-2a.5.5 0 0 0-.707-.708L3.5 11.293zm3.5 1a.5.5 0 0 1 .5-.5h7a.5.5 0 0 1 0 1h-7a.5.5 0 0 1-.5-.5M7.5 6a.5.5 0 0 0 0 1h5a.5.5 0 0 0 0-1zm0 3a.5.5 0 0 0 0 1h3a.5.5 0 0 0 0-1zm0 3a.5.5 0 0 0 0 1h1a.5.5 0 0 0 0-1z"},null,-1)])))]),W.value?(U(),r0("div",E2,[p("div",null,[p("div",{onClick:I0[1]||(I0[1]=ee=>x0("desc")),class:"block px-2 py-1 cursor-pointer hover:bg-slate-100 rounded-md"}," Newest "),p("div",{onClick:I0[2]||(I0[2]=ee=>x0("asc")),class:"block px-2 py-1 cursor-pointer hover:bg-slate-100 rounded-md"}," Oldest ")])])):g0("",!0)]))}},k2={class:"px-4 py-4 border-b"},C2={class:"flex items-center justify-between space-x-1 text-xl"},g2={class:"flex space-x-1"},I2={class:"text-slate-500"},L2={class:"bg-slate-50 rounded-md mt-3 flex items-center py-[2px]"},O2=["placeholder"],N2={key:1,class:"pr-2"},V2={key:0,class:"grid grid-cols-2 mt-4 items-center w-full"},H2={class:"flex ml-auto gap-x-1"},$2={class:"flex-grow overflow-y-auto h-[65vh]",ref:"scrollContainer"},F2={class:"flex space-x-2 hover:bg-gray-50 cursor-pointer py-3 px-4"},q2={class:"w-[15%]"},X2=["src"],Z2={key:1,class:"rounded-full w-10 h-10 flex items-center justify-center bg-slate-200 capitalize"},D2={class:"w-[85%]"},P2={class:"flex justify-between"},Y2={class:"truncate"},j2={class:"self-center text-slate-500 text-xs"},G2={key:0,class:"flex justify-between"},z2={key:0,class:"text-slate-500 text-xs truncate self-end"},U2={key:1,class:"text-slate-500 text-xs truncate self-end"},K2={key:2,class:"text-slate-500 text-xs truncate self-end"},Q2={key:3,class:"text-slate-500 text-xs truncate self-end"},W2={class:"flex items-center"},J2={class:"ml-2"},en={key:4,class:"text-slate-500 text-xs truncate self-end"},tn={class:"flex items-center"},an={class:"ml-2"},rn={key:5,class:"text-slate-500 text-xs truncate self-end"},sn={class:"flex items-center"},nn={class:"ml-2"},ln={key:6,class:"text-slate-500 text-xs truncate self-end"},on={class:"flex items-center"},_n={class:"ml-2"},un={key:7,class:"text-slate-500 text-xs truncate self-end"},vn={class:"flex items-center"},cn={class:"ml-2"},dn={key:8,class:"text-slate-500 text-xs truncate self-end"},hn={class:"flex items-center"},fn={class:"ml-2"},mn={key:9,class:"text-slate-500 text-xs truncate self-end"},pn={class:"flex items-center"},bn={class:"ml-2"},xn={key:10,class:"bg-green-600 text-white rounded-md py-[1px] px-[8px] min-w-10 text-[10px] flex items-center justify-center"},wn={class:"px-4 pb-4"},yn={__name:"ChatTable",props:{rows:{type:Object,required:!0},filters:{type:Object},rowCount:{type:Number,required:!0},ticketingIsEnabled:{type:Boolean},status:{type:String},chatSortDirection:{type:String}},emits:["view"],setup(N,{emit:G}){const W=N,S0=L0(!1);L0(null);const l0=M0=>JSON.parse(M0).type,x0=M0=>JSON.parse(M0),_0=M0=>({"text/plain":"TXT","application/pdf":"PDF","application/vnd.ms-powerpoint":"PPT","application/msword":"DOC","application/vnd.ms-excel":"XLS","application/vnd.openxmlformats-officedocument.wordprocessingml.document":"DOCX","application/vnd.openxmlformats-officedocument.presentationml.presentation":"PPTX","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":"XLSX"})[M0]||"Unknown",I0=M0=>{const Z=JSON.parse(M0).contacts;if(Z.length===1){const i0=Z[0];return i0.name.formatted_name||`${i0.name.first_name} ${i0.name.last_name}`}else if(Z.length>1){const i0=Z[0].name.first_name,z=Z.length-1;return`${i0} and ${z} other contacts`}else return"No contacts available"},ee=M0=>{if(M0){const Z=new Date,i0=new Date(M0);if(i0.getDate()===Z.getDate()&&i0.getMonth()===Z.getMonth()&&i0.getFullYear()===Z.getFullYear())return q0(i0,"h:mm a");const z=new Date;return z.setDate(Z.getDate()-1),i0.getDate()===z.getDate()&&i0.getMonth()===z.getMonth()&&i0.getFullYear()===z.getFullYear()?"Yesterday":q0(i0,"d/m/y")}else return"Invalid time"},q0=(M0,Z)=>{let i0=null;return Z==="h:mm a"?i0={hour12:!0,hour:"numeric",minute:"numeric"}:i0={day:"numeric",month:"numeric",year:"numeric"},new Intl.DateTimeFormat("en-US",i0).format(M0)},Y0=window.location.search;St(()=>Y0,(M0,Z)=>{console.log("Query parameters changed:",M0)});const D0=L0({search:W.filters.search}),j0=hs(()=>{S0.value=!0,K0()},1e3),K0=()=>{const M0=window.location.pathname;wt.visit(M0,{method:"get",data:D0.value})},E0=()=>{D0.value.search=null,K0()};return(M0,Z)=>(U(),r0(v1,null,[p("div",k2,[p("div",C2,[p("div",g2,[p("h2",null,R0(M0.$t("Chats")),1),p("span",I2,R0(N.rowCount),1)])]),p("div",L2,[Z[4]||(Z[4]=p("div",{class:"pl-3 py-2"},[p("svg",{class:"text-slate-600",xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24"},[p("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 10a7 7 0 1 0 14 0a7 7 0 1 0-14 0m18 11l-6-6"})])],-1)),ia(p("input",{onInput:Z[0]||(Z[0]=(...i0)=>xe(j0)&&xe(j0)(...i0)),"onUpdate:modelValue":Z[1]||(Z[1]=i0=>D0.value.search=i0),class:"w-full bg-slate-50 outline-none rounded-xl py-2 pl-2 mr-2 text-sm",type:"text",placeholder:M0.$t("Search name or number...")},null,40,O2),[[la,D0.value.search]]),S0.value===!1&&D0.value.search?(U(),r0("button",{key:0,onClick:E0,type:"button",class:"pr-2"},Z[2]||(Z[2]=[p("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"},[p("path",{fill:"currentColor",d:"M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10s10-4.5 10-10S17.5 2 12 2zm3.7 12.3c.4.4.4 1 0 1.4c-.4.4-1 .4-1.4 0L12 13.4l-2.3 2.3c-.4.4-1 .4-1.4 0c-.4-.4-.4-1 0-1.4l2.3-2.3l-2.3-2.3c-.4-.4-.4-1 0-1.4c.4-.4 1-.4 1.4 0l2.3 2.3l2.3-2.3c.4-.4 1-.4 1.4 0c.4.4.4 1 0 1.4L13.4 12l2.3 2.3z"})],-1)]))):g0("",!0),S0.value?(U(),r0("span",N2,Z[3]||(Z[3]=[Qe('<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><circle cx="12" cy="3.5" r="1.5" fill="currentColor" opacity="0"><animateTransform attributeName="transform" calcMode="discrete" dur="2.4s" repeatCount="indefinite" type="rotate" values="0 12 12;90 12 12;180 12 12;270 12 12"></animateTransform><animate attributeName="opacity" dur="0.6s" keyTimes="0;0.5;1" repeatCount="indefinite" values="1;1;0"></animate></circle><circle cx="12" cy="3.5" r="1.5" fill="currentColor" opacity="0"><animateTransform attributeName="transform" begin="0.2s" calcMode="discrete" dur="2.4s" repeatCount="indefinite" type="rotate" values="30 12 12;120 12 12;210 12 12;300 12 12"></animateTransform><animate attributeName="opacity" begin="0.2s" dur="0.6s" keyTimes="0;0.5;1" repeatCount="indefinite" values="1;1;0"></animate></circle><circle cx="12" cy="3.5" r="1.5" fill="currentColor" opacity="0"><animateTransform attributeName="transform" begin="0.4s" calcMode="discrete" dur="2.4s" repeatCount="indefinite" type="rotate" values="60 12 12;150 12 12;240 12 12;330 12 12"></animateTransform><animate attributeName="opacity" begin="0.4s" dur="0.6s" keyTimes="0;0.5;1" repeatCount="indefinite" values="1;1;0"></animate></circle></svg>',1)]))):g0("",!0)]),N.ticketingIsEnabled?(U(),r0("div",V2,[Re(M2,{status:N.status,rowCount:N.rowCount},null,8,["status","rowCount"]),p("div",H2,[Re(T2,{direction:W.chatSortDirection,url:"/chats/update-sort-direction"},null,8,["direction"])])])):g0("",!0)]),p("div",$2,[(U(!0),r0(v1,null,U1(N.rows.data,(i0,z)=>(U(),c1(xe(st),{href:"/chats/"+i0.uuid+"?page="+W.rows.meta.current_page,class:Ce(["block border-b group-hover:pr-0",i0.unread_messages>0?"bg-green-50":""]),key:z},{default:Ne(()=>{var W0,G0,we,ge,se,oe,ye,J0,P0,ie,Fe,d1,h1,t1,We,a1,r1,S1,M1,Ye,X0,f;return[p("div",F2,[p("div",q2,[i0.avatar?(U(),r0("img",{key:0,class:"rounded-full w-10 h-10",src:i0.avatar},null,8,X2)):(U(),r0("div",Z2,R0(i0.full_name.substring(0,1)),1))]),p("div",D2,[p("div",P2,[p("h3",Y2,R0(i0.full_name),1),p("span",j2,R0(ee((W0=i0==null?void 0:i0.last_chat)==null?void 0:W0.created_at)),1)]),((G0=i0==null?void 0:i0.last_chat)==null?void 0:G0.deleted_at)===null?(U(),r0("div",G2,[l0((we=i0==null?void 0:i0.last_chat)==null?void 0:we.metadata)==="text"?(U(),r0("div",z2,R0(x0((ge=i0==null?void 0:i0.last_chat)==null?void 0:ge.metadata).text.body),1)):g0("",!0),l0((se=i0==null?void 0:i0.last_chat)==null?void 0:se.metadata)==="button"?(U(),r0("div",U2,R0(x0((oe=i0==null?void 0:i0.last_chat)==null?void 0:oe.metadata).button.text),1)):g0("",!0),l0((ye=i0==null?void 0:i0.last_chat)==null?void 0:ye.metadata)==="interactive"?(U(),r0("div",K2,R0(((ie=(P0=x0((J0=i0==null?void 0:i0.last_chat)==null?void 0:J0.metadata).interactive)==null?void 0:P0.button_reply)==null?void 0:ie.title)||((h1=(d1=x0((Fe=i0==null?void 0:i0.last_chat)==null?void 0:Fe.metadata).interactive)==null?void 0:d1.list_reply)==null?void 0:h1.title)),1)):g0("",!0),l0((t1=i0==null?void 0:i0.last_chat)==null?void 0:t1.metadata)==="image"?(U(),r0("div",Q2,[p("div",W2,[Z[5]||(Z[5]=p("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24"},[p("path",{fill:"currentColor",d:"M21 19V5c0-1.1-.9-2-2-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2zM8.9 13.98l2.1 2.53l3.1-3.99c.2-.26.6-.26.8.01l3.51 4.68a.5.5 0 0 1-.4.8H6.02c-.42 0-.65-.48-.39-.81L8.12 14c.19-.26.57-.27.78-.02z"})],-1)),p("span",J2,R0(M0.$t("Photo")),1)])])):g0("",!0),l0((We=i0==null?void 0:i0.last_chat)==null?void 0:We.metadata)==="document"?(U(),r0("div",en,[p("div",tn,[Z[6]||(Z[6]=p("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24"},[p("path",{fill:"currentColor","fill-rule":"evenodd",d:"M14.25 2.5a.25.25 0 0 0-.25-.25H7A2.75 2.75 0 0 0 4.25 5v14A2.75 2.75 0 0 0 7 21.75h10A2.75 2.75 0 0 0 19.75 19V9.147a.25.25 0 0 0-.25-.25H15a.75.75 0 0 1-.75-.75V2.5Zm.75 9.75a.75.75 0 0 1 0 1.5H9a.75.75 0 0 1 0-1.5h6Zm0 4a.75.75 0 0 1 0 1.5H9a.75.75 0 0 1 0-1.5h6Z","clip-rule":"evenodd"}),p("path",{fill:"currentColor",d:"M15.75 2.824c0-.184.193-.301.336-.186c.121.098.23.212.323.342l3.013 4.197c.068.096-.006.22-.124.22H16a.25.25 0 0 1-.25-.25V2.824Z"})],-1)),p("span",an,R0(_0((a1=i0==null?void 0:i0.last_chat)==null?void 0:a1.media.type))+" "+R0(M0.$t("File")),1)])])):g0("",!0),l0((r1=i0==null?void 0:i0.last_chat)==null?void 0:r1.metadata)==="video"?(U(),r0("div",rn,[p("div",sn,[Z[7]||(Z[7]=p("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},[p("path",{fill:"currentColor",d:"M3.5 2.5A2.5 2.5 0 0 0 1 5v6a2.5 2.5 0 0 0 2.5 2.5h5A2.5 2.5 0 0 0 11 11V5a2.5 2.5 0 0 0-2.5-2.5h-5Zm10.684 1.61L12 5.893v4.215l2.184 1.78a.5.5 0 0 0 .816-.389v-7a.5.5 0 0 0-.816-.387Z"})],-1)),p("span",nn,R0(M0.$t("Video")),1)])])):g0("",!0),l0((S1=i0==null?void 0:i0.last_chat)==null?void 0:S1.metadata)==="audio"?(U(),r0("div",ln,[p("div",on,[Z[8]||(Z[8]=p("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 512 512"},[p("path",{fill:"currentColor",d:"M256 80C149.9 80 62.4 159.4 49.6 262c9.4-3.8 19.6-6 30.4-6c26.5 0 48 21.5 48 48v128c0 26.5-21.5 48-48 48c-44.2 0-80-35.8-80-80V288C0 146.6 114.6 32 256 32s256 114.6 256 256v112c0 44.2-35.8 80-80 80c-26.5 0-48-21.5-48-48V304c0-26.5 21.5-48 48-48c10.8 0 21 2.1 30.4 6C449.6 159.4 362.1 80 256 80z"})],-1)),p("span",_n,R0(M0.$t("Audio")),1)])])):g0("",!0),l0((M1=i0==null?void 0:i0.last_chat)==null?void 0:M1.metadata)==="sticker"?(U(),r0("div",un,[p("div",vn,[Z[9]||(Z[9]=p("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 256 256"},[p("path",{fill:"currentColor",d:"M168 32H88a56.06 56.06 0 0 0-56 56v80a56.06 56.06 0 0 0 56 56h48a8.07 8.07 0 0 0 2.53-.41c26.23-8.75 76.31-58.83 85.06-85.06A8.07 8.07 0 0 0 224 136V88a56.06 56.06 0 0 0-56-56Zm-32 175.42V176a40 40 0 0 1 40-40h31.42c-9.26 21.55-49.87 62.16-71.42 71.42Z"})],-1)),p("span",cn,R0(M0.$t("Sticker")),1)])])):g0("",!0),l0((Ye=i0==null?void 0:i0.last_chat)==null?void 0:Ye.metadata)==="contacts"?(U(),r0("div",dn,[p("div",hn,[Z[10]||(Z[10]=p("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},[p("path",{fill:"currentColor",d:"M3 14s-1 0-1-1s1-4 6-4s6 3 6 4s-1 1-1 1H3Zm5-6a3 3 0 1 0 0-6a3 3 0 0 0 0 6Z"})],-1)),p("span",fn,R0(I0((X0=i0==null?void 0:i0.last_chat)==null?void 0:X0.metadata)),1)])])):g0("",!0),l0((f=i0==null?void 0:i0.last_chat)==null?void 0:f.metadata)==="location"?(U(),r0("div",mn,[p("div",pn,[Z[11]||(Z[11]=p("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},[p("path",{fill:"currentColor",d:"M9.156 14.544C10.899 13.01 14 9.876 14 7A6 6 0 0 0 2 7c0 2.876 3.1 6.01 4.844 7.544a1.736 1.736 0 0 0 2.312 0ZM6 7a2 2 0 1 1 4 0a2 2 0 0 1-4 0Z"})],-1)),p("span",bn,R0(M0.$t("Location")),1)])])):g0("",!0),i0.unread_messages>0?(U(),r0("span",xn,R0(i0.unread_messages),1)):g0("",!0)])):g0("",!0)])])]}),_:2},1032,["href","class"]))),128))],512),p("div",wn,[Re(fs,{class:"mt-3",pagination:N.rows.meta},null,8,["pagination"])])],64))}};(function(){try{if(typeof document<"u"){var N=document.createElement("style");N.appendChild(document.createTextNode(".mapdiv[data-v-174b771e]{width:100%;height:100%}.info-window-wrapper[data-v-90174664]{display:none}.mapdiv .info-window-wrapper[data-v-90174664]{display:inline-block}.custom-marker-wrapper[data-v-2d2d343a]{display:none}.mapdiv .custom-marker-wrapper[data-v-2d2d343a]{display:inline-block}")),document.head.appendChild(N)}}catch(G){console.error("vite-plugin-css-injected-by-js",G)}})();var Sn=Object.defineProperty,Mn=(N,G,W)=>G in N?Sn(N,G,{enumerable:!0,configurable:!0,writable:!0,value:W}):N[G]=W,Oa=(N,G,W)=>(Mn(N,typeof G!="symbol"?G+"":G,W),W);const ja=Symbol("map"),Ga=Symbol("api"),An=Symbol("marker"),Rn=Symbol("markerCluster"),ua=Symbol("CustomMarker"),Bn=Symbol("mapTilesLoaded"),za=["click","dblclick","drag","dragend","dragstart","mousedown","mousemove","mouseout","mouseover","mouseup","rightclick"];/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */function En(N,G,W,S0){function l0(x0){return x0 instanceof W?x0:new W(function(_0){_0(x0)})}return new(W||(W=Promise))(function(x0,_0){function I0(Y0){try{q0(S0.next(Y0))}catch(D0){_0(D0)}}function ee(Y0){try{q0(S0.throw(Y0))}catch(D0){_0(D0)}}function q0(Y0){Y0.done?x0(Y0.value):l0(Y0.value).then(I0,ee)}q0((S0=S0.apply(N,G||[])).next())})}var Tn=function N(G,W){if(G===W)return!0;if(G&&W&&typeof G=="object"&&typeof W=="object"){if(G.constructor!==W.constructor)return!1;var S0,l0,x0;if(Array.isArray(G)){if(S0=G.length,S0!=W.length)return!1;for(l0=S0;l0--!==0;)if(!N(G[l0],W[l0]))return!1;return!0}if(G.constructor===RegExp)return G.source===W.source&&G.flags===W.flags;if(G.valueOf!==Object.prototype.valueOf)return G.valueOf()===W.valueOf();if(G.toString!==Object.prototype.toString)return G.toString()===W.toString();if(x0=Object.keys(G),S0=x0.length,S0!==Object.keys(W).length)return!1;for(l0=S0;l0--!==0;)if(!Object.prototype.hasOwnProperty.call(W,x0[l0]))return!1;for(l0=S0;l0--!==0;){var _0=x0[l0];if(!N(G[_0],W[_0]))return!1}return!0}return G!==G&&W!==W};const Na="__googleMapsScriptId";var nt;(function(N){N[N.INITIALIZED=0]="INITIALIZED",N[N.LOADING=1]="LOADING",N[N.SUCCESS=2]="SUCCESS",N[N.FAILURE=3]="FAILURE"})(nt||(nt={}));class K1{constructor({apiKey:G,authReferrerPolicy:W,channel:S0,client:l0,id:x0=Na,language:_0,libraries:I0=[],mapIds:ee,nonce:q0,region:Y0,retries:D0=3,url:j0="https://maps.googleapis.com/maps/api/js",version:K0}){if(this.callbacks=[],this.done=!1,this.loading=!1,this.errors=[],this.apiKey=G,this.authReferrerPolicy=W,this.channel=S0,this.client=l0,this.id=x0||Na,this.language=_0,this.libraries=I0,this.mapIds=ee,this.nonce=q0,this.region=Y0,this.retries=D0,this.url=j0,this.version=K0,K1.instance){if(!Tn(this.options,K1.instance.options))throw new Error(`Loader must not be called again with different options. ${JSON.stringify(this.options)} !== ${JSON.stringify(K1.instance.options)}`);return K1.instance}K1.instance=this}get options(){return{version:this.version,apiKey:this.apiKey,channel:this.channel,client:this.client,id:this.id,libraries:this.libraries,language:this.language,region:this.region,mapIds:this.mapIds,nonce:this.nonce,url:this.url,authReferrerPolicy:this.authReferrerPolicy}}get status(){return this.errors.length?nt.FAILURE:this.done?nt.SUCCESS:this.loading?nt.LOADING:nt.INITIALIZED}get failed(){return this.done&&!this.loading&&this.errors.length>=this.retries+1}createUrl(){let G=this.url;return G+="?callback=__googleMapsCallback",this.apiKey&&(G+=`&key=${this.apiKey}`),this.channel&&(G+=`&channel=${this.channel}`),this.client&&(G+=`&client=${this.client}`),this.libraries.length>0&&(G+=`&libraries=${this.libraries.join(",")}`),this.language&&(G+=`&language=${this.language}`),this.region&&(G+=`&region=${this.region}`),this.version&&(G+=`&v=${this.version}`),this.mapIds&&(G+=`&map_ids=${this.mapIds.join(",")}`),this.authReferrerPolicy&&(G+=`&auth_referrer_policy=${this.authReferrerPolicy}`),G}deleteScript(){const G=document.getElementById(this.id);G&&G.remove()}load(){return this.loadPromise()}loadPromise(){return new Promise((G,W)=>{this.loadCallback(S0=>{S0?W(S0.error):G(window.google)})})}importLibrary(G){return this.execute(),google.maps.importLibrary(G)}loadCallback(G){this.callbacks.push(G),this.execute()}setScript(){var G,W;if(document.getElementById(this.id)){this.callback();return}const S0={key:this.apiKey,channel:this.channel,client:this.client,libraries:this.libraries.length&&this.libraries,v:this.version,mapIds:this.mapIds,language:this.language,region:this.region,authReferrerPolicy:this.authReferrerPolicy};Object.keys(S0).forEach(x0=>!S0[x0]&&delete S0[x0]),!((W=(G=window==null?void 0:window.google)===null||G===void 0?void 0:G.maps)===null||W===void 0)&&W.importLibrary||(x0=>{let _0,I0,ee,q0="The Google Maps JavaScript API",Y0="google",D0="importLibrary",j0="__ib__",K0=document,E0=window;E0=E0[Y0]||(E0[Y0]={});const M0=E0.maps||(E0.maps={}),Z=new Set,i0=new URLSearchParams,z=()=>_0||(_0=new Promise((W0,G0)=>En(this,void 0,void 0,function*(){var we;yield I0=K0.createElement("script"),I0.id=this.id,i0.set("libraries",[...Z]+"");for(ee in x0)i0.set(ee.replace(/[A-Z]/g,ge=>"_"+ge[0].toLowerCase()),x0[ee]);i0.set("callback",Y0+".maps."+j0),I0.src=this.url+"?"+i0,M0[j0]=W0,I0.onerror=()=>_0=G0(Error(q0+" could not load.")),I0.nonce=this.nonce||((we=K0.querySelector("script[nonce]"))===null||we===void 0?void 0:we.nonce)||"",K0.head.append(I0)})));M0[D0]?console.warn(q0+" only loads once. Ignoring:",x0):M0[D0]=(W0,...G0)=>Z.add(W0)&&z().then(()=>M0[D0](W0,...G0))})(S0);const l0=this.libraries.map(x0=>this.importLibrary(x0));l0.length||l0.push(this.importLibrary("core")),Promise.all(l0).then(()=>this.callback(),x0=>{const _0=new ErrorEvent("error",{error:x0});this.loadErrorCallback(_0)})}reset(){this.deleteScript(),this.done=!1,this.loading=!1,this.errors=[],this.onerrorEvent=null}resetIfRetryingFailed(){this.failed&&this.reset()}loadErrorCallback(G){if(this.errors.push(G),this.errors.length<=this.retries){const W=this.errors.length*Math.pow(2,this.errors.length);console.error(`Failed to load Google Maps script, retrying in ${W} ms.`),setTimeout(()=>{this.deleteScript(),this.setScript()},W)}else this.onerrorEvent=G,this.callback()}callback(){this.done=!0,this.loading=!1,this.callbacks.forEach(G=>{G(this.onerrorEvent)}),this.callbacks=[]}execute(){if(this.resetIfRetryingFailed(),this.done)this.callback();else{if(window.google&&window.google.maps&&window.google.maps.version){console.warn("Google Maps already loaded outside @googlemaps/js-api-loader.This may result in undesirable behavior as options and script parameters may not match."),this.callback();return}this.loading||(this.loading=!0,this.setScript())}}}function kn(N){return class extends N.OverlayView{constructor(G){super(),Oa(this,"element"),Oa(this,"opts");const{element:W,...S0}=G;this.element=W,this.opts=S0,this.opts.map&&this.setMap(this.opts.map)}getPosition(){return this.opts.position?this.opts.position instanceof N.LatLng?this.opts.position:new N.LatLng(this.opts.position):null}getVisible(){if(!this.element)return!1;const G=this.element;return G.style.display!=="none"&&G.style.visibility!=="hidden"&&(G.style.opacity===""||Number(G.style.opacity)>.01)}onAdd(){if(!this.element)return;const G=this.getPanes();G&&G.overlayMouseTarget.appendChild(this.element)}draw(){if(!this.element)return;const G=this.getProjection(),W=G==null?void 0:G.fromLatLngToDivPixel(this.getPosition());if(W){this.element.style.position="absolute";const S0=this.element.offsetHeight,l0=this.element.offsetWidth;let x0,_0;switch(this.opts.anchorPoint){case"TOP_CENTER":x0=W.x-l0/2,_0=W.y;break;case"BOTTOM_CENTER":x0=W.x-l0/2,_0=W.y-S0;break;case"LEFT_CENTER":x0=W.x,_0=W.y-S0/2;break;case"RIGHT_CENTER":x0=W.x-l0,_0=W.y-S0/2;break;case"TOP_LEFT":x0=W.x,_0=W.y;break;case"TOP_RIGHT":x0=W.x-l0,_0=W.y;break;case"BOTTOM_LEFT":x0=W.x,_0=W.y-S0;break;case"BOTTOM_RIGHT":x0=W.x-l0,_0=W.y-S0;break;default:x0=W.x-l0/2,_0=W.y-S0/2}this.element.style.left=x0+"px",this.element.style.top=_0+"px",this.element.style.transform=`translateX(${this.opts.offsetX||0}px) translateY(${this.opts.offsetY||0}px)`,this.opts.zIndex&&(this.element.style.zIndex=this.opts.zIndex.toString())}}onRemove(){this.element&&this.element.remove()}setOptions(G){const{element:W,...S0}=G;this.element=W,this.opts=S0,this.draw()}}}let Va;const Ha=["bounds_changed","center_changed","click","dblclick","drag","dragend","dragstart","heading_changed","idle","maptypeid_changed","mousemove","mouseout","mouseover","projection_changed","resize","rightclick","tilesloaded","tilt_changed","zoom_changed"],Cn=Za({props:{apiPromise:{type:Promise},apiKey:{type:String,default:""},version:{type:String,default:"weekly"},libraries:{type:Array,default:()=>["places"]},region:{type:String,required:!1},language:{type:String,required:!1},backgroundColor:{type:String,required:!1},center:{type:Object,default:()=>({lat:0,lng:0})},clickableIcons:{type:Boolean,required:!1,default:void 0},controlSize:{type:Number,required:!1},disableDefaultUi:{type:Boolean,required:!1,default:void 0},disableDoubleClickZoom:{type:Boolean,required:!1,default:void 0},draggable:{type:Boolean,required:!1,default:void 0},draggableCursor:{type:String,required:!1},draggingCursor:{type:String,required:!1},fullscreenControl:{type:Boolean,required:!1,default:void 0},fullscreenControlPosition:{type:String,required:!1},gestureHandling:{type:String,required:!1},heading:{type:Number,required:!1},keyboardShortcuts:{type:Boolean,required:!1,default:void 0},mapTypeControl:{type:Boolean,required:!1,default:void 0},mapTypeControlOptions:{type:Object,required:!1},mapTypeId:{type:[Number,String],required:!1},mapId:{type:String,required:!1},maxZoom:{type:Number,required:!1},minZoom:{type:Number,required:!1},noClear:{type:Boolean,required:!1,default:void 0},panControl:{type:Boolean,required:!1,default:void 0},panControlPosition:{type:String,required:!1},restriction:{type:Object,required:!1},rotateControl:{type:Boolean,required:!1,default:void 0},rotateControlPosition:{type:String,required:!1},scaleControl:{type:Boolean,required:!1,default:void 0},scaleControlStyle:{type:Number,required:!1},scrollwheel:{type:Boolean,required:!1,default:void 0},streetView:{type:Object,required:!1},streetViewControl:{type:Boolean,required:!1,default:void 0},streetViewControlPosition:{type:String,required:!1},styles:{type:Array,required:!1},tilt:{type:Number,required:!1},zoom:{type:Number,required:!1},zoomControl:{type:Boolean,required:!1,default:void 0},zoomControlPosition:{type:String,required:!1}},emits:Ha,setup(N,{emit:G}){const W=L0(),S0=L0(!1),l0=L0(),x0=L0(),_0=L0(!1);Ft(ja,l0),Ft(Ga,x0),Ft(Bn,_0);const I0=()=>{const D0={...N};Object.keys(D0).forEach(E0=>{D0[E0]===void 0&&delete D0[E0]});const j0=E0=>{var M0;return E0?{position:(M0=x0.value)==null?void 0:M0.ControlPosition[E0]}:{}},K0={scaleControlOptions:N.scaleControlStyle?{style:N.scaleControlStyle}:{},panControlOptions:j0(N.panControlPosition),zoomControlOptions:j0(N.zoomControlPosition),rotateControlOptions:j0(N.rotateControlPosition),streetViewControlOptions:j0(N.streetViewControlPosition),fullscreenControlOptions:j0(N.fullscreenControlPosition),disableDefaultUI:N.disableDefaultUi};return{...D0,...K0}},ee=St([x0,l0],([D0,j0])=>{const K0=D0,E0=j0;K0&&E0&&(K0.event.addListenerOnce(E0,"tilesloaded",()=>{_0.value=!0}),setTimeout(ee,0))},{immediate:!0}),q0=()=>{try{const{apiKey:D0,region:j0,version:K0,language:E0,libraries:M0}=N;Va=new K1({apiKey:D0,region:j0,version:K0,language:E0,libraries:M0})}catch(D0){console.error(D0)}},Y0=D0=>{x0.value=yt(D0.maps),l0.value=yt(new D0.maps.Map(W.value,I0()));const j0=kn(x0.value);x0.value[ua]=j0,Ha.forEach(E0=>{var M0;(M0=l0.value)==null||M0.addListener(E0,Z=>G(E0,Z))}),S0.value=!0;const K0=Object.keys(N).filter(E0=>!["apiPromise","apiKey","version","libraries","region","language","center","zoom"].includes(E0)).map(E0=>Da(N,E0));St([()=>N.center,()=>N.zoom,...K0],([E0,M0],[Z,i0])=>{var z,W0,G0;const{center:we,zoom:ge,...se}=I0();(z=l0.value)==null||z.setOptions(se),M0!==void 0&&M0!==i0&&((W0=l0.value)==null||W0.setZoom(M0));const oe=!Z||E0.lng!==Z.lng||E0.lat!==Z.lat;E0&&oe&&((G0=l0.value)==null||G0.panTo(E0))})};return Mt(()=>{N.apiPromise&&N.apiPromise instanceof Promise?N.apiPromise.then(Y0):(q0(),Va.load().then(Y0))}),_a(()=>{var D0;_0.value=!1,l0.value&&((D0=x0.value)==null||D0.event.clearInstanceListeners(l0.value))}),{mapRef:W,ready:S0,map:l0,api:x0,mapTilesLoaded:_0}}}),gn=(N,G)=>{const W=N.__vccOpts||N;for(const[S0,l0]of G)W[S0]=l0;return W},In={ref:"mapRef",class:"mapdiv"};function Ln(N,G,W,S0,l0,x0){return U(),r0("div",null,[p("div",In,null,512),ss(N.$slots,"default",ns(is({ready:N.ready,map:N.map,api:N.api,mapTilesLoaded:N.mapTilesLoaded})),void 0,!0)])}const On=gn(Cn,[["render",Ln],["__scopeId","data-v-174b771e"]]);function Nn(N){return N&&N.__esModule&&Object.prototype.hasOwnProperty.call(N,"default")?N.default:N}var Vn=function N(G,W){if(G===W)return!0;if(G&&W&&typeof G=="object"&&typeof W=="object"){if(G.constructor!==W.constructor)return!1;var S0,l0,x0;if(Array.isArray(G)){if(S0=G.length,S0!=W.length)return!1;for(l0=S0;l0--!==0;)if(!N(G[l0],W[l0]))return!1;return!0}if(G.constructor===RegExp)return G.source===W.source&&G.flags===W.flags;if(G.valueOf!==Object.prototype.valueOf)return G.valueOf()===W.valueOf();if(G.toString!==Object.prototype.toString)return G.toString()===W.toString();if(x0=Object.keys(G),S0=x0.length,S0!==Object.keys(W).length)return!1;for(l0=S0;l0--!==0;)if(!Object.prototype.hasOwnProperty.call(W,x0[l0]))return!1;for(l0=S0;l0--!==0;){var _0=x0[l0];if(!N(G[_0],W[_0]))return!1}return!0}return G!==G&&W!==W};const Hn=Nn(Vn),$n=N=>N==="Marker",Fn=N=>N===ua,qn=(N,G,W,S0)=>{const l0=L0(),x0=na(ja,L0()),_0=na(Ga,L0()),I0=na(Rn,L0()),ee=qt(()=>!!(I0.value&&_0.value&&(l0.value instanceof _0.value.Marker||l0.value instanceof _0.value[ua])));return St([x0,W],(q0,[Y0,D0])=>{var j0,K0,E0;const M0=!Hn(W.value,D0)||x0.value!==Y0;!x0.value||!_0.value||!M0||(l0.value?(l0.value.setOptions(W.value),ee.value&&((j0=I0.value)==null||j0.removeMarker(l0.value),(K0=I0.value)==null||K0.addMarker(l0.value))):($n(N)?l0.value=yt(new _0.value[N](W.value)):Fn(N)?l0.value=yt(new _0.value[N](W.value)):l0.value=yt(new _0.value[N]({...W.value,map:x0.value})),ee.value?(E0=I0.value)==null||E0.addMarker(l0.value):l0.value.setMap(x0.value),G.forEach(Z=>{var i0;(i0=l0.value)==null||i0.addListener(Z,z=>S0(Z,z))})))},{immediate:!0}),_a(()=>{var q0,Y0;l0.value&&((q0=_0.value)==null||q0.event.clearInstanceListeners(l0.value),ee.value?(Y0=I0.value)==null||Y0.removeMarker(l0.value):l0.value.setMap(null))}),l0},$a=["animation_changed","click","dblclick","rightclick","dragstart","dragend","drag","mouseover","mousedown","mouseout","mouseup","draggable_changed","clickable_changed","contextmenu","cursor_changed","flat_changed","rightclick","zindex_changed","icon_changed","position_changed","shape_changed","title_changed","visible_changed"],Xn=Za({name:"Marker",props:{options:{type:Object,required:!0}},emits:$a,setup(N,{emit:G,expose:W,slots:S0}){const l0=Da(N,"options"),x0=qn("Marker",$a,l0,G);return Ft(An,x0),W({marker:x0}),()=>{var _0;return(_0=S0.default)==null?void 0:_0.call(S0)}}});za.concat(["bounds_changed"]);za.concat(["center_changed","radius_changed"]);var oa;(function(N){N.CLUSTERING_BEGIN="clusteringbegin",N.CLUSTERING_END="clusteringend",N.CLUSTER_CLICK="click"})(oa||(oa={}));Object.values(oa);const Zn={key:0,class:"max-w-[300px]"},Dn={class:"normal-case whitespace-pre-wrap"},Pn={key:0,class:"mr-auto text-sm text-[#00a5f4] flex flex-col relative max-w-[25em]"},Yn={key:0,xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",viewBox:"0 0 24 24"},jn={key:1,xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",viewBox:"0 0 24 24"},Gn={key:2,src:"/images/icons/link.png",class:"h-4"},zn={key:3,src:"/images/icons/reply.png",class:"h-4"},Un={key:1,class:"max-w-[300px]"},Kn={class:"normal-case whitespace-pre-wrap"},Qn={class:"normal-case whitespace-pre-wrap"},Wn={key:2,class:"max-w-[300px]"},Jn={class:"normal-case whitespace-pre-wrap"},ei={key:3,class:"max-w-[300px]"},ti={key:0},ai={class:"normal-case whitespace-pre-wrap"},ri={key:1,class:"normal-case whitespace-pre-wrap"},si={key:2,class:"normal-case whitespace-pre-wrap"},ni={key:4},ii=["src"],li={key:1,class:"text-slate-500 flex justify-center items-center space-x-4"},oi={key:2,class:"max-w-[300px]"},_i={key:3,class:"mr-auto text-sm text-[#00a5f4] flex flex-col relative max-w-[25em]"},ui={key:0,xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",viewBox:"0 0 24 24"},vi={key:1,xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",viewBox:"0 0 24 24"},ci={key:2,src:"/images/icons/link.png",class:"h-4"},di={key:3,src:"/images/icons/reply.png",class:"h-4"},hi={key:5},fi={class:"relative w-[300px]"},mi={class:"flex space-x-2 w-full h-1/3 bg-white opacity-90 pt-2"},pi={key:0,xmlns:"http://www.w3.org/2000/svg",width:"36",height:"36",viewBox:"0 0 1024 1024"},bi={key:1,xmlns:"http://www.w3.org/2000/svg",width:"36",height:"36",viewBox:"0 0 32 32"},xi={key:2,xmlns:"http://www.w3.org/2000/svg",width:"36",height:"36",viewBox:"0 0 32 32"},wi={key:3,xmlns:"http://www.w3.org/2000/svg",width:"36",height:"36",viewBox:"0 0 32 32"},yi={class:"overflow-ellipsis overflow-hidden line-clamp-2 w-[200px]"},Si={class:"flex items-center text-slate-500 text-[11px]"},Mi=["href","download"],Ai={key:0,xmlns:"http://www.w3.org/2000/svg",width:"30",height:"30",viewBox:"0 0 24 24"},Ri={key:1,xmlns:"http://www.w3.org/2000/svg",width:"30",height:"30",viewBox:"0 0 24 24"},Bi={key:0,class:"mr-auto text-sm text-[#00a5f4] flex flex-col relative max-w-[25em]"},Ei={key:0,xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",viewBox:"0 0 24 24"},Ti={key:1,xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",viewBox:"0 0 24 24"},ki={key:2,src:"/images/icons/link.png",class:"h-4"},Ci={key:3,src:"/images/icons/reply.png",class:"h-4"},gi={key:6},Ii={key:7},Li=["src"],Oi={key:1,class:"text-slate-500 flex justify-center items-center space-x-4"},Ni={key:8},Vi={class:"flex space-x-3 w-[300px] items-center"},Hi={key:9},$i={key:0,controls:""},Fi=["src"],qi={key:1,class:"text-slate-500 flex justify-center items-center space-x-4"},Xi={key:10},Zi={key:0,controls:"",width:"300",class:"max-h-[350px]"},Di=["src"],Pi={key:1,class:"text-slate-500 flex justify-center items-center space-x-4"},Yi={key:2,class:"max-w-[300px]"},ji={key:3,class:"mr-auto text-sm text-[#00a5f4] flex flex-col relative max-w-[25em]"},Gi={key:0,xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",viewBox:"0 0 24 24"},zi={key:1,xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",viewBox:"0 0 24 24"},Ui={key:2,src:"/images/icons/link.png",class:"h-4"},Ki={key:3,src:"/images/icons/reply.png",class:"h-4"},Qi={key:11,class:"mt-2 mb--2"},Wi={class:"text-gray-500 text-xs text-right leading-none"},Ji={class:"text-gray-500 text-xs text-right leading-none"},el={class:"absolute capitalize hidden group-hover:block bg-white text-gray-600 text-xs rounded-sm py-1 px-2 bottom-full mb-1 whitespace-no-wrap"},tl={key:0,xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},al={key:1,xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",viewBox:"0 0 16 16"},rl={key:12,class:"cursor-pointer text-center border-t mt-2 pt-2"},sl={key:0,class:"bg-red-100 rounded-md p-3 text-sm mt-4"},nl={class:"flex"},il={class:"truncate"},ll={class:"mt-4 flex w-full"},ol={__name:"ChatBubble",props:{content:Object,type:String},setup(N){const G=N,W=L0(!1),S0=()=>{W.value=!0,setTimeout(()=>{W.value=!1},2e3)},l0=M0=>({"text/plain":"TXT","application/pdf":"PDF","application/powerpoint":"PPT","application/vnd.ms-powerpoint":"PPT","application/msword":"DOC","application/vnd.ms-excel":"XLS","application/vnd.openxmlformats-officedocument.wordprocessingml.document":"DOCX","application/vnd.openxmlformats-officedocument.presentationml.presentation":"PPTX","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":"XLSX"})[M0]||"Unknown",x0=M0=>{if(M0===0)return"0 Bytes";const Z=1024,i0=["Bytes","KB","MB","GB","TB"],z=parseInt(Math.floor(Math.log(M0)/Math.log(Z)));return Math.round(M0/Math.pow(Z,z)*100)/100+" "+i0[z]},_0=M0=>{const Z=JSON.parse(M0).contacts;if(Z.length===1){const i0=Z[0];return i0.name.formatted_name||`${i0.name.first_name} ${i0.name.last_name}`}else if(Z.length>1){const i0=Z[0].name.first_name,z=Z.length-1;return`${i0} and ${z} other contacts`}else return"No contacts available"},I0=M0=>{const Z=JSON.parse(M0);return{lat:Z.location.latitude,lng:Z.location.longitude}},ee=M0=>{const i0=qt(()=>qa().props.config).value.find(z=>z.key===M0);return i0?i0.value:""},q0=M0=>{let Z="sent";return M0.forEach(i0=>{const W0=JSON.parse(i0.metadata).status;if(W0==="failed"){Z="failed";return}else W0==="read"?Z="read":W0==="delivered"&&Z!=="read"&&(Z="delivered")}),Z},Y0=L0(!1),j0=((M0=0)=>{var Z,i0,z;try{return(z=(i0=(Z=G.content)==null?void 0:Z.logs)==null?void 0:i0[M0])!=null&&z.metadata?JSON.parse(G.content.logs[M0].metadata).errors||[]:[]}catch(W0){return console.error("Error parsing metadata:",W0),[]}})(),K0=L0(null),E0=async M0=>{K0.value=M0;const Z=document.createElement("textarea");Z.value=M0,document.body.appendChild(Z),Z.select(),document.execCommand("copy"),document.body.removeChild(Z),setTimeout(()=>{K0.value=null},2e3)};return(M0,Z)=>{var i0,z,W0,G0,we,ge,se,oe,ye,J0,P0,ie,Fe,d1,h1,t1,We,a1,r1,S1,M1,Ye,X0,f,H1,k1,C1,g1,s1,$0,n0,O0,A1,ce,Oe,f1,z0,At,W1,qe,lt,Rt,Bt,ot,m1,Et,p1,Tt,$1,_t,kt,Ct,F1;return U(),r0(v1,null,[p("div",{class:Ce(["rounded-lg my-1 p-2 text-sm flex flex-col relative",G.type==="outbound"?"ml-auto rounded-tr-none bg-[#d8fad4] speech-bubble-right":"mr-auto rounded-tl-none bg-white speech-bubble-left"])},[p("div",null,[JSON.parse(N.content.metadata).type==="text"?(U(),r0("div",Zn,[p("p",Dn,R0((i0=JSON.parse(N.content.metadata).text)==null?void 0:i0.body),1),(z=JSON.parse(N.content.metadata))!=null&&z.buttons?(U(),r0("div",Pn,[(U(!0),r0(v1,null,U1((W0=JSON.parse(N.content.metadata))==null?void 0:W0.buttons,(le,n1)=>(U(),r0("div",{key:n1,class:"flex justify-center items-center space-x-2 rounded-lg bg-white h-10 my-[0.1em]"},[p("span",null,[le.type==="COPY_CODE"?(U(),r0("svg",Yn,Z[4]||(Z[4]=[p("path",{fill:"currentColor",d:"M19 21H8V7h11m0-2H8a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h11a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2m-3-4H4a2 2 0 0 0-2 2v14h2V3h12V1Z"},null,-1)]))):le.type==="PHONE_NUMBER"?(U(),r0("svg",jn,Z[5]||(Z[5]=[p("g",{fill:"none"},[p("path",{fill:"currentColor",d:"M20 16v4c-2.758 0-5.07-.495-7-1.325c-3.841-1.652-6.176-4.63-7.5-7.675C4.4 8.472 4 5.898 4 4h4l1 4l-3.5 3c1.324 3.045 3.659 6.023 7.5 7.675L16 15l4 1z"}),p("path",{stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 18.675c1.93.83 4.242 1.325 7 1.325v-4l-4-1l-3 3.675zm0 0C9.159 17.023 6.824 14.045 5.5 11m0 0C4.4 8.472 4 5.898 4 4h4l1 4l-3.5 3z"})],-1)]))):le.type==="URL"?(U(),r0("img",Gn)):(U(),r0("img",zn))]),p("span",null,R0(le.text),1)]))),128))])):g0("",!0)])):g0("",!0),JSON.parse(N.content.metadata).type==="unsupported"?(U(),r0("div",Un,[Z[6]||(Z[6]=p("span",{class:"text-red-500"},[p("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"},[p("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3"})])],-1)),p("p",Kn,R0(M0.$t("Error code"))+" : "+R0(JSON.parse(N.content.metadata).errors[0].code),1),p("p",Qn,R0(JSON.parse(N.content.metadata).errors[0].error_data.details),1)])):g0("",!0),JSON.parse(N.content.metadata).type==="button"?(U(),r0("div",Wn,[p("p",Jn,R0(JSON.parse(N.content.metadata).button.text),1)])):g0("",!0),JSON.parse(N.content.metadata).type==="interactive"?(U(),r0("div",ei,[JSON.parse(N.content.metadata).interactive.type=="button_reply"?(U(),r0("div",ti,[p("p",ai,R0((we=(G0=JSON.parse(N.content.metadata).interactive)==null?void 0:G0.button_reply)==null?void 0:we.title),1)])):g0("",!0),JSON.parse(N.content.metadata).interactive.type=="list_reply"?(U(),r0("p",ri,R0((se=(ge=JSON.parse(N.content.metadata).interactive)==null?void 0:ge.list_reply)==null?void 0:se.title),1)):g0("",!0),JSON.parse(N.content.metadata).interactive.type=="list_reply"?(U(),r0("p",si,R0((ye=(oe=JSON.parse(N.content.metadata).interactive)==null?void 0:oe.list_reply)==null?void 0:ye.description),1)):g0("",!0)])):JSON.parse(N.content.metadata).type==="image"?(U(),r0("div",ni,[N.content.media!=null?(U(),r0("img",{key:0,src:(P0=(J0=N.content)==null?void 0:J0.media)==null?void 0:P0.path,alt:"Image",class:"mb-2 max-w-[300px]"},null,8,ii)):(U(),r0("div",li,[Z[7]||(Z[7]=p("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"},[p("g",{fill:"none"},[p("path",{d:"M24 0v24H0V0h24ZM12.593 23.258l-.011.002l-.071.035l-.02.004l-.014-.004l-.071-.035c-.01-.004-.019-.001-.024.005l-.004.01l-.017.428l.005.02l.01.013l.104.074l.015.004l.012-.004l.104-.074l.012-.016l.004-.017l-.017-.427c-.002-.01-.009-.017-.017-.018Zm.265-.113l-.013.002l-.185.093l-.01.01l-.003.011l.018.43l.005.012l.008.007l.201.093c.012.004.023 0 .029-.008l.004-.014l-.034-.614c-.003-.012-.01-.02-.02-.022Zm-.715.002a.023.023 0 0 0-.027.006l-.006.014l-.034.614c0 .012.007.02.017.024l.015-.002l.201-.093l.01-.008l.004-.011l.017-.43l-.003-.012l-.01-.01l-.184-.092Z"}),p("path",{fill:"currentColor",d:"m13.299 3.148l8.634 14.954a1.5 1.5 0 0 1-1.299 2.25H3.366a1.5 1.5 0 0 1-1.299-2.25l8.634-14.954c.577-1 2.02-1 2.598 0ZM12 4.898L4.232 18.352h15.536L12 4.898ZM12 15a1 1 0 1 1 0 2a1 1 0 0 1 0-2Zm0-7a1 1 0 0 1 1 1v4a1 1 0 1 1-2 0V9a1 1 0 0 1 1-1Z"})])],-1)),Ve(" "+R0(M0.$t("Content not available")),1)])),(ie=JSON.parse(N.content.metadata).image)!=null&&ie.caption?(U(),r0("div",oi,R0((Fe=JSON.parse(N.content.metadata).image)==null?void 0:Fe.caption),1)):g0("",!0),(d1=JSON.parse(N.content.metadata))!=null&&d1.buttons?(U(),r0("div",_i,[(U(!0),r0(v1,null,U1((h1=JSON.parse(N.content.metadata))==null?void 0:h1.buttons,(le,n1)=>(U(),r0("div",{key:n1,class:"flex justify-center items-center space-x-2 rounded-lg bg-white h-10 my-[0.1em]"},[p("span",null,[le.type==="COPY_CODE"?(U(),r0("svg",ui,Z[8]||(Z[8]=[p("path",{fill:"currentColor",d:"M19 21H8V7h11m0-2H8a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h11a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2m-3-4H4a2 2 0 0 0-2 2v14h2V3h12V1Z"},null,-1)]))):le.type==="PHONE_NUMBER"?(U(),r0("svg",vi,Z[9]||(Z[9]=[p("g",{fill:"none"},[p("path",{fill:"currentColor",d:"M20 16v4c-2.758 0-5.07-.495-7-1.325c-3.841-1.652-6.176-4.63-7.5-7.675C4.4 8.472 4 5.898 4 4h4l1 4l-3.5 3c1.324 3.045 3.659 6.023 7.5 7.675L16 15l4 1z"}),p("path",{stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 18.675c1.93.83 4.242 1.325 7 1.325v-4l-4-1l-3 3.675zm0 0C9.159 17.023 6.824 14.045 5.5 11m0 0C4.4 8.472 4 5.898 4 4h4l1 4l-3.5 3z"})],-1)]))):le.type==="URL"?(U(),r0("img",ci)):(U(),r0("img",di))]),p("span",null,R0(le.text),1)]))),128))])):g0("",!0)])):JSON.parse(N.content.metadata).type==="document"?(U(),r0("div",hi,[p("div",fi,[p("div",mi,[p("div",null,[l0((We=(t1=N.content)==null?void 0:t1.media)==null?void 0:We.type)==="PDF"?(U(),r0("svg",pi,Z[10]||(Z[10]=[p("path",{fill:"red",d:"m531.3 574.4l.3-1.4c5.8-23.9 13.1-53.7 7.4-80.7c-3.8-21.3-19.5-29.6-32.9-30.2c-15.8-.7-29.9 8.3-33.4 21.4c-6.6 24-.7 56.8 10.1 98.6c-13.6 32.4-35.3 79.5-51.2 107.5c-29.6 15.3-69.3 38.9-75.2 68.7c-1.2 5.5.2 12.5 3.5 18.8c3.7 7 9.6 12.4 16.5 15c3 1.1 6.6 2 10.8 2c17.6 0 46.1-14.2 84.1-79.4c5.8-1.9 11.8-3.9 17.6-5.9c27.2-9.2 55.4-18.8 80.9-23.1c28.2 15.1 60.3 24.8 82.1 24.8c21.6 0 30.1-12.8 33.3-20.5c5.6-13.5 2.9-30.5-6.2-39.6c-13.2-13-45.3-16.4-95.3-10.2c-24.6-15-40.7-35.4-52.4-65.8zM421.6 726.3c-13.9 20.2-24.4 30.3-30.1 34.7c6.7-12.3 19.8-25.3 30.1-34.7zm87.6-235.5c5.2 8.9 4.5 35.8.5 49.4c-4.9-19.9-5.6-48.1-2.7-51.4c.8.1 1.5.7 2.2 2zm-1.6 120.5c10.7 18.5 24.2 34.4 39.1 46.2c-21.6 4.9-41.3 13-58.9 20.2c-4.2 1.7-8.3 3.4-12.3 5c13.3-24.1 24.4-51.4 32.1-71.4zm155.6 65.5c.1.2.2.5-.4.9h-.2l-.2.3c-.8.5-9 5.3-44.3-8.6c40.6-1.9 45 7.3 45.1 7.4zm191.4-388.2L639.4 73.4c-6-6-14.1-9.4-22.6-9.4H192c-17.7 0-32 14.3-32 32v832c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V311.3c0-8.5-3.4-16.7-9.4-22.7zM790.2 326H602V137.8L790.2 326zm1.8 562H232V136h302v216a42 42 0 0 0 42 42h216v494z"},null,-1)]))):g0("",!0),l0((r1=(a1=N.content)==null?void 0:a1.media)==null?void 0:r1.type)==="XLSX"||l0((M1=(S1=N.content)==null?void 0:S1.media)==null?void 0:M1.type)==="XLS"?(U(),r0("svg",bi,Z[11]||(Z[11]=[Qe('<defs><linearGradient id="vscodeIconsFileTypeExcel0" x1="4.494" x2="13.832" y1="-2092.086" y2="-2075.914" gradientTransform="translate(0 2100)" gradientUnits="userSpaceOnUse"><stop offset="0" stop-color="#18884f"></stop><stop offset=".5" stop-color="#117e43"></stop><stop offset="1" stop-color="#0b6631"></stop></linearGradient></defs><path fill="#185c37" d="M19.581 15.35L8.512 13.4v14.409A1.192 1.192 0 0 0 9.705 29h19.1A1.192 1.192 0 0 0 30 27.809V22.5Z"></path><path fill="#21a366" d="M19.581 3H9.705a1.192 1.192 0 0 0-1.193 1.191V9.5L19.581 16l5.861 1.95L30 16V9.5Z"></path><path fill="#107c41" d="M8.512 9.5h11.069V16H8.512Z"></path><path d="M16.434 8.2H8.512v16.25h7.922a1.2 1.2 0 0 0 1.194-1.191V9.391A1.2 1.2 0 0 0 16.434 8.2Z" opacity=".1"></path><path d="M15.783 8.85H8.512V25.1h7.271a1.2 1.2 0 0 0 1.194-1.191V10.041a1.2 1.2 0 0 0-1.194-1.191Z" opacity=".2"></path><path d="M15.783 8.85H8.512V23.8h7.271a1.2 1.2 0 0 0 1.194-1.191V10.041a1.2 1.2 0 0 0-1.194-1.191Z" opacity=".2"></path><path d="M15.132 8.85h-6.62V23.8h6.62a1.2 1.2 0 0 0 1.194-1.191V10.041a1.2 1.2 0 0 0-1.194-1.191Z" opacity=".2"></path><path fill="url(#vscodeIconsFileTypeExcel0)" d="M3.194 8.85h11.938a1.193 1.193 0 0 1 1.194 1.191v11.918a1.193 1.193 0 0 1-1.194 1.191H3.194A1.192 1.192 0 0 1 2 21.959V10.041A1.192 1.192 0 0 1 3.194 8.85Z"></path><path fill="#fff" d="m5.7 19.873l2.511-3.884l-2.3-3.862h1.847L9.013 14.6c.116.234.2.408.238.524h.017c.082-.188.169-.369.26-.546l1.342-2.447h1.7l-2.359 3.84l2.419 3.905h-1.809l-1.45-2.711A2.355 2.355 0 0 1 9.2 16.8h-.024a1.688 1.688 0 0 1-.168.351l-1.493 2.722Z"></path><path fill="#33c481" d="M28.806 3h-9.225v6.5H30V4.191A1.192 1.192 0 0 0 28.806 3Z"></path><path fill="#107c41" d="M19.581 16H30v6.5H19.581Z"></path>',12)]))):g0("",!0),l0((X0=(Ye=N.content)==null?void 0:Ye.media)==null?void 0:X0.type)==="DOC"||l0((H1=(f=N.content)==null?void 0:f.media)==null?void 0:H1.type)==="DOCX"?(U(),r0("svg",xi,Z[12]||(Z[12]=[Qe('<defs><linearGradient id="vscodeIconsFileTypeWord0" x1="4.494" x2="13.832" y1="-1712.086" y2="-1695.914" gradientTransform="translate(0 1720)" gradientUnits="userSpaceOnUse"><stop offset="0" stop-color="#2368c4"></stop><stop offset=".5" stop-color="#1a5dbe"></stop><stop offset="1" stop-color="#1146ac"></stop></linearGradient></defs><path fill="#41a5ee" d="M28.806 3H9.705a1.192 1.192 0 0 0-1.193 1.191V9.5l11.069 3.25L30 9.5V4.191A1.192 1.192 0 0 0 28.806 3Z"></path><path fill="#2b7cd3" d="M30 9.5H8.512V16l11.069 1.95L30 16Z"></path><path fill="#185abd" d="M8.512 16v6.5l10.418 1.3L30 22.5V16Z"></path><path fill="#103f91" d="M9.705 29h19.1A1.192 1.192 0 0 0 30 27.809V22.5H8.512v5.309A1.192 1.192 0 0 0 9.705 29Z"></path><path d="M16.434 8.2H8.512v16.25h7.922a1.2 1.2 0 0 0 1.194-1.191V9.391A1.2 1.2 0 0 0 16.434 8.2Z" opacity=".1"></path><path d="M15.783 8.85H8.512V25.1h7.271a1.2 1.2 0 0 0 1.194-1.191V10.041a1.2 1.2 0 0 0-1.194-1.191Z" opacity=".2"></path><path d="M15.783 8.85H8.512V23.8h7.271a1.2 1.2 0 0 0 1.194-1.191V10.041a1.2 1.2 0 0 0-1.194-1.191Z" opacity=".2"></path><path d="M15.132 8.85h-6.62V23.8h6.62a1.2 1.2 0 0 0 1.194-1.191V10.041a1.2 1.2 0 0 0-1.194-1.191Z" opacity=".2"></path><path fill="url(#vscodeIconsFileTypeWord0)" d="M3.194 8.85h11.938a1.193 1.193 0 0 1 1.194 1.191v11.918a1.193 1.193 0 0 1-1.194 1.191H3.194A1.192 1.192 0 0 1 2 21.959V10.041A1.192 1.192 0 0 1 3.194 8.85Z"></path><path fill="#fff" d="M6.9 17.988c.023.184.039.344.046.481h.028c.01-.13.032-.287.065-.47s.062-.338.089-.465l1.255-5.407h1.624l1.3 5.326a7.761 7.761 0 0 1 .162 1h.022a7.6 7.6 0 0 1 .135-.975l1.039-5.358h1.477l-1.824 7.748h-1.727l-1.237-5.126q-.054-.222-.122-.578t-.084-.52h-.021q-.021.189-.084.561c-.042.249-.075.432-.1.552L7.78 19.871H6.024L4.19 12.127h1.5l1.131 5.418a4.469 4.469 0 0 1 .079.443Z"></path>',11)]))):g0("",!0),l0((C1=(k1=N.content)==null?void 0:k1.media)==null?void 0:C1.type)==="PPT"||l0((s1=(g1=N.content)==null?void 0:g1.media)==null?void 0:s1.type)==="PPTX"?(U(),r0("svg",wi,Z[13]||(Z[13]=[Qe('<defs><linearGradient id="vscodeIconsFileTypePowerpoint0" x1="4.494" x2="13.832" y1="-1748.086" y2="-1731.914" gradientTransform="translate(0 1756)" gradientUnits="userSpaceOnUse"><stop offset="0" stop-color="#ca4c28"></stop><stop offset=".5" stop-color="#c5401e"></stop><stop offset="1" stop-color="#b62f14"></stop></linearGradient></defs><path fill="#ed6c47" d="M18.93 17.3L16.977 3h-.146A12.9 12.9 0 0 0 3.953 15.854V16Z"></path><path fill="#ff8f6b" d="M17.123 3h-.146v13l6.511 2.6L30 16v-.146A12.9 12.9 0 0 0 17.123 3Z"></path><path fill="#d35230" d="M30 16v.143A12.905 12.905 0 0 1 17.12 29h-.287a12.907 12.907 0 0 1-12.88-12.857V16Z"></path><path d="M17.628 9.389V23.26a1.2 1.2 0 0 1-.742 1.1a1.16 1.16 0 0 1-.45.091H7.027a10.08 10.08 0 0 1-.521-.65a12.735 12.735 0 0 1-2.553-7.657v-.286A12.705 12.705 0 0 1 6.05 8.85a8.82 8.82 0 0 1 .456-.65h9.93a1.2 1.2 0 0 1 1.192 1.189Z" opacity=".1"></path><path d="M16.977 10.04v13.871a1.15 1.15 0 0 1-.091.448a1.2 1.2 0 0 1-1.1.741H7.62q-.309-.314-.593-.65a10.08 10.08 0 0 1-.521-.65a12.735 12.735 0 0 1-2.553-7.657v-.286A12.705 12.705 0 0 1 6.05 8.85h9.735a1.2 1.2 0 0 1 1.192 1.19Z" opacity=".2"></path><path d="M16.977 10.04v12.571a1.2 1.2 0 0 1-1.192 1.189H6.506a12.735 12.735 0 0 1-2.553-7.657v-.286A12.705 12.705 0 0 1 6.05 8.85h9.735a1.2 1.2 0 0 1 1.192 1.19Z" opacity=".2"></path><path d="M16.326 10.04v12.571a1.2 1.2 0 0 1-1.192 1.189H6.506a12.735 12.735 0 0 1-2.553-7.657v-.286A12.705 12.705 0 0 1 6.05 8.85h9.084a1.2 1.2 0 0 1 1.192 1.19Z" opacity=".2"></path><path fill="url(#vscodeIconsFileTypePowerpoint0)" d="M3.194 8.85h11.938a1.193 1.193 0 0 1 1.194 1.191v11.918a1.193 1.193 0 0 1-1.194 1.191H3.194A1.192 1.192 0 0 1 2 21.959V10.041A1.192 1.192 0 0 1 3.194 8.85Z"></path><path fill="#fff" d="M9.293 12.028a3.287 3.287 0 0 1 2.174.636a2.27 2.27 0 0 1 .756 1.841a2.555 2.555 0 0 1-.373 1.376a2.49 2.49 0 0 1-1.059.935a3.607 3.607 0 0 1-1.591.334H7.687v2.8H6.141v-7.922ZM7.686 15.94h1.331a1.735 1.735 0 0 0 1.177-.351a1.3 1.3 0 0 0 .4-1.025q0-1.309-1.525-1.31H7.686v2.686Z"></path>',10)]))):g0("",!0)]),p("div",null,[p("div",null,[p("p",yi,R0((n0=($0=N.content)==null?void 0:$0.media)==null?void 0:n0.name),1)]),p("div",Si,[p("span",null,R0(l0((A1=(O0=N.content)==null?void 0:O0.media)==null?void 0:A1.type)),1),Z[14]||(Z[14]=p("span",null,[p("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24"},[p("circle",{cx:"12.1",cy:"12.1",r:"1",fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2"})])],-1)),p("span",null,R0(x0((Oe=(ce=N.content)==null?void 0:ce.media)==null?void 0:Oe.size)),1)])]),p("a",{href:(z0=(f1=N.content)==null?void 0:f1.media)==null?void 0:z0.path,download:(W1=(At=N.content)==null?void 0:At.media)==null?void 0:W1.name,target:"_blank",onClick:S0,class:"flex justify-end w-full"},[W.value?(U(),r0("svg",Ri,Z[16]||(Z[16]=[Qe('<g fill="none" stroke="currentColor" stroke-linecap="round" stroke-width="2"><path stroke-dasharray="2 4" stroke-dashoffset="6" d="M12 3C16.9706 3 21 7.02944 21 12C21 16.9706 16.9706 21 12 21"><animate attributeName="stroke-dashoffset" dur="0.6s" repeatCount="indefinite" values="6;0"></animate></path><path stroke-dasharray="30" stroke-dashoffset="30" d="M12 21C7.02944 21 3 16.9706 3 12C3 7.02944 7.02944 3 12 3"><animate fill="freeze" attributeName="stroke-dashoffset" begin="0.1s" dur="0.3s" values="30;0"></animate></path><path stroke-dasharray="10" stroke-dashoffset="10" d="M12 8v7.5"><animate fill="freeze" attributeName="stroke-dashoffset" begin="0.5s" dur="0.2s" values="10;0"></animate></path><path stroke-dasharray="6" stroke-dashoffset="6" d="M12 15.5l3.5 -3.5M12 15.5l-3.5 -3.5"><animate fill="freeze" attributeName="stroke-dashoffset" begin="0.7s" dur="0.2s" values="6;0"></animate></path></g>',1)]))):(U(),r0("svg",Ai,Z[15]||(Z[15]=[p("path",{fill:"currentColor",d:"M4.025 11.975q0 2.825 1.725 5t4.4 2.825q.375.1.6.425t.225.725q0 .4-.275.663t-.625.187q-3.5-.7-5.775-3.437t-2.275-6.388q0-3.65 2.288-6.387T10.1 2.15q.35-.075.625.188T11 3q0 .4-.225.725t-.6.425q-2.7.65-4.425 2.825t-1.725 5Zm8.95 1.15l1.85-1.85q.3-.3.725-.3t.725.3q.3.3.288.725t-.313.725L12.675 16.3q-.3.3-.7.3t-.7-.3L7.65 12.65q-.3-.3-.288-.713t.313-.712q.3-.3.713-.3t.712.3l1.875 1.9V8q0-.425.288-.713T11.975 7q.425 0 .713.288t.287.712v5.125Zm3.05 5.75q.375-.225.813-.2t.762.35q.3.3.25.713t-.4.637q-.8.5-1.675.863t-1.8.562q-.4.075-.7-.175t-.3-.675q0-.425.263-.75t.687-.45q.55-.15 1.075-.375t1.025-.5ZM13.975 4.2q-.425-.125-.7-.45T13 3q0-.425.288-.675t.687-.175q.95.2 1.838.562T17.5 3.6q.35.225.375.625t-.25.7q-.3.325-.738.35t-.812-.2q-.5-.275-1.025-.5T13.975 4.2Zm5.75 9.75q.125-.425.463-.7t.762-.275q.425 0 .688.325t.162.725q-.2.95-.575 1.812t-.9 1.663q-.225.35-.625.35t-.675-.275q-.3-.3-.337-.725t.187-.8q.275-.5.488-1.012t.362-1.088Zm-.85-6.075q-.225-.375-.188-.788t.338-.712q.275-.275.675-.263t.625.338q.55.8.925 1.688t.575 1.837q.075.4-.187.7t-.688.3q-.425 0-.762-.287t-.463-.713q-.15-.55-.363-1.075t-.487-1.025Z"},null,-1)])))],8,Mi)])]),(qe=JSON.parse(N.content.metadata))!=null&&qe.buttons?(U(),r0("div",Bi,[(U(!0),r0(v1,null,U1((lt=JSON.parse(N.content.metadata))==null?void 0:lt.buttons,(le,n1)=>(U(),r0("div",{key:n1,class:"flex justify-center items-center space-x-2 rounded-lg bg-white h-10 my-[0.1em]"},[p("span",null,[le.type==="COPY_CODE"?(U(),r0("svg",Ei,Z[17]||(Z[17]=[p("path",{fill:"currentColor",d:"M19 21H8V7h11m0-2H8a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h11a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2m-3-4H4a2 2 0 0 0-2 2v14h2V3h12V1Z"},null,-1)]))):le.type==="PHONE_NUMBER"?(U(),r0("svg",Ti,Z[18]||(Z[18]=[p("g",{fill:"none"},[p("path",{fill:"currentColor",d:"M20 16v4c-2.758 0-5.07-.495-7-1.325c-3.841-1.652-6.176-4.63-7.5-7.675C4.4 8.472 4 5.898 4 4h4l1 4l-3.5 3c1.324 3.045 3.659 6.023 7.5 7.675L16 15l4 1z"}),p("path",{stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 18.675c1.93.83 4.242 1.325 7 1.325v-4l-4-1l-3 3.675zm0 0C9.159 17.023 6.824 14.045 5.5 11m0 0C4.4 8.472 4 5.898 4 4h4l1 4l-3.5 3z"})],-1)]))):le.type==="URL"?(U(),r0("img",ki)):(U(),r0("img",Ci))]),p("span",null,R0(le.text),1)]))),128))])):g0("",!0)])):JSON.parse(N.content.metadata).type==="location"?(U(),r0("div",gi,[Re(xe(On),{"api-key":ee("google_maps_api_key"),style:{width:"300px",height:"200px"},center:I0(N.content.metadata),zoom:15},{default:Ne(()=>[Re(xe(Xn),{options:{position:I0(N.content.metadata)}},null,8,["options"])]),_:1},8,["api-key","center"])])):JSON.parse(N.content.metadata).type==="sticker"?(U(),r0("div",Ii,[N.content.media!=null?(U(),r0("img",{key:0,src:(Bt=(Rt=N.content)==null?void 0:Rt.media)==null?void 0:Bt.path,alt:"Image",class:"mb-2 max-w-[100px]"},null,8,Li)):(U(),r0("div",Oi,[Z[19]||(Z[19]=p("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"},[p("g",{fill:"none"},[p("path",{d:"M24 0v24H0V0h24ZM12.593 23.258l-.011.002l-.071.035l-.02.004l-.014-.004l-.071-.035c-.01-.004-.019-.001-.024.005l-.004.01l-.017.428l.005.02l.01.013l.104.074l.015.004l.012-.004l.104-.074l.012-.016l.004-.017l-.017-.427c-.002-.01-.009-.017-.017-.018Zm.265-.113l-.013.002l-.185.093l-.01.01l-.003.011l.018.43l.005.012l.008.007l.201.093c.012.004.023 0 .029-.008l.004-.014l-.034-.614c-.003-.012-.01-.02-.02-.022Zm-.715.002a.023.023 0 0 0-.027.006l-.006.014l-.034.614c0 .012.007.02.017.024l.015-.002l.201-.093l.01-.008l.004-.011l.017-.43l-.003-.012l-.01-.01l-.184-.092Z"}),p("path",{fill:"currentColor",d:"m13.299 3.148l8.634 14.954a1.5 1.5 0 0 1-1.299 2.25H3.366a1.5 1.5 0 0 1-1.299-2.25l8.634-14.954c.577-1 2.02-1 2.598 0ZM12 4.898L4.232 18.352h15.536L12 4.898ZM12 15a1 1 0 1 1 0 2a1 1 0 0 1 0-2Zm0-7a1 1 0 0 1 1 1v4a1 1 0 1 1-2 0V9a1 1 0 0 1 1-1Z"})])],-1)),Ve(" "+R0(M0.$t("Content not available")),1)]))])):JSON.parse(N.content.metadata).type==="contacts"?(U(),r0("div",Ni,[p("div",Vi,[Z[20]||(Z[20]=p("div",{class:"rounded-full p-3 bg-slate-200"},[p("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 512 512"},[p("path",{fill:"currentColor",d:"M332.64 64.58C313.18 43.57 286 32 256 32c-30.16 0-57.43 11.5-76.8 32.38c-19.58 21.11-29.12 49.8-26.88 80.78C156.76 206.28 203.27 256 256 256s99.16-49.71 103.67-110.82c2.27-30.7-7.33-59.33-27.03-80.6ZM432 480H80a31 31 0 0 1-24.2-11.13c-6.5-7.77-9.12-18.38-7.18-29.11C57.06 392.94 83.4 353.61 124.8 326c36.78-24.51 83.37-38 131.2-38s94.42 13.5 131.2 38c41.4 27.6 67.74 66.93 76.18 113.75c1.94 10.73-.68 21.34-7.18 29.11A31 31 0 0 1 432 480Z"})])],-1)),p("div",null,R0(_0(N.content.metadata)),1)])])):JSON.parse(N.content.metadata).type==="audio"?(U(),r0("div",Hi,[N.content.media!=null?(U(),r0("audio",$i,[p("source",{src:(m1=(ot=N.content)==null?void 0:ot.media)==null?void 0:m1.path},null,8,Fi),Ve(" "+R0(M0.$t("Your browser does not support the audio element")),1)])):(U(),r0("div",qi,[Z[21]||(Z[21]=p("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"},[p("g",{fill:"none"},[p("path",{d:"M24 0v24H0V0h24ZM12.593 23.258l-.011.002l-.071.035l-.02.004l-.014-.004l-.071-.035c-.01-.004-.019-.001-.024.005l-.004.01l-.017.428l.005.02l.01.013l.104.074l.015.004l.012-.004l.104-.074l.012-.016l.004-.017l-.017-.427c-.002-.01-.009-.017-.017-.018Zm.265-.113l-.013.002l-.185.093l-.01.01l-.003.011l.018.43l.005.012l.008.007l.201.093c.012.004.023 0 .029-.008l.004-.014l-.034-.614c-.003-.012-.01-.02-.02-.022Zm-.715.002a.023.023 0 0 0-.027.006l-.006.014l-.034.614c0 .012.007.02.017.024l.015-.002l.201-.093l.01-.008l.004-.011l.017-.43l-.003-.012l-.01-.01l-.184-.092Z"}),p("path",{fill:"currentColor",d:"m13.299 3.148l8.634 14.954a1.5 1.5 0 0 1-1.299 2.25H3.366a1.5 1.5 0 0 1-1.299-2.25l8.634-14.954c.577-1 2.02-1 2.598 0ZM12 4.898L4.232 18.352h15.536L12 4.898ZM12 15a1 1 0 1 1 0 2a1 1 0 0 1 0-2Zm0-7a1 1 0 0 1 1 1v4a1 1 0 1 1-2 0V9a1 1 0 0 1 1-1Z"})])],-1)),Ve(" "+R0(M0.$t("Content not available")),1)]))])):JSON.parse(N.content.metadata).type==="video"?(U(),r0("div",Xi,[N.content.media!=null?(U(),r0("video",Zi,[p("source",{src:(p1=(Et=N.content)==null?void 0:Et.media)==null?void 0:p1.path,type:"video/mp4"},null,8,Di),Ve(" "+R0(M0.$t("Your browser does not support the video element")),1)])):(U(),r0("div",Pi,[Z[22]||(Z[22]=p("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"},[p("g",{fill:"none"},[p("path",{d:"M24 0v24H0V0h24ZM12.593 23.258l-.011.002l-.071.035l-.02.004l-.014-.004l-.071-.035c-.01-.004-.019-.001-.024.005l-.004.01l-.017.428l.005.02l.01.013l.104.074l.015.004l.012-.004l.104-.074l.012-.016l.004-.017l-.017-.427c-.002-.01-.009-.017-.017-.018Zm.265-.113l-.013.002l-.185.093l-.01.01l-.003.011l.018.43l.005.012l.008.007l.201.093c.012.004.023 0 .029-.008l.004-.014l-.034-.614c-.003-.012-.01-.02-.02-.022Zm-.715.002a.023.023 0 0 0-.027.006l-.006.014l-.034.614c0 .012.007.02.017.024l.015-.002l.201-.093l.01-.008l.004-.011l.017-.43l-.003-.012l-.01-.01l-.184-.092Z"}),p("path",{fill:"currentColor",d:"m13.299 3.148l8.634 14.954a1.5 1.5 0 0 1-1.299 2.25H3.366a1.5 1.5 0 0 1-1.299-2.25l8.634-14.954c.577-1 2.02-1 2.598 0ZM12 4.898L4.232 18.352h15.536L12 4.898ZM12 15a1 1 0 1 1 0 2a1 1 0 0 1 0-2Zm0-7a1 1 0 0 1 1 1v4a1 1 0 1 1-2 0V9a1 1 0 0 1 1-1Z"})])],-1)),Ve(" "+R0(M0.$t("Content not available")),1)])),(Tt=JSON.parse(N.content.metadata).video)!=null&&Tt.caption?(U(),r0("div",Yi,R0(($1=JSON.parse(N.content.metadata).video)==null?void 0:$1.caption),1)):g0("",!0),(_t=JSON.parse(N.content.metadata))!=null&&_t.buttons?(U(),r0("div",ji,[(U(!0),r0(v1,null,U1((kt=JSON.parse(N.content.metadata))==null?void 0:kt.buttons,(le,n1)=>(U(),r0("div",{key:n1,class:"flex justify-center items-center space-x-2 rounded-lg bg-white h-10 my-[0.1em]"},[p("span",null,[le.type==="COPY_CODE"?(U(),r0("svg",Gi,Z[23]||(Z[23]=[p("path",{fill:"currentColor",d:"M19 21H8V7h11m0-2H8a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h11a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2m-3-4H4a2 2 0 0 0-2 2v14h2V3h12V1Z"},null,-1)]))):le.type==="PHONE_NUMBER"?(U(),r0("svg",zi,Z[24]||(Z[24]=[p("g",{fill:"none"},[p("path",{fill:"currentColor",d:"M20 16v4c-2.758 0-5.07-.495-7-1.325c-3.841-1.652-6.176-4.63-7.5-7.675C4.4 8.472 4 5.898 4 4h4l1 4l-3.5 3c1.324 3.045 3.659 6.023 7.5 7.675L16 15l4 1z"}),p("path",{stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 18.675c1.93.83 4.242 1.325 7 1.325v-4l-4-1l-3 3.675zm0 0C9.159 17.023 6.824 14.045 5.5 11m0 0C4.4 8.472 4 5.898 4 4h4l1 4l-3.5 3z"})],-1)]))):le.type==="URL"?(U(),r0("img",Ui)):(U(),r0("img",Ki))]),p("span",null,R0(le.text),1)]))),128))])):g0("",!0)])):g0("",!0),G.type==="outbound"&&N.content.user?(U(),r0("div",Qi,[p("span",Wi,[Z[25]||(Z[25]=Ve("Sent By: ")),p("u",null,R0(((Ct=N.content.user)==null?void 0:Ct.first_name)+" "+((F1=N.content.user)==null?void 0:F1.last_name)),1)])])):g0("",!0),p("div",{class:Ce(["flex items-center justify-between space-x-4",G.type==="outbound"&&N.content.user?"":"mt-2"])},[p("p",Ji,R0(N.content.created_at),1),p("span",{class:Ce(["relative group cursor-pointer",q0(N.content.logs)==="read"?"text-blue-500":"text-gray-500"])},[p("div",el,R0(q0(N.content.logs)),1),q0(N.content.logs)==="sent"?(U(),r0("svg",tl,Z[26]||(Z[26]=[p("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"1.5",d:"m2.75 8.75l3.5 3.5l7-7.5"},null,-1)]))):g0("",!0),q0(N.content.logs)==="delivered"||q0(N.content.logs)==="read"?(U(),r0("svg",al,Z[27]||(Z[27]=[p("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"1.5",d:"m1.75 9.75l2.5 2.5m3.5-4l2.5-2.5m-4.5 4l2.5 2.5l6-6.5"},null,-1)]))):g0("",!0),q0(N.content.logs)==="failed"?(U(),r0("svg",{key:2,onClick:Z[0]||(Z[0]=le=>{Y0.value=!0}),class:"text-red-600",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},Z[28]||(Z[28]=[p("g",{fill:"currentColor"},[p("path",{d:"M2 2a2 2 0 0 0-2 2v8.01A2 2 0 0 0 2 14h5.5a.5.5 0 0 0 0-1H2a1 1 0 0 1-.966-.741l5.64-3.471L8 9.583l7-4.2V8.5a.5.5 0 0 0 1 0V4a2 2 0 0 0-2-2zm3.708 6.208L1 11.105V5.383zM1 4.217V4a1 1 0 0 1 1-1h12a1 1 0 0 1 1 1v.217l-7 4.2z"}),p("path",{d:"M12.5 16a3.5 3.5 0 1 0 0-7a3.5 3.5 0 0 0 0 7m.5-5v1.5a.5.5 0 0 1-1 0V11a.5.5 0 0 1 1 0m0 3a.5.5 0 1 1-1 0a.5.5 0 0 1 1 0"})],-1)]))):g0("",!0)],2)],2),JSON.parse(N.content.metadata).type==="contacts"?(U(),r0("div",rl,R0(M0.$t("View")),1)):g0("",!0)])],2),Re(Pa,{label:M0.$t("Message status: ")+q0(N.content.logs),isOpen:Y0.value,closeBtn:!0,onClose:Z[3]||(Z[3]=le=>Y0.value=!1)},{default:Ne(()=>[p("div",null,[xe(j0).length?(U(),r0("div",sl,[(U(!0),r0(v1,null,U1(xe(j0),(le,n1)=>(U(),r0("div",{key:n1},[p("div",nl,[p("p",il,"Chat ID: "+R0(JSON.parse(N.content.logs[0].metadata).id),1),p("button",{onClick:Z[1]||(Z[1]=i1=>E0(JSON.parse(N.content.logs[0].metadata).id)),class:"text-gray-600 hover:text-black transition"},Z[29]||(Z[29]=[p("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24"},[p("g",{fill:"none",stroke:"currentColor","stroke-width":"1.5"},[p("path",{d:"M6 11c0-2.828 0-4.243.879-5.121C7.757 5 9.172 5 12 5h3c2.828 0 4.243 0 5.121.879C21 6.757 21 8.172 21 11v5c0 2.828 0 4.243-.879 5.121C19.243 22 17.828 22 15 22h-3c-2.828 0-4.243 0-5.121-.879C6 20.243 6 18.828 6 16z"}),p("path",{d:"M6 19a3 3 0 0 1-3-3v-6c0-3.771 0-5.657 1.172-6.828C5.343 2 7.229 2 11 2h4a3 3 0 0 1 3 3"})])],-1)]))]),p("p",null,"Error Code: "+R0(le.code),1),p("p",null,"Title: "+R0(le.title),1),p("p",null,"Message: "+R0(le.message),1),p("p",null,"Error Details: "+R0(le.error_data.details),1)]))),128))])):g0("",!0),p("div",ll,[p("button",{type:"button",onClick:Z[2]||(Z[2]=Q1(le=>{Y0.value=!1},["self"])),class:"w-full justify-center rounded-md border border-transparent bg-slate-50 px-4 py-2 text-sm text-slate-500 hover:bg-slate-200 focus:outline-none focus-visible:ring-2 focus-visible:ring-blue-500 focus-visible:ring-offset-2"},R0(M0.$t("Cancel")),1)])])]),_:1},8,["label","isOpen"])],64)}}},_l={class:"py-4 md:py-4 relative px-6 md:px-10"},ul={key:0,class:"text-center py-2"},vl={key:0,class:"inline-flex items-center px-4 py-2 bg-white border border-gray-300 rounded-md text-sm text-gray-700 shadow-sm hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 disabled:opacity-25 transition ease-in-out duration-150"},cl={key:1,class:"py-2"},dl={class:"text-center font-light text-sm border-b border-t py-2 border-dashed border-black"},hl={class:"text-xs"},fl={key:2,class:"py-2 bg-orange-100 my-2 rounded-lg p-2 w-[fit-content] ml-auto"},ml={class:"text-right font-light text-sm"},pl={class:"flex items-center justify-between mt-2 space-x-4"},bl={class:"text-gray-500 text-xs text-right leading-none"},xl={__name:"ChatThread",props:{contactId:{type:Number,required:!0},initialMessages:{type:Array,required:!0},hasMoreMessages:{type:Boolean,required:!0},initialNextPage:{type:Number,required:!0}},setup(N){const G=N,W=L0(G.initialMessages),S0=L0(!1),l0=L0(G.initialNextPage),x0=L0(G.hasMoreMessages),_0=async()=>{if(!(S0.value||!x0.value)){S0.value=!0;try{const I0=await it.get(`/chats/${G.contactId}/messages?page=${l0.value}`);W.value=[...I0.data.messages,...W.value],x0.value=I0.data.hasMoreMessages,l0.value=I0.data.nextPage}catch(I0){console.error("Error loading messages:",I0)}finally{S0.value=!1}}};return(I0,ee)=>(U(),r0("div",_l,[x0.value?(U(),r0("div",ul,[S0.value?(U(),r0("div",vl,ee[0]||(ee[0]=[p("svg",{class:"animate-spin -ml-1 mr-3 h-5 w-5 text-gray-700",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[p("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),p("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1),Ve(" Loading... ")]))):(U(),r0("button",{key:1,onClick:_0,class:"inline-flex items-center px-4 py-2 bg-white border border-gray-300 rounded-md text-sm text-gray-700 shadow-sm hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 disabled:opacity-25 transition ease-in-out duration-150"},ee[1]||(ee[1]=[p("svg",{class:"-ml-1 mr-2 h-5 w-5",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[p("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M7 16V4m0 0L3 8m4-4l4 4m6 0v12m0 0l4-4m-4 4l-4-4"})],-1),Ve(" Load More Messages ")])))])):g0("",!0),(U(!0),r0(v1,null,U1(W.value,(q0,Y0)=>(U(),r0("div",{key:Y0,class:Ce(["flex flex-grow flex-col",q0[0].type==="ticket"?"justify-center":"justify-end"])},[q0[0].type==="chat"?(U(),c1(ol,{key:0,content:q0[0].value,type:q0[0].value.type},null,8,["content","type"])):g0("",!0),q0[0].type==="ticket"?(U(),r0("div",cl,[p("div",dl,[p("div",null,R0(q0[0].value.description),1),p("div",hl,R0(q0[0].value.created_at),1)])])):g0("",!0),q0[0].type==="notes"?(U(),r0("div",fl,[p("div",ml,[p("div",null,R0(q0[0].value.content),1),p("div",pl,[p("p",bl,R0(q0[0].value.created_at),1)])])])):g0("",!0)],2))),128))]))}},wl={class:"md:flex md:flex-grow md:overflow-hidden"},yl={key:2,class:"w-full py-4"},Sl={key:3,class:"flex-1 overflow-y-hidden"},Ml=["onClick"],_o={__name:"Index",props:{rows:Array,rowCount:Number,pusherSettings:Object,organizationId:Number,isChatLimitReached:Boolean,toggleNavBar:Function,state:String,demoNumber:String,settings:Object,status:String,chatThread:Array,hasMoreMessages:Boolean,nextPage:Number,addon:Object,contact:Object,ticket:Object,chat_sort_direction:String,filters:Object,templates:Array,fields:Array,locationSettings:Object,simpleForm:Boolean},setup(N){var we,ge;const G=N,W=L0(G.rows);L0(G.rowCount);const S0=L0(null),l0=L0(!1),x0=L0(!1),_0=L0(!1),I0=L0(!1),ee=L0(G.isChatLimitReached),q0=L0(null),Y0=L0(G.settings.metadata),D0=L0(Y0.value?JSON.parse(Y0.value):null),j0=L0(((ge=(we=D0.value)==null?void 0:we.tickets)==null?void 0:ge.active)??!1),K0=L0(G.chatThread),E0=L0(G.contact);St(()=>G.rows,se=>{W.value=se});function M0(se){x0.value=se}const Z=()=>{const se=S0.value;se&&se.scrollTo({top:se.scrollHeight,behavior:"smooth"})},i0=()=>{q0.value.click(),E0.value=null},z=async()=>{K0.value=[],await it.delete("/chats/"+E0.value.uuid)},W0=se=>{const oe=se[0].value.wam_id;!K0.value.some(J0=>J0[0].value.wam_id===oe)&&se[0].value.deleted_at==null&&(K0.value.push(se),setTimeout(Z,100))},G0=async se=>{var oe;E0.value&&E0.value.id==se[0].value.contact_id&&W0(se);try{const ye=await it.get("/chats");(oe=ye==null?void 0:ye.data)!=null&&oe.result&&(W.value=ye.data.result)}catch(ye){console.error("Error updating side panel:",ye)}};return Mt(()=>{es(G.pusherSettings.pusher_app_key,G.pusherSettings.pusher_app_cluster).channel("chats.ch"+G.organizationId).listen("NewChatEvent",oe=>{G0(oe.chat)}),Z()}),(se,oe)=>(U(),c1(ts,null,{default:Ne(ye=>[p("div",wl,[p("div",{class:Ce(["md:w-[30%] md:flex flex-col h-full bg-white border-r border-l",E0.value?"hidden":""])},[Re(yn,{rows:W.value,filters:G.filters,rowCount:G.rowCount,ticketingIsEnabled:j0.value,status:G==null?void 0:G.status,chatSortDirection:G.chat_sort_direction},null,8,["rows","filters","rowCount","ticketingIsEnabled","status","chatSortDirection"])],2),p("div",{class:Ce(["min-w-0 bg-cover flex flex-col chat-bg",E0.value?"h-screen md:w-[70%]":"md:h-screen md:w-[70%]"])},[E0.value?(U(),c1(p2,{key:0,ticketingIsEnabled:j0.value,contact:E0.value,displayContactInfo:x0.value,ticket:N.ticket,addon:N.addon,onToggleView:M0,onDeleteThread:z,onCloseThread:i0},null,8,["ticketingIsEnabled","contact","displayContactInfo","ticket","addon"])):g0("",!0),E0.value&&!_0.value?(U(),r0("div",{key:1,class:"flex-1 overflow-y-auto",ref_key:"scrollContainer2",ref:S0},[!x0.value&&!l0.value&&!_0.value?(U(),c1(xl,{key:0,contactId:E0.value.id,initialMessages:K0.value,hasMoreMessages:N.hasMoreMessages,initialNextPage:N.nextPage},null,8,["contactId","initialMessages","hasMoreMessages","initialNextPage"])):g0("",!0),x0.value&&!_0.value?(U(),c1(ms,{key:1,class:"bg-white h-full",fields:G.fields,contact:E0.value,locationSettings:G.locationSettings},null,8,["fields","contact","locationSettings"])):g0("",!0)],512)):g0("",!0),E0.value&&!x0.value&&!I0.value&&!_0.value?(U(),r0("div",yl,[Re(t2,{contact:E0.value,simpleForm:N.simpleForm,chatLimitReached:ee.value,onViewTemplate:oe[0]||(oe[0]=J0=>{_0.value=!0})},null,8,["contact","simpleForm","chatLimitReached"])])):g0("",!0),_0.value?(U(),r0("div",Sl,[_0.value?(U(),c1(ls,{key:0,class:"bg-white h-full",contact:E0.value.uuid,templates:N.templates,contactGroups:[],settings:G.settings,displayCancelBtn:!1,displayTitle:!0,isCampaignFlow:!1,scheduleTemplate:!1,sendText:"Send Message",onViewTemplate:oe[1]||(oe[1]=J0=>{_0.value=!1})},null,8,["contact","templates","settings"])):g0("",!0)])):g0("",!0)],2)]),p("button",{class:"hidden",ref_key:"toggleNavbarBtn",ref:q0,onClick:ye.toggleNavBar},null,8,Ml)]),_:1}))}};export{_o as default};
